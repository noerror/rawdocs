# 라플라스 방정식

## 기본 개념

라플라스 방정식은 다음과 같이 표현됩니다:

![Untitled](%E1%84%85%E1%85%A1%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A1%E1%84%89%E1%85%B3%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8%20c48663e61e7a4674aaecc718f386ef77/Untitled.png)

여기서 $\nabla^2$는 라플라시안(Laplacian) 연산자이며, ϕ는 우리가 구하고자 하는 함수입니다.

### 라플라시안 연산자

라플라시안 연산자는 2차 미분 연산자의 합입니다. 2차원에서 라플라시안은 다음과 같이 계산됩니다:

![Untitled](%E1%84%85%E1%85%A1%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A1%E1%84%89%E1%85%B3%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8%20c48663e61e7a4674aaecc718f386ef77/Untitled%201.png)

### 라플라스 방정식의 의미

라플라스 방정식은 여러 가지 물리적 현상을 모델링하는 데 사용됩니다. 예를 들어:

- **정전기학:** 전기장 내에서 전위가 어떻게 분포되는지를 설명합니다.
- **유체 역학:** 특정 조건 하에서 유체의 속도 분포를 설명합니다.
- **열전달:** 특정 조건 하에서 열의 분포를 설명합니다.

### 라플라스 방정식을 이해하는 간단한 비유

라플라스 방정식을 이해하기 위해 비유를 들어 보겠습니다. 만약 평평한 고무 막이 있다고 상상해 보세요. 이 고무 막은 경계에서 고정되어 있으며, 그 경계에서의 높이는 고정되어 있습니다. 라플라스 방정식은 고무 막의 중앙 부분이 어떻게 평평하게 되는지, 즉, 모든 부분이 평형 상태에 도달하는지 설명합니다.

- **경계 조건:** 고무 막의 경계에서 높이를 고정합니다.
- **내부 점 초기화:** 고무 막의 내부 점의 높이는 초기값을 가집니다.
- **이완 과정:** 내부 점의 높이는 주변 점들의 평균 높이로 조정됩니다.
- **반복:** 이 과정을 여러 번 반복하여 고무 막이 평형 상태에 도달할 때까지 계속합니다.

결국, 고무 막의 중앙 부분은 주변 점들의 평균 높이와 같아지게 됩니다. 라플라스 방정식은 이러한 평형 상태를 수학적으로 표현한 것입니다.

![[https://angeloyeo.github.io/2019/08/31/Laplace_Equation.html](https://angeloyeo.github.io/2019/08/31/Laplace_Equation.html) 공돌이의 수학정리노트 (Angelo's Math Notes)](https://raw.githubusercontent.com/angeloyeo/angeloyeo.github.io/master/pics/2019-08-31_Laplace_Equation/pic6.gif)

[https://angeloyeo.github.io/2019/08/31/Laplace_Equation.html](https://angeloyeo.github.io/2019/08/31/Laplace_Equation.html) 공돌이의 수학정리노트 (Angelo's Math Notes)

### 라플라스 방정식 해결 과정

1. **그리드 설정:**
문제 영역을 균일한 격자로 나누고 각 격자점에 φ의 값을 할당합니다.
2. **경계 조건 설정:**
그리드의 경계에 있는 점들의 φ 값을 정해진 조건에 따라 설정합니다. 이 값들은 계산 과정에서 변하지 않습니다.
3. **내부 점 초기화:**
그리드 내부의 모든 점의 φ 값을 임의의 값(보통 0)으로 초기화합니다.
4. **이완 과정:**
그리드 내부의 각 점에 대해, 그 점의 φ 값을 주변 4개 점(2D의 경우)의 평균으로 대체합니다.

![Untitled](%E1%84%85%E1%85%A1%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A1%E1%84%89%E1%85%B3%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8%20c48663e61e7a4674aaecc718f386ef77/Untitled%202.png)

1. **반복:**
4단계를 여러 번 반복합니다. 각 반복마다 φ 값들이 조금씩 변하며, 점차 라플라스 방정식의 해에 가까워집니다.
2. **종료 조건:**
연속된 두 반복 사이의 φ 값의 변화가 매우 작아지면(미리 정한 허용 오차보다 작아지면) 계산을 종료합니다.

### C# 예제

```csharp
double[,] values = new double[gridSize, gridSize];

// 경계 조건 설정 (예: 경계의 φ 값을 1로 설정)
for (int i = 0; i < gridSize; i++)
{
	values[i, 0] = 1;
	values[i, gridSize - 1] = 1;
	values[0, i] = 1;
	values[gridSize - 1, i] = 1;
}

// 이완 과정
for (int iter = 0; iter < maxIterations; iter++)
{
	double[,] oldValues = (double[,])values.Clone();
	for (int i = 1; i < gridSize - 1; i++)
	{
		for (int j = 1; j < gridSize - 1; j++)
		{
			values[i, j] = 0.25 * (
				oldValues[i - 1, j] + oldValues[i + 1, j] +
				oldValues[i, j - 1] + oldValues[i, j + 1]
			);
		}
	}

	// 변화가 허용 오차보다 작은지 확인
	double maxDifference = 0;
	for (int i = 0; i < gridSize; i++)
	{
		for (int j = 0; j < gridSize; j++)
		{
			maxDifference = Math.Max(maxDifference, Math.Abs(values[i, j] - oldValues[i, j]));
		}
	}

	if (maxDifference < tolerance)
	{
		break;
	}
}

```

## 특징

### 단순한 계산

라플라시안 연산자는 각 점의 값을 주변 점들의 평균값과 비교하여 계산됩니다. 이 연산은 상대적으로 간단하며 반복적인 업데이트 과정을 통해 복잡한 문제를 해결할 수 있습니다. 이는 많은 그래픽스 알고리즘에서 중요한 특징입니다. 예를 들어, 메시 스무딩이나 이미지 필터링과 같은 작업은 이웃 점들의 평균값을 계산하는 방식으로 이루어집니다.

### 물리적 특성 반영

라플라시안 연산자는 물리적 시스템에서 균형 상태를 모델링하는 데 적합합니다. 열 확산, 전기장, 유체 흐름 등의 물리적 현상은 라플라스 방정식을 통해 잘 설명될 수 있습니다. 이는 그래픽스에서 자연스러운 변형, 조명, 그리고 기타 물리적 효과를 시뮬레이션하는 데 유용합니다. 라플라시안을 사용하면 물리적 시스템의 균형 상태나 평형 상태를 모델링할 수 있어 현실감 있는 그래픽을 생성하는 데 도움이 됩니다.

### 반복적 해법

라플라시안 연산자는 반복적인 수치해법을 통해 복잡한 문제를 점진적으로 해결할 수 있습니다. 이는 컴퓨터 그래픽스에서 자주 사용되는 기법입니다. 예를 들어, 이미지 복원이나 메시 최적화는 반복적인 업데이트 과정을 통해 목표 상태에 도달합니다. 이러한 반복적인 접근 방식은 초기값에서 시작하여 점진적으로 최종 해에 접근하는 방식을 취합니다.

### 경계 조건의 유연성

라플라시안 연산자는 다양한 경계 조건을 처리할 수 있습니다. 이는 그래픽스에서 경계 조건이 중요한 역할을 하는 경우에 유용합니다. 예를 들어, 특정 부분에서 값을 고정해야 하거나, 특정 조건을 만족해야 하는 경우 라플라시안 연산자를 사용하여 쉽게 모델링할 수 있습니다. 경계 조건을 통해 시스템의 전체적인 특성을 제어할 수 있습니다.

### 다양한 응용 분야

라플라시안은 그래픽스의 여러 응용 분야에서 활용됩니다. 예를 들어, 메시 스무딩, 이미지 필터링, 조명 계산, 텍스처 매핑 등에서 라플라시안 연산자가 중요한 역할을 합니다. 이는 라플라시안이 가진 수학적 특성이 다양한 그래픽스 문제를 해결하는 데 적합하기 때문입니다. 다양한 응용 분야에서 라플라시안의 단순하고 반복적인 계산 방법은 실용적이고 효율적입니다.

## 응용

### Harmonic Coordinates

Harmonic Coordinates는 Pixar에서 제안한, 3D 컴퓨터 그래픽스에서 복잡한 메시의 변형을 자연스럽고 효율적으로 수행하기 위한 기법입니다. 이 기법은 특히 자유형 변형(free-form deformation)과 캐릭터 애니메이션에서 널리 사용됩니다. Harmonic Coordinates는 메쉬의 내부 포인트에 대한 가중치를 계산하여, 정점(vertex)이 제어 포인트(control point)의 움직임에 따라 어떻게 변형되어야 하는지를 결정합니다.

Harmonic Coordinates의 계산은 라플라스 방정식의 해를 구하는 과정과 밀접하게 연관되어 있습니다. Harmonic Coordinates는 다음과 같은 조화 함수(harmonic function) 방정식을 풀어 가중치를 계산합니다:

![Untitled](%E1%84%85%E1%85%A1%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A1%E1%84%89%E1%85%B3%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8%20c48663e61e7a4674aaecc718f386ef77/Untitled%203.png)

여기서 $\nabla^2$는 라플라시안 연산자이며, u는 우리가 구하려는 조화 함수입니다. 이 방정식은 메쉬의 내부 포인트에서의 값이 경계 조건을 만족하면서 조화롭게 분포되도록 합니다.

1. **경계 조건 설정:** 제어 포인트의 위치를 경계 조건으로 설정합니다.
2. **내부 포인트 계산:** 메쉬 내부의 모든 포인트에 대해 라플라스 방정식을 풀어, 조화 함수 u의 값을 계산합니다.
3. **가중치 계산:** 계산된 조화 함수 값을 이용해 각 내부 포인트에 대한 가중치를 결정합니다.

이 과정에서 라플라스 방정식의 해가 메쉬의 부드럽고 자연스러운 변형을 보장합니다. 경계 조건이 중요하게 작용하며, 내부 포인트가 주변 포인트의 평균값을 가지도록 하는 특성이 라플라스 방정식과 일치합니다.

### Heat Diffusion Weighting

Heat Diffusion Weighting은 3D 컴퓨터 그래픽스에서 특히 모델 리깅과 애니메이션에 사용되는 기법입니다. 이 방법은 스켈레톤의 각 본(bone)이 메시(mesh)의 각 정점(vertex)에 미치는 영향을 계산하는 데 사용됩니다. 스켈레톤의 본에서 출발한 "열"이 메시를 통해 확산된다고 가정하고, 각 정점에서의 "온도"를 측정하여 본의 영향력을 계산합니다.
Heat Diffusion Weighting 기법은 라플라스 방정식과 밀접한 관련이 있습니다. Heat Diffusion Weighting에서의 확산 과정은 라플라스 방정식의 해를 구하는 과정과 유사합니다. 특정 시간 이후의 온도 분포는 라플라스 방정식의 정상 상태 해와 유사하게 되며, 이는 ∇²u = 0 형태로 나타납니다. 이 과정에서 경계 조건이 중요하며, 경계 조건이 온도 분포에 큰 영향을 미치는 점도 라플라스 방정식과 유사합니다.

### Radiosity

Radiosity는 컴퓨터 그래픽스에서 간접 조명을 시뮬레이션하는 전역 조명(Global Illumination) 기법입니다. Radiosity는 장면 내의 모든 표면 간의 빛의 상호작용을 고려하여, 표면에서 방출되고 반사되는 빛의 양을 계산합니다. 이 방법은 에너지가 균등하게 분포되도록 하여, 더 사실적인 조명 효과를 생성합니다.

Radiosity 방법에서 사용되는 방정식은 라플라스 방정식과 개념적으로 유사합니다. Radiosity 방정식은 표면에서 방출된 에너지가 다른 표면으로 전달되면서 균형 상태에 도달하는 과정을 설명합니다. 이는 라플라스 방정식이 물리적 시스템의 균형 상태를 설명하는 방식과 유사합니다. Radiosity는 에너지 균형을 기반으로 하며, 이는 라플라스 방정식의 평형 상태 개념과 일치합니다.

### Radial Basis Function (RBF)

Radial Basis Function(RBF)은 주로 보간 및 분류 문제에서 사용되는 수학적 함수입니다. RBF는 중심점으로부터의 거리에만 의존하여 값을 계산하며, 이를 통해 주어진 데이터 포인트를 기반으로 새로운 값을 예측하거나 보간할 수 있습니다. RBF는 데이터 포인트 간의 부드러운 변화를 모델링하는 데 특히 유용합니다.

RBF는 라플라스 방정식과 몇 가지 유사점을 공유합니다. 첫째, RBF는 중심으로부터의 거리에 따라 값이 변화하며, 이는 라플라스 방정식의 해가 경계 조건으로부터의 거리에 따라 변화하는 것과 유사합니다. 둘째, 특정 유형의 RBF(예: thin-plate spline)는 라플라스 방정식의 해와 직접적으로 관련이 있습니다. 이러한 함수들은 데이터 포인트 간의 부드러운 보간을 제공하며, 이는 라플라스 방정식이 물리적 시스템의 균형 상태를 나타내는 것과 유사합니다.

### Subdivision Surfaces

Subdivision Surfaces는 3D 모델링에서 낮은 폴리곤 메쉬를 반복적으로 세분화하여 더 부드럽고 정교한 표면을 생성하는 방법입니다.

Subdivision Surfaces는 각 정점의 위치를 주변 정점들의 가중평균으로 업데이트하는 과정을 포함하며, 이 과정은 라플라시안 스무딩과 유사합니다. 반복적인 세분화 과정은 라플라스 방정식의 반복적 해법과 유사한 결과를 제공합니다. 대표적인 세분화 기법으로 Catmull-Clark와 Loop subdivision이 있습니다.

### Mesh Smoothing (Laplacian Smoothing)

Mesh Smoothing은 3D 모델링에서 메시의 표면을 부드럽게 하는 기술입니다. 이를 통해 잡음(noise)을 제거하고 더 자연스러운 표면을 얻을 수 있습니다.

Mesh Smoothing은 라플라시안 연산자를 사용하여 각 정점의 위치를 주변 정점들의 평균값으로 업데이트합니다. 이 방법은 라플라스 방정식을 풀어 메쉬 표면의 부드러운 분포를 만드는 과정과 유사합니다. 업데이트 식은 다음과 같습니다:
 $v_i' = \frac{1}{|\mathcal{N}(v_i)|} \sum_{v_j \in \mathcal{N}(v_i)} v_j$ 
여기서 $v_i$는 현재 정점,  $\mathcal{N}(v_i)$는 이웃 정점들의 집합입니다.

## 응용 기타

### Poisson Editing

Poisson Editing은 이미지 편집에서 사용되는 기법으로, 이미지의 일부분을 자연스럽게 합성하는 데 사용됩니다. 이 기법은 이미지의 경계 조건을 이용하여 새로운 픽셀 값을 생성합니다.

Poisson Editing은 포아송 방정식을 사용하여 이미지의 픽셀 값을 계산합니다. 포아송 방정식은 라플라스 방정식과 밀접하게 관련되어 있으며, 두 방정식 모두 공간에서의 부드러운 변화와 균형 상태를 나타냅니다. 포아송 방정식은 다음과 같습니다:

![Untitled](%E1%84%85%E1%85%A1%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A1%E1%84%89%E1%85%B3%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8%20c48663e61e7a4674aaecc718f386ef77/Untitled%204.png)

여기서 f는 우리가 구하는 함수,  g는 소스 이미지의 변화입니다. 경계 조건을 만족시키면서 내부 픽셀 값을 계산하는 과정이 라플라스 방정식의 해를 구하는 과정과 유사합니다.

### Bilateral Filtering

Bilateral Filtering은 이미지 처리에서 가장자리 보존 필터링(edge-preserving filtering)을 수행하는 기법입니다. 이 필터링 기법은 이미지의 디테일을 유지하면서 잡음을 제거합니다.

Bilateral Filtering은 비선형 필터링 방법으로, 필터링 과정에서 각 픽셀의 값이 공간적 거리와 값의 차이에 따라 가중평균 됩니다. 이는 라플라스 방정식에서의 부드러운 값의 분포와 유사한 결과를 제공합니다. 필터링 과정은 다음과 같습니다:

![Untitled](%E1%84%85%E1%85%A1%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A1%E1%84%89%E1%85%B3%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8%20c48663e61e7a4674aaecc718f386ef77/Untitled%205.png)

여기서 $I_p$는 픽셀 p의 값,  $\mathcal{N}(p)$는 이웃 픽셀들의 집합, f는 공간 가중치 함수, g는 값 가중치 함수,  $W_p$는 정규화 상수입니다.

### Anisotropic Diffusion

Anisotropic Diffusion은 이미지 처리에서 에지 보존 잡음 제거를 위한 기술입니다. 이 방법은 에지를 따라 확산을 제어하여 이미지를 부드럽게 만듭니다.

Anisotropic Diffusion은 열 확산 방정식의 변형으로 볼 수 있습니다. 확산 계수$\alpha$가 픽셀의 위치에 따라 달라지며, 에지 근처에서는 확산을 억제합니다. 방정식은 다음과 같습니다:

![Untitled](%E1%84%85%E1%85%A1%E1%84%91%E1%85%B3%E1%86%AF%E1%84%85%E1%85%A1%E1%84%89%E1%85%B3%20%E1%84%87%E1%85%A1%E1%86%BC%E1%84%8C%E1%85%A5%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8%20c48663e61e7a4674aaecc718f386ef77/Untitled%206.png)

여기서 $c(\nabla I)$는 이미지 기울기에 따라 변하는 확산 계수입니다. 이는 에지 근처에서 확산을 줄이고 평탄한 영역에서는 확산을 증가시키는 역할을 합니다.