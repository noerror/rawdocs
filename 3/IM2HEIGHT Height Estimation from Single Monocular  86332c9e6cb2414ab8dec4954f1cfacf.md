# IM2HEIGHT: Height Estimation from Single Monocular Imagery via Fully Residual Convolutional-Deconvolutional Network

[https://arxiv.org/pdf/1802.10249.pdf](https://arxiv.org/pdf/1802.10249.pdf)

이 논문에서는 전체 축척의 불확실성이 크기 때문에 본질적으로 모호하고 기술적으로 어려운 단일 단안 원격 감지 이미지에서 높이를 추정하는 새로운 문제를 해결합니다. 유니티는 단안 원격 센싱 이미지와 높이 맵 간의 매핑을 모델링하기 위해 잔여 학습을 통해 엔드투엔드로 훈련된 완전한 컨볼루션-디컨볼루션 네트워크 아키텍처를 제안합니다.

이 아키텍처는 입력 원격 감지 이미지를 높은 수준의 다차원 특징 표현으로 변환하는 특징 추출용 컨볼루션 하위 네트워크와 추출된 특징에서 높이 맵을 생성하는 높이 생성기 역할을 하는 비컨볼루션 하위 네트워크의 두 부분으로 구성됩니다. 추정 높이 맵에서 미세한 가장자리 디테일을 보존하기 위해 네트워크 전체에 걸쳐 물체 경계와 가장자리와 같은 저수준 시각 정보를 전송하는 스킵 연결을 도입했습니다.

추정 높이 맵을 사용하여 건물의 인스턴스 세분화의 실제 예제를 소개합니다. 이 논문은 원격 센싱 커뮤니티에서 단안 시각으로 높이 추정을 시도한 최초의 논문입니다. 제안된 네트워크는 베를린 지역을 포함하는 대규모 고해상도 항공 이미지 데이터 세트를 사용하여 검증되었습니다. 실험 결과의 시각적 분석과 정량적 분석 모두 우리의 접근 방식이 효과적임을 입증합니다.

색인 용어-콘볼루션 신경망, 컨볼루션 신경망, 높이 추정, 잔여 학습.

I. INTRODUCTION

높이를 추정하는 것은 장면 내의 기하학적 관계를 이해하는 데 매우 중요합니다. 많은 원격 감지 문제는 시맨틱 라벨링 및 변화 감지 등 높이 정보가 제공하는 풍부한 물체 및 환경 표현의 이점을 활용합니다. LiDAR와 같은 레이저 센서 덕분에 DSM 데이터를 보다 저렴하게 수집할 수 있게 되었지만, 특히 대량의 과거 원격 센싱 이미지로 작업할 때 높이 정보를 항상 사용할 수 있는 것은 아닙니다.

원격 감지 분야의 많은 선행 연구는 스테레오 매칭을 사용한 높이 추정에 초점을 맞추고 있지만, 실제로는 단일 원격 감지 이미지에서 높이를 추정하는 연구는 거의 이루어지지 않았습니다. 단안 시력에서 높이를 추정하는 것은 기술적으로 어려운 문제인데, 하나의 원격 감지 이미지가 무한한 수의 실제 시나리오에 대응할 수 있기 때문에 강도 또는 색상 측정값을 높이 값에 매핑할 때 내재된 모호성이 발생할 수 있기 때문입니다.

그러나 인간은 단일 원격 감지 이미지에서 기본 3D 구조를 추론할 수 있으며, 단안 단서만으로 동일한 작업을 수행할 수 있는 비전 알고리즘을 개발하는 것은 여전히 어려운 과제입니다. 이 연구에서 정확한 높이 맵이란 현실 세계에서 물리적으로 그럴듯한 높이 맵을 의미합니다.

A. Related Work

컴퓨터 비전 분야에서 단일 이미지의 깊이 추정은 전통적으로 수작업으로 만든 시각적 특징과 확률적 그래픽 모델(PGM)을 사용해 해결해 왔는데, 이는 종종 장면 지오메트리에 대한 강력한 가정에 의존하는 경우가 많았습니다. 일부 접근 방식에서는 마르코프 랜덤 필드(MRF), 기하학적 구조 분류, 시맨틱 분할, 전송 전략(특징 기반 매칭 및 고차 조건부 랜덤 필드)을 사용하기도 했습니다. 하지만 이러한 방법에는 방대한 데이터 세트와 값비싼 정렬 프로세스가 필요할 수 있습니다.

최근에는 컨볼루션 신경망(CNN)이 선도적인 머신 러닝 방법론으로 부상하고 있으며, 분류 및 픽셀당 밀도 높은 예측을 위해 원시 이미지에서 중간 및 높은 수준의 추상적 특징 표현을 추출하는 데 효과적인 것으로 입증되었습니다. 일부 작업에서는 단일 뷰 깊이 추정을 위해 CNN과 CRF와 같은 그래픽 모델을 결합하기도 했습니다.

원격 감지 이미지의 높이 예측은 컴퓨터 비전의 깊이 추정과 비교할 때 고유한 과제를 안고 있는데, 원격 감지 이미지는 직교 이미지인 경우가 많고 공간 해상도가 제한적이며 수많은 작은 물체를 포함하고 있기 때문입니다. 단일 단안 이미지로부터의 높이 예측은 원격 감지 커뮤니티에서 거의 다루어지지 않았습니다. Srivastava 등[24]은 높이 예측 오류를 최소화하는 시맨틱 라벨링 손실과 회귀 손실의 선형 조합인 CNN에서 조인트 손실 함수를 사용했습니다. 그러나 이 방법에는 픽셀 단위의 라벨링된 세그먼테이션 마스크가 필요하며, 이를 구하는 데 많은 비용과 시간이 소요됩니다.

반면, 센서 기술의 발전으로 DSM 데이터에 대한 접근성이 향상되고 가격이 저렴해지면서 CNN 및 기타 딥러닝 기술을 활용한 높이 예측의 새로운 가능성이 열렸습니다.

B. Contributions

이 백서에서 저자는 단안 원격 감지 이미지에서 높이 추정을 위한 새로운 방법을 제안합니다. 이 방법은 단대단 심층 잔류 네트워크를 사용하여 단안 원격 감지 이미지에서 높이를 추정하는 것으로, 훈련에는 DSM 데이터만 기준 자료로 필요합니다. 이 접근 방식은 픽셀 단위로 레이블이 지정된 마스크가 필요하지 않으므로 효율성과 비용면에서 이전 작업과 다릅니다.

제안된 네트워크에는 세 가지 주요 기여가 있습니다:

원격 감지 커뮤니티의 높이 추정 문제를 해결하기 위해 DSM 데이터만을 학습용 실측 데이터로 사용하므로 픽셀 단위 라벨이 지정된 마스크와 같은 추가 데이터가 필요하지 않습니다.
컨볼루션 서브 네트워크와 비컨볼루션 서브 네트워크로 구성된 엔드투엔드 심층 잔여 네트워크와 스킵 연결을 도입합니다. 원격 센싱 작업에서 픽셀 단위 예측을 위한 이러한 유형의 아키텍처는 아직 잘 연구되지 않았습니다.
예측된 높이 맵을 사용하여 건물의 인스턴스 분할에 적용함으로써 단일 뷰 높이 예측의 유용성을 입증하여 픽셀 수준 분할 마스크의 강력한 감독에 의존하지 않고도 이 작업을 달성할 수 있는 다른 관점을 제공합니다.
논문은 다음과 같이 구성되어 있습니다:

서론: 단일 단안 이미지로부터 깊이/높이를 추정하는 문제와 제안한 방법의 동기를 설명합니다.
방법론: 높이 추정을 위한 완전 잔여 컨볼루션-디컨볼루션 네트워크에 대한 자세한 설명을 제공합니다.
실험 및 적용: 네트워크 설정, 실험 결과 및 응용 예제(건물의 인스턴스 분할)에 대해 설명합니다.
결론: 논문과 논문이 기여한 바를 요약합니다.
이 연구는 단일 단안 원격 센싱 이미지에서 높이를 추정하는 새로운 접근 방식을 제시하여 기존 방법보다 효율적이고 비용 효율적인 솔루션을 제공할 뿐만 아니라 실제 애플리케이션에서 유용성을 입증합니다.

II. METHODOLOGY

원격 감지 이미지에서 높이 지도를 추정하기 위한 좋은 네트워크 아키텍처는 계산과 메모리 측면에서 효율적이면서 글로벌 컨텍스트와 로컬 세부 정보를 모두 캡처할 수 있어야 합니다. 한 가지 가능한 해결책은 컨볼루션 하위 네트워크와 비컨볼루션 하위 네트워크로 구성된 심층 잔여 네트워크와 스킵 연결을 활용하는 것입니다. 이 아키텍처는 원하는 점 추정 매핑 f: x → y를 달성하는 데 도움이 될 수 있습니다.

컨볼루션 하위 네트워크: 네트워크의 이 부분은 특징 추출기 역할을 하며 입력된 원격 감지 이미지를 높은 수준의 다차원 특징 표현으로 변환합니다. 일반적으로 여러 컨볼루션 레이어와 풀링 레이어로 구성되며, 입력 이미지의 전체적인 컨텍스트를 캡처하는 데 도움이 됩니다.

컨볼루션 하위 네트워크: 네트워크의 이 부분은 컨볼루션 하위 네트워크에서 추출한 특징 표현에서 높이 맵을 생성하는 높이 생성기 역할을 합니다. 일반적으로 일련의 디컨볼루션 및 풀링 해제 레이어로 구성되어 높이 맵의 공간 해상도와 로컬 디테일을 복원하는 데 도움이 됩니다.

연결 건너뛰기: 예상 높이 맵의 미세한 에지 디테일을 보존하기 위해 네트워크에 스킵 연결을 도입할 수 있습니다. 이 연결을 사용하면 객체 경계 및 가장자리와 같은 낮은 수준의 시각적 정보를 네트워크를 통해 직접 전송할 수 있으므로 높이 맵 예측의 정확도와 품질이 향상됩니다.

이 아키텍처를 사용하면 원격 감지 이미지와 해당 높이 맵 간의 매핑을 효과적으로 학습할 수 있는 엔드투엔드 심층 잔류 네트워크를 훈련할 수 있습니다. 이 접근 방식은 목적 함수를 최소화하고 예상 높이 맵을 추정할 수 있으므로 원격 감지 애플리케이션의 높이 추정 문제에 대한 실현 가능한 솔루션을 제공합니다.

A. Architecture: Fully Convolutional-Deconvolutional Net

이 백서에서 저자는 컨볼루션 서브 네트워크와 컨볼루션 해제 서브 네트워크의 두 가지 주요 부분으로 구성된 네트워크 아키텍처를 제안하여 기존 CNN에서 흔히 볼 수 있는 다운샘플링 문제를 해결합니다. 이 아키텍처는 원격 감지 이미지에서 높이 추정과 같은 고밀도 픽셀 단위 예측 작업을 위해 특별히 설계되었습니다.

컨볼루션 하위 네트워크는 특징 추출기 역할을 하여 입력 원격 감지 이미지를 높은 수준의 다차원 특징 표현으로 변환합니다. 반면, 비선형 하위 네트워크는 높이 생성기 역할을 하여 추출된 특징에서 높이 맵을 생성합니다. 이러한 설계를 통해 네트워크는 더 높은 수준의 정보를 정밀 예측에 전달하여 전반적인 성능을 향상시킬 수 있습니다.

이전 접근 방식과 달리, 저자는 거친 예측만이 아니라 전체 거친 특징 맵을 디컨볼루션하여 출력을 세분화합니다. 이 접근 방식을 사용하면 더 높은 수준의 정보를 보존할 수 있으므로 더 정확한 높이 예측이 가능합니다.

그런 다음 이 논문에서는 수퍼파라미터와 손실 함수 같은 아키텍처 세부 사항을 결정하여 네트워크를 인스턴스화하는 방법에 대해 설명합니다. 저자는 원격 감지 애플리케이션을 위한 높이 지도를 효과적으로 추정하는 네트워크를 구축하고 개선하는 것을 목표로 합니다.

B. Plain Convolutional Net vs. Residual Net

![Untitled](IM2HEIGHT%20Height%20Estimation%20from%20Single%20Monocular%20%2086332c9e6cb2414ab8dec4954f1cfacf/Untitled.png)

저자들은 처음에는 고밀도 픽셀당 예측 작업에 널리 사용되는 VGG 넷의 철학을 기반으로 완전한 컨볼루션-디컨볼루션 네트워크를 구축하려고 시도했습니다. 컨볼루션 서브 네트워크는 1픽셀 간격의 3x3 컨볼루션 필터와 공간 해상도를 보존하기 위한 패딩을 사용하여 VGG 넷의 규칙을 따릅니다. 비선형 서브네트워크는 컨볼루션 서브네트워크의 미러링 버전이며 풀링과 컨볼루션 연산으로 구성됩니다.

그러나 저자들은 VGG 네트워크에 기반한 일반 컨볼루션-디컨볼루션 네트워크는 최적화가 쉽지 않고 물리적으로 그럴듯한 높이 맵을 생성하지 못한다는 사실을 발견했습니다. 이 문제를 해결하기 위해 이미지 분류 분야에서 최첨단 결과를 달성한 ResNet의 성공에서 영감을 받아 네트워크 아키텍처에 잔여 학습을 도입했습니다.

완전 잔여 컨볼루션-디컨볼루션 네트워크(res. conv-deconv net)는 잔여 블록을 쌓아 구축됩니다. 이러한 블록은 동일한 특징 맵 크기와 동일한 수의 필터를 가진 여러 컨볼루션 레이어로 구성되지만, 아이덴티티 매핑을 수행하고 스택된 컨볼루션의 출력과 함께 추가되는 단축 연결을 사용합니다. 이 접근 방식을 사용하면 네트워크를 더 쉽게 최적화할 수 있으며, 그 결과 높이 맵이 더 정확하고 물리적으로 그럴듯해집니다.

C. Res. Conv-Deconv Net with Skip

앞서 설명한 잔여 컨볼루션-디컨볼루션 네트워크(res. conv-deconv 네트워크)에서는 모든 정보 흐름이 병목 레이어를 포함한 모든 레이어를 통과해야 합니다. 당면한 문제의 경우, 입력 원격 감지 이미지와 출력 높이 맵 간에 에지와 같은 저수준 시각 정보가 상당량 공유됩니다. 이 낮은 수준의 정보를 네트워크를 통해 직접 전송하는 것이 이상적입니다. 그러나 병목 계층으로 인해 현재 버전의 네트워크에서는 이를 달성할 수 없어 물체 경계가 흐려집니다.

이 문제를 해결하기 위해 저자는 첫 번째 잔여 블록과 다음 블록 사이에 스킵 연결을 추가하여 새로운 네트워크를 구축합니다. 이 건너뛰기 연결은 다음 블록의 모든 피처 맵을 첫 번째 블록의 피처 맵과 연결하여 낮은 수준의 정보가 가중치 레이어를 거치지 않고 직접 전파될 수 있도록 합니다. 이렇게 하면 오브젝트 경계와 가장자리를 포함하는 정보가 컨볼루션 해제 하위 네트워크에서 사라지지 않습니다.

결과적으로 스킵 연결이 적용된 네트워크는 원래 네트워크에 비해 높이 맵 품질을 향상시켜 오브젝트 경계와 가장자리를 더 정확하게 보존합니다.

III. EXPERIMENT

A. Data and Error Metrics

실험은 독일 베를린의 항공 이미지를 대상으로 진행되었습니다. 디지털 표면 모델(DSM)과 그에 상응하는 정사영상을 세미 글로벌 매칭을 사용하여 재구성했습니다. 데이터는 지면 간격이 약 70cm로 리샘플링되었으며, 이미지의 2/3는 훈련에, 1/3은 테스트에 사용되었습니다.

단일 단안 이미지에서 높이 추정을 위한 다양한 접근 방식의 성능을 평가하려면 스케일 불변 오차 메트릭이 필요합니다. 연구진은 평균 제곱 오차(MSE)와 평균 절대 오차(MAE)를 포함하는 이전 연구의 척도 불변 오차를 사용합니다.

또한 추정 높이 지도의 품질을 평가하기 위해 구조적 유사성(SSIM) 지수를 사용합니다. SSIM은 휘도 및 대비를 위해 정규화된 픽셀 강도의 로컬 패턴을 비교합니다. 비교 대상 이미지의 국부 평균, 표준 편차 및 교차 공분산을 사용하여 계산됩니다.

B. Training Details

네트워크 트레이닝은 테아노 프레임워크를 기반으로 하며, 모델을 처음부터 트레이닝하기 위한 최적화 알고리즘으로 네스테로프 아담이 선택됩니다. 이 알고리즘은 모멘텀을 사용한 표준 확률적 경사 하강이나 Adam과 같은 다른 최적화 방법보다 빠른 수렴을 보여줍니다. 네스테로프 아담의 파라미터는 대부분 문헌에서 권장하는 대로 설정되며, 학습률은 0.00002로 작습니다. 네트워크의 모든 가중치는 0을 중심으로 잘린 정규 분포에서 샘플을 추출하는 글로롯 정규 초기화기를 사용하여 초기화됩니다.

2손실은 회귀 문제에서 최적화를 위한 표준 손실 함수이지만, 연구진은 1손실 또는 MAE를 손실 함수로 사용하면 약간 더 나은 결과를 얻을 수 있다는 사실을 발견했습니다. 네트워크는 RGB 이미지에 대한 학습을 통해 해당 높이 맵을 예측합니다.

훈련 세트는 840개의 고유한 256x256 이미지로 구성되며, 데이터 증강을 사용하여 훈련 샘플 수를 8,568개로 늘립니다. 증강에는 이미지의 회전과 뒤집기가 포함됩니다. 훈련 중 과적합을 모니터링하기 위해 훈련 샘플의 10%가 검증 세트로 무작위로 선택됩니다. 네트워크는 이미지 쌍 1개로 구성된 매우 작은 미니 배치로 훈련되며 3,976,907개의 훈련 가능한 매개변수와 4,864개의 훈련 불가능한 매개변수를 가지고 있습니다.

이 정도 규모의 네트워크를 훈련하여 일반화를 달성하는 것은 어려운 일이기 때문에 연구원들은 조기 중단 전략을 사용합니다. 네트워크는 12GB의 GPU 메모리를 갖춘 단일 NVIDIA GeForce GTX TITAN에서 훈련되며, 훈련 과정은 약 2시간이 소요됩니다.

C. Evaluation on Height Maps

제안된 네트워크(연결 건너뛰기 기능이 있는 컨볼루션-디컨볼루션 네트워크)를 아이겐 네트워크, 연결 건너뛰기 기능이 있는 일반 컨볼루션-디컨볼루션 네트워크, 컨볼루션-디컨볼루션 네트워크 등 여러 다른 네트워크와 비교하여 평가합니다. 높이 맵을 정성적으로 비교한 결과, 제안된 모델이 다른 네트워크에 비해 객체 가장자리, 경계 및 구조 정의의 품질을 크게 향상시킨다는 것을 알 수 있습니다.

건너뛰기 연결이 있는 일반 conv-deconv 네트워크는 사실적인 높이 맵을 생성할 수 없으며 각 입력 원격 감지 이미지에 대해 거의 동일한 결과를 생성합니다. 반면에 해상도 conv-deconv 네트워크는 성능이 더 좋지만 제안된 네트워크만큼 좋지는 않습니다. 고유 넷은 높이 맵에서 일부 구조를 학습할 수 있지만 결과가 상당히 흐릿합니다.

제안된 네트워크는 임의의 크기의 원격 감지 이미지를 처리할 수 있습니다. 대규모 베를린 테스트 구역의 높이 추정 결과는 스킵 연결을 사용하는 제안된 네트워크가 해상도 변환-디컨브 네트워크와 같이 흐릿한 높이 맵 대신 매우 우수한 저수준 시각적 세부 사항(예: 물체 경계)을 가진 높이 맵을 얻을 수 있음을 보여줍니다. 연결 건너뛰기 기능이 있는 res. conv-deconv 네트워크는 MSE, MAE 및 SSIM에서 상당한 개선을 보여줍니다.

그러나 제안된 네트워크는 고층 건물과 같은 일부 복잡한 장면에서 여전히 어려움을 겪습니다. 좋은 객체 경계와 가장자리를 얻었음에도 불구하고 많은 고층 건물을 추정하는 것은 여전히 상당히 어렵습니다. 모델의 출력은 단일 단안 이미지에서 장면의 새로운 3D 뷰를 생성하는 데 사용할 수 있습니다.

D. Application to Instance Segmentation of Buildings

이 섹션에서는 건물의 인스턴스 분할이라는 실제 응용 분야에서 단일 단안 이미지로부터 높이 추정의 유용성을 보여줍니다. 인스턴스 분할은 이미지의 픽셀 수준에서 건물의 개별 인스턴스를 식별하는 것을 목표로 합니다. 대부분의 인스턴스 분할 접근 방식은 픽셀 수준 분할 마스크와 같은 강력한 훈련 감독에 의존하는데, 이는 수집하는 데 많은 비용과 시간이 소요됩니다.

저자들은 건너뛰기 연결이 있는 해상도 변환 네트워크에서 생성된 예상 높이 맵을 사용하여 다른 접근 방식을 제안합니다. 예측 높이 맵의 임계값을 사용하여 높은 구조물(예: 건물 및 나무)을 먼저 추출하는 인스턴스 세분화 프레임워크가 배포됩니다. 그런 다음 식생 지수(VI)를 사용하여 나무를 필터링하고 작은 영역을 제거하거나 구멍을 채우는 등의 후처리 단계를 수행합니다.

이것은 단일 단안 이미지에서 높이 추정을 기반으로 건물을 인스턴스 분할하는 첫 번째 데모이며, 베를린 테스트 장면의 결과는 만족스러웠습니다. 이 접근 방식은 픽셀 단위의 라벨링된 마스크와 지도 학습에 의존하지 않기 때문에 기존의 인스턴스 분할 방법보다 비용 효율적이고 효율적인 대안이 될 수 있습니다.

IV. CONCLUSION

이 백서에서 저자는 원격 감지 커뮤니티의 새로운 문제인 단일 뷰 높이 예측을 해결하기 위해 완전 잔여 컨볼루션-디컨볼루션 네트워크를 제안합니다. 제안된 네트워크는 입력된 고해상도 원격 감지 이미지를 추상적인 다차원 특징 표현으로 변환하기 위한 컨볼루션 하위 네트워크와 높이 맵을 생성하기 위한 비컨볼루션 하위 네트워크의 두 부분으로 구성됩니다.

실험 과정에서 네트워크의 병목 현상으로 인해 물체 경계가 흐려지는 현상이 발견되었습니다. 이 문제를 해결하기 위해 저자는 첫 번째 잔여 블록과 다음 블록 사이에 스킵 연결을 추가하여 객체 경계와 같은 저수준 정보를 네트워크를 통해 직접 전송할 수 있도록 네트워크 아키텍처를 개선했습니다.

또한 이 논문은 건물 세분화와 같은 애플리케이션에서 단일 단안 이미지에서 예측된 높이 맵의 유용성을 보여줍니다. 향후 연구에서는 고층 건물 예측의 정확도를 개선하는 데 초점을 맞출 예정입니다.