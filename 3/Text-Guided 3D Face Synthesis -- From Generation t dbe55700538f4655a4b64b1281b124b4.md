# Text-Guided 3D Face Synthesis -- From Generation to Editing

[https://arxiv.org/abs/2312.00375](https://arxiv.org/abs/2312.00375)

- Dec 2023

![(a) 우리의 접근 방식은 텍스트 입력을 통해 3D 페이스를 충실도 높게 생성하고 유연하게 편집할 수 있습니다. 또한 3D 얼굴에 맞춤형 디테일을 생성하기 위한 순차적 편집이 용이합니다. (b) 생성된 3D 페이스를 기존 CG 파이프라인에 원활하게 통합할 수 있습니다.](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled.png)

(a) 우리의 접근 방식은 텍스트 입력을 통해 3D 페이스를 충실도 높게 생성하고 유연하게 편집할 수 있습니다. 또한 3D 얼굴에 맞춤형 디테일을 생성하기 위한 순차적 편집이 용이합니다. (b) 생성된 3D 페이스를 기존 CG 파이프라인에 원활하게 통합할 수 있습니다.

### 1. Introduction

이 논문은 영화 제작, 비디오 게임, 증강/가상 현실(AR/VR)과 같은 다양한 애플리케이션에 필수적인 3D 얼굴 모델링의 개발에 초점을 맞춥니다. 기존에는 디테일한 3D 사람 얼굴을 제작하는 데 시간이 많이 걸리고 고도로 숙련된 아티스트가 필요했습니다. 하지만 딥러닝의 등장으로 제너레이티브 모델을 사용해 사진이나 동영상에서 3D 얼굴을 제작하려는 시도가 이어졌습니다. 하지만 이러한 시도는 학습 데이터의 규모에 제한을 받아 생성된 콘텐츠의 다양성이 떨어졌습니다.

CLIP과 스테이블 디퓨전과 같은 대규모 시각 언어 모델은 다양한 3D 콘텐츠를 제작할 수 있는 새로운 가능성을 열었습니다. 이러한 모델을 사용하여 텍스트와 3D 얼굴을 합성하는 방법이 연구되어 왔으며, 합성 프로세스를 안내하기 위해 CLIP 또는 스코어 증류 샘플링(SDS)을 사용하는 방법도 있습니다. 드림페이스와 같이 고품질의 3D 얼굴 텍스처를 생성하는 데 있어 많은 발전이 있었지만, 기하학적 충실도와 세부적인 얼굴 편집 기능에 있어서는 여전히 문제가 남아 있습니다.

이러한 문제를 극복하기 위해 이 백서에서는 얼굴의 생성과 편집을 모두 포함하는 텍스트 가이드 3D 얼굴 합성을 위한 진보적인 프레임워크인 FaceG2E를 소개합니다. 이 방법은 3D 얼굴을 순차적으로 편집하는 최초의 방법이라는 점에서 주목할 만합니다. 두 가지 핵심 구성 요소가 있습니다: 지오메트리-텍스처 분리 생성 및 셀프 가이드 일관성 유지 편집입니다.

지오메트리-텍스처 분리 생성 단계에서는 얼굴 지오메트리와 텍스처를 개별적으로 생성합니다. 이 단계에서는 텍스처리스 렌더링과 SDS를 사용하여 지오메트리 관련 디테일을 제공하고, 컨트롤넷을 사용하여 지오메트리와 텍스처를 정밀하게 정렬합니다. 또한 미세 조정된 텍스처 확산 모델이 생성된 텍스처의 품질을 향상시킵니다.

셀프 가이드 일관성 유지 편집 기능을 사용하면 의도하지 않은 변경 없이 특정 얼굴 속성을 텍스트에 따라 효율적으로 편집할 수 있습니다. 이는 사전 학습된 이미지 편집 확산 모델과 UV 영역 일관성 보존 정규화를 통해 이루어지며, 순차적인 편집 중에 원치 않는 변경을 방지합니다. 편집 효과를 미세 조정하기 위해 자체 가이드 일관성 가중치 전략도 제안됩니다.

전반적으로 FaceG2E는 세밀한 편집 기능을 통해 충실도가 높은 3D 얼굴 지오메트리와 텍스처를 생성하는 것으로 나타났습니다. 이 논문에서 입증된 바와 같이 시각적 및 정량적 결과 모두에서 다른 최첨단 방법보다 뛰어난 성능을 발휘합니다. 이 연구는 텍스트 기반 3D 얼굴 합성 및 편집을 위한 완벽한 파이프라인을 촉진하는 FaceG2E의 개발과 고충실도 얼굴 생성 및 정밀한 편집 제어를 위한 혁신적인 구성 요소의 도입에 기여했습니다.

### 2. Related Work

**텍스트-이미지 생성**

이 논문은 텍스트-이미지 생성의 발전에 대해 논의하는 것으로 시작합니다. 광범위한 이미지-텍스트 데이터 세트를 학습한 시각 언어 모델과 확산 모델의 최근 발전으로 텍스트 설명에서 사실적인 이미지를 생성하는 기능이 크게 향상되었습니다. 추가 개발은 생성 프로세스에 대한 제어를 강화하고, 특정 시나리오에 맞게 모델을 미세 조정하고, 이미지 편집 기능을 추가하는 데 중점을 두었습니다. 그러나 텍스트에서 사람 얼굴과 같은 고품질 3D 자산을 생성하는 것은 여전히 어려운 영역입니다.

**텍스트에서 3D로 생성**

텍스트에서 이미지로의 전환에서 텍스트에서 3D 생성으로의 전환은 전자의 성공으로 인해 주목을 받고 있습니다. 초기의 텍스트 3D 방식은 메시 또는 신경망을 사용하여 2D 렌더링과 텍스트 프롬프트 간의 일치를 최적화했지만 상대적으로 품질이 낮은 결과를 낳았습니다. 드림퓨전(DreamFusion)과 같은 최근의 노력은 텍스트-이미지 확산 모델에 점수 증류 샘플링(SDS)을 통합하여 인상적인 결과를 보여주었습니다. 이후 생성 시간, 표면 재질 표현, 샘플링 전략 측면에서 개선이 이루어졌습니다. 그러나 텍스트에서 충실도가 높은 3D 얼굴을 생성하는 것은 여전히 복잡한 작업입니다. 이 논문에서 제안하는 방법은 이러한 발전을 바탕으로 다양한 확산 모델을 사용하여 편집 가능한 고충실도 3D 얼굴을 생성합니다.

![FaceG2E 개요. (a) 지오메트리 단계와 텍스처 단계를 포함한 지오메트리-텍스처 분리 생성. (b) 자체 가이드 일관성 유지 편집: 내장된 크로스 어텐션 기능을 활용하여 편집 관련 영역을 확보하고 이를 UV 공간으로 언래핑합니다. 그런 다음 관련 없는 영역의 불일치를 페널티로 처리합니다. (c) 우리의 방법은 다중 점수 증류 샘플링을 활용합니다.](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled%201.png)

FaceG2E 개요. (a) 지오메트리 단계와 텍스처 단계를 포함한 지오메트리-텍스처 분리 생성. (b) 자체 가이드 일관성 유지 편집: 내장된 크로스 어텐션 기능을 활용하여 편집 관련 영역을 확보하고 이를 UV 공간으로 언래핑합니다. 그런 다음 관련 없는 영역의 불일치를 페널티로 처리합니다. (c) 우리의 방법은 다중 점수 증류 샘플링을 활용합니다.

**텍스트-3D 얼굴 합성**

최근 텍스트로부터 3D 얼굴을 생성하려는 시도가 이루어지고 있습니다. Describe3D나 로댕과 같은 시스템은 텍스트에서 3D 얼굴로의 매핑을 학습하려고 시도했지만, 훈련 영역 밖의 텍스트로 일반화하는 데 어려움을 겪었습니다. 이와 대조적으로 이 논문의 접근 방식은 더 나은 일반화를 보여줍니다. 드림페이스나 헤드스컬프트와 같은 다른 방법들은 3D 얼굴의 생성 및 간단한 편집을 위해 사전 학습된 텍스트-이미지 모델과 함께 SDS를 사용했습니다. 그러나 이러한 방식은 정밀한 편집 제어 기능이 부족하여 편집 과정에서 의도하지 않은 변경이 발생하고 순차적인 편집을 통해 고도로 맞춤화된 3D 얼굴을 생성하는 데 한계가 있습니다. 반면 이 백서의 접근 방식은 3D 얼굴을 정확하고 순차적으로 편집할 수 있습니다.

### 3. Methodology

**FaceG2E 개요**

이 논문은 텍스트에서 3D로 변환하는 프로세스를 통해 3D 인간 얼굴을 생성하는 새로운 접근 방식인 FaceG2E를 소개합니다. 이 방법은 두 가지 주요 단계로 구성됩니다:

- 지오메트리-텍스처 분리 생성: 얼굴 지오메트리와 텍스처가 텍스트 입력과 별도로 생성됩니다.
- 셀프 가이드 일관성 유지 편집을 통해 생성된 얼굴을 세밀하게 편집할 수 있습니다.

**사전 준비**

FaceG2E의 기반은 드림퓨전에서 처음 제안된 스코어 증류 샘플링(SDS) 개념을 기반으로 구축되었습니다. 이 기술은 사전 학습된 2D 확산 모델을 사용하여 3D 파라미터를 최적화합니다. 이 프로세스에는 이미지를 렌더링하고, 임베딩하고, 노이즈를 추가하고, 예측된 노이즈와 추가된 노이즈의 차이를 기반으로 그라데이션을 계산하는 과정이 포함됩니다.

FaceG2E에서 얼굴 지오메트리와 텍스처는 별도의 파라미터로 표현됩니다. 지오메트리는 파라메트릭 3D 얼굴 모델을 사용하는 블렌드셰이프 함수를 통해 구현되며, 텍스처는 안정적 확산 VAE의 디코더를 사용하여 합성됩니다.

**지오메트리-텍스처 디커플링 생성**

FaceG2E의 첫 번째 단계는 얼굴 지오메트리와 텍스처를 두 단계로 분리하여 생성하는 것입니다. 지오메트리 단계에서는 스테이블 디퓨전 네트워크의 SDS를 사용하여 입력 텍스트와 일치하는 고품질 지오메트리를 생성하는 데 중점을 둡니다. 기하학적 디테일을 향상시키기 위해 텍스처리스 렌더링이 사용됩니다.

텍스처 단계에서는 지오메트리와 텍스처의 정렬 불일치 문제를 해결하고 텍스처 관련 전제 조건을 통합하기 위해 텍스처 선행 SDS를 도입합니다. 이 단계에서는 지오메트리와 텍스처 간의 정렬을 유지하는 지오메트리 인식 텍스처 콘텐츠 SDS에 ControlNet을 사용합니다.

![텍스처 확산 모델 훈련은 수집된 얼굴 텍스처에 대해 RGB 및 YUV 색상 공간 모두에서 수행됩니다.](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled%202.png)

텍스처 확산 모델 훈련은 수집된 얼굴 텍스처에 대해 RGB 및 YUV 색상 공간 모두에서 수행됩니다.

**셀프 가이드 일관성 유지 편집**

FaceG2E의 두 번째 단계는 생성된 얼굴을 특정 지침에 따라 편집하는 것입니다. 이는 이미지 편집 모델을 사용하여 SDS를 형성함으로써 이루어집니다. 이 방법을 사용하면 지오메트리와 텍스처 파라미터를 개별적으로 최적화하여 각각을 독립적으로 편집할 수 있습니다.

편집 효과와 원본 피처의 균형을 맞추기 위해 셀프 가이드 일관성 가중치 전략이 도입되었습니다. 이 전략은 편집 지침과 관련된 영역을 식별하고 편집 요구 사항에 따라 다양한 수준의 일관성을 적용합니다. 그런 다음 일관성 보존 정규화를 사용하여 텍스처와 지오메트리 모두에서 얼굴의 원본 버전과 편집 버전 간의 일관성을 유지합니다.

![편집된 얼굴, 토큰 "마스크"에 대한 교차 주의 점수 및 편집 반복 중 일관성 가중치 Ci의 시각화. 반복 시 무작위 샘플링으로 인해 시점이 달라진다는 점에 유의하세요.](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled%203.png)

편집된 얼굴, 토큰 "마스크"에 대한 교차 주의 점수 및 편집 반복 중 일관성 가중치 Ci의 시각화. 반복 시 무작위 샘플링으로 인해 시점이 달라진다는 점에 유의하세요.

FaceG2E는 세밀하고 제어된 방식으로 3D 얼굴을 생성하고 편집할 수 있는 기능이 돋보입니다. 이 방법론에는 고품질 지오메트리와 텍스처를 생성하는 정교한 기술과 원본의 특징을 존중하면서 텍스트 입력을 기반으로 상당한 수정을 허용하는 정밀한 편집 기능이 포함됩니다.

### 4. Experiments

구현 세부 사항

FaceG2E의 구현은 허깅페이스 디퓨저를 기반으로 하며, 생성 및 편집의 다양한 측면을 위해 다양한 체크포인트와 모델을 활용합니다. 이 프로세스는 NVIDIA A30 GPU에서 얼굴당 약 4분이 소요되며, 추가 구현 세부 사항은 보충 자료에 제공됩니다.

합성 결과

FaceG2E는 유명인과 영화 캐릭터를 포함한 다양하고 생생한 3D 얼굴을 생성할 수 있는 능력을 보여줍니다. 지오메트리와 텍스처를 독립적으로 조작할 수 있으며 순차적인 편집을 지원합니다. 얼굴은 기존 컴퓨터 그래픽 파이프라인에 통합하여 애니메이션 및 재조명을 할 수 있습니다.

![FaceG2E는 매우 사실적이고 다양한 3D 얼굴을 생성할 수 있을 뿐만 아니라(왼쪽), 이러한 얼굴에 대한 유연한 편집 기능도 제공합니다(오른쪽). FaceG2E는 순차적 편집을 통해 '배트맨 마스크를 쓴 여자 어린이 헐크'와 같이 고도로 맞춤화된 3D 얼굴을 합성할 수 있습니다. 또한 지오메트리 및 텍스처 수정을 위한 독립적인 편집도 가능합니다.](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled%204.png)

FaceG2E는 매우 사실적이고 다양한 3D 얼굴을 생성할 수 있을 뿐만 아니라(왼쪽), 이러한 얼굴에 대한 유연한 편집 기능도 제공합니다(오른쪽). FaceG2E는 순차적 편집을 통해 '배트맨 마스크를 쓴 여자 어린이 헐크'와 같이 고도로 맞춤화된 3D 얼굴을 합성할 수 있습니다. 또한 지오메트리 및 텍스처 수정을 위한 독립적인 편집도 가능합니다.

![텍스트 기반 3D 얼굴 합성 비교. 각 방법의 생성 및 편집 결과를 모두 제시합니다.](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled%205.png)

텍스트 기반 3D 얼굴 합성 비교. 각 방법의 생성 및 편집 결과를 모두 제시합니다.

최첨단 방법과의 비교

FaceG2E는 Describe3D, DreamFace, TADA와 같은 다른 주요 방법과 비교됩니다. 고품질의 지오메트리와 텍스처를 생성하고 편집 지침을 더 정확하게 따르는 면에서 이러한 방법보다 뛰어납니다.

- 질적 비교: FaceG2E는 기하학적 충실도를 유지하고 텍스트 프롬프트를 정확하게 따르는 데 있어 타사 대비 우수한 성능을 보여줍니다.
- 정량적 비교: CLIP 평가를 통해 텍스트 설명의 충실도 측면에서 FaceG2E가 다른 제품보다 우수한 성능을 보였습니다.
- 사용자 연구: 100명의 참가자를 대상으로 한 연구 결과, 지오메트리와 텍스처 측면에서 다른 방법보다 FaceG2E를 선호하는 것으로 나타났습니다.

![순차적 얼굴 편집 비교](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled%206.png)

순차적 얼굴 편집 비교

제거 연구

FaceG2E의 다양한 구성 요소의 효과를 평가합니다.

- 지오메트리-텍스처 디커플링 생성(GDG): GDG, 특히 지오메트리 중심 SDS(GcSDS)는 지오메트리 디테일을 향상시키고, 지오메트리 정렬 텍스처 콘텐츠 SDS(GaSDS)는 지오메트리-텍스처 정렬을 개선합니다. 텍스처 이전 SDS는 더 높은 품질의 텍스처에 기여합니다.
- 셀프 가이드 일관성 보존(SCP): SCP는 특히 셀프 가이드 일관성 가중치와 함께 사용하면 얼굴의 일관성을 유지하면서 눈에 띄는 편집 효과를 얻을 수 있어 바람직한 편집 결과를 얻을 수 있습니다.

![지오메트리-텍스처 분리 생성에 대한 제거 연구. 입력 텍스트는 '스칼렛 요한슨'과 '윌 스미스'입니다.](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled%207.png)

지오메트리-텍스처 분리 생성에 대한 제거 연구. 입력 텍스트는 '스칼렛 요한슨'과 '윌 스미스'입니다.

![3D 얼굴 편집에서 제안된 자체 유도 일관성 보존(SCP)의 분석 결과](Text-Guided%203D%20Face%20Synthesis%20--%20From%20Generation%20t%20dbe55700538f4655a4b64b1281b124b4/Untitled%208.png)

3D 얼굴 편집에서 제안된 자체 유도 일관성 보존(SCP)의 분석 결과

전반적으로 이 실험은 3D 얼굴 생성 및 편집에 있어 FaceG2E의 고급 기능이 다양한 측면에서 다른 최첨단 방법보다 뛰어나다는 것을 보여줍니다.

### 5. Conclusion

FaceG2E의 주요 기여

지오메트리-텍스처 디커플링 생성: 이 기능을 사용하면 충실도가 높은 얼굴 지오메트리와 텍스처를 생성할 수 있어 3D 얼굴 합성의 품질이 크게 향상됩니다.
셀프 가이드 일관성 유지 편집: 이 설계된 메커니즘을 통해 순차 편집을 포함한 유연한 얼굴 편집이 가능하며, 이를 통해 보다 세밀하고 맞춤화된 얼굴 수정이 가능합니다.

성능 및 평가

FaceG2E는 광범위한 평가를 통해 3D 얼굴 합성에서 최첨단(SOTA) 방법보다 뛰어난 성능을 발휘하는 것으로 입증되었습니다. 이러한 검증을 통해 복잡한 얼굴 편집을 수행할 수 있는 다양한 고품질 3D 얼굴을 생성하는 데 있어 그 우수성이 입증되었습니다.

한계점

이러한 발전에도 불구하고 FaceG2E에는 몇 가지 한계가 있습니다:

- 기하학적 표현의 한계: FaceG2E의 현재 기하학적 표현은 머리카락이나 액세서리와 같은 비얼굴 요소의 생성을 제한합니다. 이 제한으로 인해 완전한 얼굴 모양을 생성할 수 있는 범위가 좁아집니다.
- 순차 편집 시 시간 소모: 순차 편집은 고도로 맞춤화된 얼굴을 합성할 수 있다는 이점이 있지만, 프로세스에 필요한 전체 시간이 크게 늘어납니다. 각 편집 라운드마다 시간이 추가되어 프로세스에 더 많은 시간이 소요됩니다.

결론적으로 FaceG2E는 고품질의 다양한 결과물을 제공함으로써 3D 얼굴 생성 및 편집 분야에서 상당한 진전을 이루었습니다. 그러나 기하학적 표현과 편집 시간 효율성의 한계는 향후 개발 과정에서 해결해야 할 부분입니다.