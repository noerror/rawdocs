# ArcFace: Additive Angular Margin Loss for Deep Face Recognition

*이 논문에서는 얼굴 인식을 위한 새로운 부가적 각도 마진 손실 함수인 ArcFace를 소개하여 심층 특징 임베딩의 변별력을 향상시킵니다. 이 방법은 실제 노이즈를 처리하기 위해 ArcFace 모델 내에서 하위 클래스를 사용할 것을 제안합니다. 또한 ArcFace는 훈련 데이터 세트 내부와 외부의 피사체 모두에 대해 특징 벡터를 얼굴 이미지에 정확하게 매핑하여 인상적인 생성 기능을 보여줍니다. 하지만 현재는 반전 시 얼굴 표정과 포즈에 대한 제어 기능이 부족합니다. 향후 연구에서는 이러한 한계를 극복하고 개인 정보 보호를 강화하기 위해 얼굴 인식 모델을 반전할 수 없도록 만드는 방법을 모색하는 것을 목표로 합니다.*

[https://arxiv.org/abs/1801.07698](https://arxiv.org/abs/1801.07698)

- Jan 2018

### 1 INTRODUCTION

이 논문에서는 얼굴 인식에 심층 컨볼루션 신경망(DCNN)을 사용하는 방법에 대해 설명하며, 특히 두 가지 주요 접근 방식을 살펴봅니다. 첫 번째 접근 방식은 소프트맥스 손실을 사용하여 다중 클래스 분류기를 훈련시켜 서로 다른 신원을 구별하는 것입니다. 두 번째 접근 방식은 삼중 손실을 통해 임베딩을 생성하는 것입니다.

두 방법 모두 단점이 있습니다. 소프트맥스 손실 기반 방법은 개방형 얼굴 인식에는 그다지 효과적이지 않으며, 신원 수에 따라 변환 행렬의 크기가 증가합니다. 트리플렛 손실 방식은 대규모 데이터 세트의 경우 얼굴 트리플렛 수가 조합적으로 폭발적으로 증가하는 문제에 직면하며, 세미하드 샘플을 효과적으로 마이닝하는 것은 어려운 과제입니다.

![Triplet [3], Tuplet [12], ArcFace 및 sub-center ArcFace 비교. Triplet과 Tuplet은 미니 배치 내에서 유클리디안 마진을 이용하여 지역적인 샘플 간 비교를 수행합니다. 반면, ArcFace와 sub-center ArcFace는 각각 전역적인 샘플-클래스 및 샘플-하위 클래스 비교를 각도 마진으로 수행합니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled.png)

Triplet [3], Tuplet [12], ArcFace 및 sub-center ArcFace 비교. Triplet과 Tuplet은 미니 배치 내에서 유클리디안 마진을 이용하여 지역적인 샘플 간 비교를 수행합니다. 반면, ArcFace와 sub-center ArcFace는 각각 전역적인 샘플-클래스 및 샘플-하위 클래스 비교를 각도 마진으로 수행합니다.

연구진은 두 가지 방법의 장점을 결합하는 동시에 단점을 완화하는 솔루션을 제안합니다. 연구진은 훈련 과정을 안정화하고 얼굴 인식 모델의 변별력을 향상시키는 것을 목표로 하는 '추가 각도 마진 손실' 또는 ArcFace를 도입했습니다. 이 방법은 현재 특징과 목표 중심 사이의 각도를 계산하고 이 목표 각도에 각도 마진을 더한 다음 고정된 특징 규범에 따라 모든 로그를 재조정합니다. 이 과정은 소프트맥스 손실과 동일한 방식으로 계속됩니다.

이 논문은 또한 주석 달기에 상당한 사람의 노력이 필요한 대규모의 깨끗한 데이터 세트에 대해 이러한 모델을 훈련하는 데 따르는 어려움을 인식하고 있습니다. 연구진은 실제 노이즈가 있을 때 더 강력한 성능을 발휘할 수 있는 '서브센터 ArcFace'를 제안합니다. 이 방법은 각 클래스 내에 하위 클래스를 도입하고 단일 클래스가 아닌 양의 하위 중심 중 하나에 가까운 훈련 샘플만 필요하므로 노이즈가 있는 데이터에 대한 복원력을 측정할 수 있습니다.

연구진은 ArcFace 방법이 직관적이고 경제적이며 구현하기 쉽고 효율적이며 효과적이라고 말합니다. 또한 ArcFace는 생성적 적대 신경망(GAN)과 같은 추가 생성기나 판별기 없이도 신원이 보존되고 시각적으로 합리적인 얼굴 이미지를 생성할 수 있습니다. 이 연구에 따르면 ArcFace는 여러 얼굴 인식 벤치마크에서 최첨단 성능을 달성했습니다.

### 2 RELATED WORK

이 글에서는 얼굴 인식의 다양한 영역에서 관련 작업을 종합적으로 검토하고 최근의 발전과 직면한 몇 가지 과제를 논의합니다.

![제안된 ArcFace 손실 (K=1) 및 sub-center ArcFace 손실 (예: K=3)로 깊은 얼굴 인식 모델을 학습합니다. 임베딩 피처 xi ∈ R512와 모든 서브센터 W ∈ R512×N×K에 대해 `2 정규화 단계를 거친 후, 행렬 곱셈을 통해 하위 클래스별 유사성 점수 S ∈ RN×K를 얻습니다. 최대 풀링 단계 후, 클래스별 유사성 점수 S0 ∈ RN×1을 쉽게 얻을 수 있습니다. 이후에, 우리는 arccosθyi를 계산하고 피처 xi와 실제 센터 Wyi 사이의 각도를 얻습니다. 그런 다음, 우리는 대상 (실제) 각도 θyi에 각도 마진 페널티 m을 추가합니다. 이후에, 우리는 cos(θyi + m)을 계산하고 모든 로짓을 피처 스케일 s로 곱합니다. 마지막으로, 로짓은 소프트맥스 함수를 통과하고 교차 엔트로피 손실에 기여합니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%201.png)

제안된 ArcFace 손실 (K=1) 및 sub-center ArcFace 손실 (예: K=3)로 깊은 얼굴 인식 모델을 학습합니다. 임베딩 피처 xi ∈ R512와 모든 서브센터 W ∈ R512×N×K에 대해 `2 정규화 단계를 거친 후, 행렬 곱셈을 통해 하위 클래스별 유사성 점수 S ∈ RN×K를 얻습니다. 최대 풀링 단계 후, 클래스별 유사성 점수 S0 ∈ RN×1을 쉽게 얻을 수 있습니다. 이후에, 우리는 arccosθyi를 계산하고 피처 xi와 실제 센터 Wyi 사이의 각도를 얻습니다. 그런 다음, 우리는 대상 (실제) 각도 θyi에 각도 마진 페널티 m을 추가합니다. 이후에, 우리는 cos(θyi + m)을 계산하고 모든 로짓을 피처 스케일 s로 곱합니다. 마지막으로, 로짓은 소프트맥스 함수를 통과하고 교차 엔트로피 손실에 기여합니다.

마진 페널티가 있는 얼굴 인식: 이 문서에서는 삼중 손실의 사용과 대규모 데이터 집합으로 인해 직면한 과제에 대해 설명합니다. 이러한 문제에 대한 해결책으로 이중 마진 대비 손실이 제안되었습니다. 이 손실 함수는 거리 가중 샘플링과 결합하여 더 효율적인 것으로 입증되었습니다. 또한 메모리 소비를 줄이고 정확도를 개선하여 비교를 보다 효율적으로 수행할 수 있는 마진 기반 소프트맥스 방법도 언급하고 있습니다.

잡음 속에서의 얼굴 인식: 이 섹션에서는 노이즈 샘플의 재라벨링, 노이즈 내성 종단 간 패러다임, 공동 마이닝 전략 등 노이즈가 있는 얼굴 인식 데이터를 처리하는 데 사용되는 몇 가지 전략을 검토합니다. 이러한 모든 방법은 특히 대규모 데이터 세트를 처리할 때 다양한 장점과 과제를 제시합니다.

서브 클래스를 사용한 얼굴 인식: 얼굴 인식 성능을 개선하기 위한 방법으로 '서브 클래스'라는 개념이 논의되고 있습니다. 이 접근 방식은 가우시안 혼합을 사용하여 각 클래스의 분포를 근사화하는 것으로, 다양한 얼굴 양식에 효과적으로 적응하는 것으로 밝혀졌습니다. 그러나 이 방법은 소규모의 통제된 데이터 세트에만 적용되었습니다.

모델 반전을 통한 얼굴 합성: 이 글에서는 신원을 보존하는 얼굴 생성을 위한 생성적 적대 신경망(GAN)의 사용과 데이터 프라이버시와 관련된 과제에 대해 설명합니다. 단일 합성곱 신경망(CNN)에서 이미지를 합성할 수 있는 대안으로 모델 반전이 제안되었습니다. 또한 통계적 전제 조건(예: 평균 및 분산)을 사용하여 얼굴 이미지를 재구성하는 고유 얼굴 모델의 사용에 대해서도 언급하고 있습니다.

결론적으로, 이 글에서는 얼굴 인식의 최신 방법과 그 장점 및 단점에 대한 개요를 제공합니다. 이 분야는 빠르게 발전하고 있으며, 성능을 개선하고 대규모 데이터 세트, 데이터의 노이즈, 하위 클래스 인식 및 데이터 프라이버시와 관련된 문제를 해결하기 위해 수많은 전략이 개발되고 있습니다.

### 3 PROPOSED APPROACH

이 논문에서는 심층 얼굴 인식 기법인 ArcFace를 제안합니다. 가장 기본적인 의미에서 이 기법은 손실 함수에 각도 마진 페널티를 추가하여 클래스 내 소형화 및 클래스 간 불일치를 개선합니다. 이 아이디어는 얼굴 인식 시스템에서 널리 사용되는 소프트맥스 손실 함수를 기반으로 하지만, 클래스 내 및 클래스 간 차이에 대한 명시적인 최적화가 없다는 약점을 개선하는 것을 목표로 합니다. 저자는 이러한 기능이 특히 클래스 내 외모 변화가 크고 대규모 테스트 시나리오에서 효율적인 얼굴 인식을 위한 핵심 요소라고 주장합니다.

![Norm-Softmax와 ArcFace 손실 아래의 8개 신원에 대한 2D 피처의 장난감 예. 점들은 샘플을 나타내고 선들은 각 신원의 중심 방향을 나타냅니다. 피처 정규화에 기반하여, 모든 얼굴 피처들은 고정된 반경으로 아크 공간으로 밀어 넣어집니다. 가장 가까운 클래스 사이의 측지 거리 마진은 부가적인 각도 마진 패널티가 포함됨에 따라 명확해집니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%202.png)

Norm-Softmax와 ArcFace 손실 아래의 8개 신원에 대한 2D 피처의 장난감 예. 점들은 샘플을 나타내고 선들은 각 신원의 중심 방향을 나타냅니다. 피처 정규화에 기반하여, 모든 얼굴 피처들은 고정된 반경으로 아크 공간으로 밀어 넣어집니다. 가장 가까운 클래스 사이의 측지 거리 마진은 부가적인 각도 마진 패널티가 포함됨에 따라 명확해집니다.

![대상 로짓 분석. (a) ArcFace 훈련 동안의 시작부터 끝까지의 θj 분포. (2) Softmax, SphereFace, ArcFace, CosFace 및 결합 마진 페널티 (cos(m1θ + m2) − m3)에 대한 대상 로짓 곡선.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%203.png)

대상 로짓 분석. (a) ArcFace 훈련 동안의 시작부터 끝까지의 θj 분포. (2) Softmax, SphereFace, ArcFace, CosFace 및 결합 마진 페널티 (cos(m1θ + m2) − m3)에 대한 대상 로짓 곡선.

![이진 분류 케이스에서의 다른 손실 함수들의 결정 마진. 파선은 결정 경계를 나타내고, 회색 영역들은 결정 마진입니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%204.png)

이진 분류 케이스에서의 다른 손실 함수들의 결정 마진. 파선은 결정 경계를 나타내고, 회색 영역들은 결정 마진입니다.

ArcFace의 손실 함수는 예측이 특징과 가중치 사이의 각도에만 의존하도록 조작되며, 임베딩 특징이 하이퍼스피어에 분산되어 있습니다. 이렇게 하면 모든 것을 동일한 척도에 배치하여 작업을 단순화하는 데 도움이 됩니다. 그런 다음 클래스 분리와 유사성을 향상시키기 위해 추가 각도 마진 페널티가 도입됩니다.

저자들은 ArcFace를 마진 페널티를 사용하는 SphereFace 및 CosFace와 같은 유사한 방법과 비교합니다. 이러한 기법에도 장점이 있지만, 저자는 각도 여백이 측지 거리에 직접적으로 대응하여 선형적이고 일정한 여백을 제공하기 때문에 ArcFace에 사용된 가산 각도 여백이 더 나은 기하학적 속성을 가지고 있다고 주장합니다.

저자는 하이퍼스피어에서 클래스 내 콤팩트함과 클래스 간 불일치를 적용하기 위해 몇 가지 다른 클래스 내 및 클래스 간 손실 함수도 제안합니다. 이러한 함수는 인터-로스 및 인트라-로스 방정식으로 표현됩니다. 이러한 손실은 각각 샘플과 기준점 중심 사이의 각도 또는 호, 서로 다른 중심 사이의 각도 또는 호를 최적화하도록 설계되었습니다.

마지막으로, 저자는 삼중 샘플 사이의 각도/호 마진을 확대하는 것을 목표로 하는 삼중 손실의 적용에 대해 설명합니다.

결론적으로, 저자는 손실 함수에 각도 마진 페널티를 추가하여 클래스 내 및 클래스 간 관계를 최적화함으로써 얼굴 인식 시스템의 성능을 향상시키는 새로운 접근 방식을 제공하는 ArcFace를 제안합니다.

제공된 텍스트는 노이즈가 있는 데이터에서 견고성을 향상시키기 위해 각 ID에 대한 하위 센터를 도입하여 ArcFace 알고리즘을 개선한 내용을 자세히 설명합니다. 하위 센터 ArcFace로 알려진 이 개선된 방법은 각 ID 클래스 내의 하위 클래스를 활용하여 대규모 데이터 세트의 노이즈를 더 잘 처리합니다. 하위 센터는 "깨끗한" 샘플과 "어려운" 샘플 또는 노이즈가 있는 샘플을 분리하여 ArcFace가 더욱 정확하고 강력한 얼굴 인식 기능을 수행할 수 있도록 지원합니다.

![(a) CASIA 데이터셋 [56]에서 하나의 신원에 대한 서브 클래스들은 sub-center ArcFace 손실 (K = 10)을 사용한 후. 잡음 샘플들과 어려운 샘플들 (예: 프로필 및 가린 얼굴)은 대부분의 깨끗한 샘플들로부터 자동으로 분리됩니다. (b) 지배적인 하위 클래스와 비지배적인 하위 클래스의 샘플들로부터의 각도 분포. 깨끗한 데이터는 sub-center ArcFace에 의해 자동으로 분리됩니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%205.png)

(a) CASIA 데이터셋 [56]에서 하나의 신원에 대한 서브 클래스들은 sub-center ArcFace 손실 (K = 10)을 사용한 후. 잡음 샘플들과 어려운 샘플들 (예: 프로필 및 가린 얼굴)은 대부분의 깨끗한 샘플들로부터 자동으로 분리됩니다. (b) 지배적인 하위 클래스와 비지배적인 하위 클래스의 샘플들로부터의 각도 분포. 깨끗한 데이터는 sub-center ArcFace에 의해 자동으로 분리됩니다.

![ArcFace (K=1) 및 제안된 sub-center ArcFace (K=3)의 데이터 분포는 비지배적인 서브센터들을 제거하기 전과 후. 여기서 MS1MV0 [37]을 사용했습니다. K = 3 ↓ 1은 비지배적인 서브센터를 제거하는 서브센터 ArcFace를 나타냅니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%206.png)

ArcFace (K=1) 및 제안된 sub-center ArcFace (K=3)의 데이터 분포는 비지배적인 서브센터들을 제거하기 전과 후. 여기서 MS1MV0 [37]을 사용했습니다. K = 3 ↓ 1은 비지배적인 서브센터를 제거하는 서브센터 ArcFace를 나타냅니다.

주요 개념은 다음과 같습니다:

서브센터 ArcFace: 이 접근 방식은 각 신원을 K개의 서브클래스 또는 서브센터로 세분화합니다. 이러한 하위 센터는 깨끗한 샘플과 노이즈가 있거나 딱딱한 샘플을 분리하여 견고성을 향상시킵니다. 연구진은 깨끗한 얼굴의 대부분(85.6%)이 우세한 하위 클래스에 속하는 반면, 딱딱하고 노이즈가 많은 얼굴은 비우세한 하위 클래스에 속한다는 사실을 발견했습니다.

시각적 클러스터링 결과: 저자들은 하위 중심 ArcFace 손실을 적용한 후 CASIA 데이터 세트에서 신원의 클러스터링 결과를 시각화하여 제공합니다. 이 시각화는 새로운 손실 함수가 자동으로 얼굴을 클러스터링하여 하드 샘플과 노이즈 샘플을 우세한 클린 샘플로부터 분리할 수 있음을 보여줍니다.

노이즈 감소: 저자는 다양한 데이터 세트에서 노이즈 비율을 비교하고 서브센터 ArcFace를 사용하여 노이즈 비율이 크게 감소하여 노이즈 하에서 방법의 견고성이 향상되었음을 입증했습니다.

클래스 내 컴팩트함: 서브 클래스는 노이즈 하에서 견고성을 향상시킬 수 있지만, 딱딱한 샘플도 멀리 떨어져 있기 때문에 클래스 내 컴팩트성을 약화시킬 수 있습니다. 이를 방지하기 위해 네트워크가 충분한 변별력을 확보한 후에 비우세 서브 센터를 삭제합니다.

![ArcFace는 분류 모델 뿐만 아니라 생성 모델입니다. 사전 훈련된 ArcFace 모델이 주어지면, 무작위 입력 텐서는 ArcFace 손실의 그래디언트와 배치 정규화 계층에 저장된 얼굴 통계 사전을 사용하여 미리 정의된 신원으로 점차 업데이트될 수 있습니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%207.png)

ArcFace는 분류 모델 뿐만 아니라 생성 모델입니다. 사전 훈련된 ArcFace 모델이 주어지면, 무작위 입력 텐서는 ArcFace 손실의 그래디언트와 배치 정규화 계층에 저장된 얼굴 통계 사전을 사용하여 미리 정의된 신원으로 점차 업데이트될 수 있습니다.

아크페이스의 반전: 저자들은 일괄 정규화(BN) 레이어에 저장된 ArcFace 손실의 기울기와 얼굴 통계 사전값을 사용하여 신원이 보존되고 시각적으로 그럴듯한 얼굴 이미지를 재구성하는 방법을 제안합니다. 또한 선형 가중치에 저장된 클래스 중심뿐만 아니라 모든 임베딩 특징으로부터 얼굴 이미지를 복원할 수 있는 오픈셋 얼굴 생성 방법도 제안합니다.

요약하면, 저자는 잡음이 많은 환경에서의 견고성과 폐쇄 집합 및 개방 집합 얼굴 인식을 모두 수행할 수 있는 능력을 향상시키기 위해 ArcFace 방법을 수정할 것을 제안합니다.

### 4 EXPERIMENTS

이 섹션에서는 ArcFace 얼굴 인식 모델을 활용한 실험을 위한 다양한 구현 세부 사항, 학습 데이터 세트, 테스트 데이터 세트 및 설정에 대해 자세히 설명하는 것 같습니다.

훈련 데이터 세트: CASIA, VGG2, MS1MV0, Celeb500K의 네 가지 데이터 세트가 사용되었습니다. MS1MV0과 Celeb500K를 정리하고 결합하여 중복되는 신원을 제거한 후 새로운 데이터 세트인 IBUG-500K를 만들었습니다. 이 데이터 세트에는 약 1,196만 개의 이미지와 493만 개의 아이덴티티가 포함되어 있습니다.

테스트 데이터 세트: LFW, CFP-FP, AgeDB 등과 같은 검증 데이터 세트가 훈련 중에 사용되었습니다. 포즈와 연령의 변화가 큰 데이터세트에 대해서도 성능을 테스트했습니다. 또한 MegaFace, IJB-B, IJB-C, LFR2019-Image와 같은 대규모 이미지 데이터 세트에서 ArcFace의 성능을 테스트했습니다.

실험 설정: 얼굴은 RetinaFace가 예측한 5개의 얼굴 포인트를 사용하여 정규화되었습니다. 임베딩 네트워크에는 CNN 아키텍처인 ResNet50과 ResNet100이 사용되어 최종적으로 512-D 임베딩 피처를 생성했습니다. 훈련은 배치 크기가 512인 8개의 엔비디아 테슬라 P40 GPU에서 수행되었습니다. 학습 속도와 훈련 기간은 사용된 데이터 세트에 따라 조정되었습니다.

아크페이스에 대한 제거 연구: ArcFace의 각도 마진 설정을 탐색하기 위해 제거 연구를 수행했습니다. 결합된 마진 프레임워크가 제안되었는데, 이 프레임워크는 SphereFace와 CosFace보다 성능이 뛰어나지만, 성능은 ArcFace의 상한선을 넘었습니다. 클래스 내 소형화 및 클래스 간 불일치를 강제하기 위한 다양한 손실도 검토했습니다. ArcFace 모델은 클래스 내 컴팩트성, 클래스 간 불일치, 분류 마진을 효과적으로 적용하는 것으로 확인되어 클래스 내 손실, 클래스 간 손실, 삼중 손실의 추가 통합이 불필요한 것으로 나타났습니다.

전반적으로 이 섹션은 다양한 설정과 다양한 벤치마크 데이터 세트에 대한 ArcFace 얼굴 인식 모델의 성능에 초점을 맞춘 대규모 연구 논문의 일부인 것으로 보입니다. 결과는 ArcFace가 이 작업에 효과적인 모델임을 시사합니다.

MS1MV3, MS1MV0, IBUG-500K 등 다양한 데이터셋을 사용하여 ArcFace를 활용한 얼굴 인식 실험 결과와 제안된 방법인 서브센터 ArcFace에 대해 논의하고 있는 것 같습니다.

이 연구의 주요 결과는 다음과 같이 요약할 수 있습니다:

ArcFace는 MS1MV0과 같은 노이즈가 있는 데이터에 대해 훈련할 때 MS1MV3과 같은 깨끗한 데이터에 비해 성능이 크게 떨어집니다. 반면, 제안된 서브센터 ArcFace는 노이즈에 더 강합니다.

![Close-set 얼굴 생성. ArcFace는 모델 파라미터만을 사용하여 GAN에서와 같이 추가적인 판별자와 생성자를 훈련시키지 않고도 신원을 보존하는 얼굴 이미지를 생성할 수 있습니다. 첫 번째 열은 훈련 데이터에서의 신원입니다. 열 2에서 4는 우리의 ArcFace 모델에서의 출력입니다. 열 5에서 7은 기준 CosFace 모델에서의 출력입니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%208.png)

Close-set 얼굴 생성. ArcFace는 모델 파라미터만을 사용하여 GAN에서와 같이 추가적인 판별자와 생성자를 훈련시키지 않고도 신원을 보존하는 얼굴 이미지를 생성할 수 있습니다. 첫 번째 열은 훈련 데이터에서의 신원입니다. 열 2에서 4는 우리의 ArcFace 모델에서의 출력입니다. 열 5에서 7은 기준 CosFace 모델에서의 출력입니다.

서브센터의 수(K)와 클래스 내 소형화 사이에 균형을 유지해야 합니다. 서브센터가 너무 많으면 정확도가 떨어질 수 있습니다. 연구진은 이를 고려하여 K=3을 선택했습니다.

서브센터 할당에 최대 풀링을 사용하는 것이 소프트 최대 풀링보다 약간 더 효과적이라는 것이 입증되어 다음 실험에서는 최대 풀링을 선택하게 되었습니다.

비우세한 하위 센터와 신뢰도가 높은 잡음 샘플을 삭제하는 것이 하위 센터 간의 밀집도를 강화하기 위해 정규화를 추가하는 것보다 더 나은 결과를 제공했습니다. 연구진은 신뢰도가 높은 노이즈 샘플을 제거하기 위해 75◦ 임계값을 선택했습니다.

공동 채굴 및 가중치 재조정 방법과 같은 다른 방법도 노이즈 강건성을 개선할 수 있지만, 서브센터 ArcFace는 훈련 중에 더 나은 자동 클린 데이터와 노이즈 데이터 격리를 제공했습니다.

클린 데이터에서 서브센터 ArcFace는 표준 ArcFace와 비슷한 성능을 달성했습니다. 또한 4.18%의 하드 샘플을 제거해도 성능이 약간만 감소했으며, 이는 데이터 세트에 여전히 약간의 노이즈가 포함되어 있음을 시사합니다.

노이즈가 있는 MS1MV0에 대해 훈련된 서브센터 ArcFace는 수동으로 정리된 MS1MV3에 대해 훈련된 ArcFace와 비슷한 성능을 보였습니다.

훈련 데이터가 클수록 서브센터 ArcFace는 노이즈가 있는 웹 페이스로 훈련했을 때에도 향상된 성능을 보였습니다.

이 연구는 LFW, YTF, CFP-FP, CPLFW, AgeDB, CALFW, MegaFace 등 널리 사용되는 다른 얼굴 인식 데이터 세트에 대한 벤치마크 결과도 제공합니다. 모든 경우에서, 특히 대규모 데이터 세트에 대해 훈련했을 때 ArcFace는 인상적인 성능을 보여주며 얼굴 인식 작업에 대한 이 방법의 효율성을 강조합니다.

![사전 훈련된 ArcFace 모델에서의 Open-set 얼굴 생성. 우리는 나이, 성별, 인종, 자세 및 가림 변형 하에서의 ArcFace inversion 결과 (오른쪽)를 LFW [89] 테스트 샘플 (왼쪽)에서의 임베딩 피처만을 사용하여 보여줍니다. 아래에서, 우리는 ArcFace inversion에서 생성된 일부 나쁜 사례 (예: 성별 혼란)를 보여줍니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%209.png)

사전 훈련된 ArcFace 모델에서의 Open-set 얼굴 생성. 우리는 나이, 성별, 인종, 자세 및 가림 변형 하에서의 ArcFace inversion 결과 (오른쪽)를 LFW [89] 테스트 샘플 (왼쪽)에서의 임베딩 피처만을 사용하여 보여줍니다. 아래에서, 우리는 ArcFace inversion에서 생성된 일부 나쁜 사례 (예: 성별 혼란)를 보여줍니다.

![BN 제약 없이 및 BN 제약과 함께 Open-set 얼굴 생성. 첫 번째 행은 원래의 LFW [89] 샘플입니다. 두 번째 행은 BN 제약 없이 ArcFace inversion 결과이며, 세 번째 행은 BN 제약이 있는 ArcFace inversion 결과입니다.](ArcFace%20Additive%20Angular%20Margin%20Loss%20for%20Deep%20Face%209a173a09d29f4115a9275d31e3268efc/Untitled%2010.png)

BN 제약 없이 및 BN 제약과 함께 Open-set 얼굴 생성. 첫 번째 행은 원래의 LFW [89] 샘플입니다. 두 번째 행은 BN 제약 없이 ArcFace inversion 결과이며, 세 번째 행은 BN 제약이 있는 ArcFace inversion 결과입니다.

ArcFace는 다양한 피사체의 정지 이미지와 동영상으로 구성된 두 가지 데이터 세트인 IJB-B와 IJB-C에서 테스트됩니다. 이 모델은 1:1 검증 및 1:N 식별 프로토콜을 사용하여 평가됩니다. 연구진은 ArcFace 모델이 소프트맥스 기반 방식에 비해 성능이 크게 향상되었음을 발견했습니다. 더 큰 데이터 세트와 더 심층적인 신경망으로 모델을 학습시켰을 때 더 큰 개선이 나타났습니다.

또한 ArcFace는 다른 방법인 커리큘럼페이스보다 성능이 뛰어났으며, 이는 제안된 서브센터 ArcFace에서 자동으로 정리된 데이터가 성능을 향상시킨다는 것을 입증했습니다. 이 모델은 대규모 MC-FaceGraph 데이터 세트에서도 테스트되었으며, 더 적은 수의 신원 정보에 적용되었음에도 불구하고 MC-FaceGraph 모델의 성능을 능가했습니다.

그 후 이 모델은 1:N 엔드투엔드 혼합 프로토콜에서 테스트되었으며 두 데이터 세트 모두에서 인상적인 성능을 달성하여 새로운 기록을 세웠습니다.

또 다른 테스트에서는 엄격한 계산 제약 조건 하에서 얼굴 인식 방법을 벤치마킹하는 것을 목표로 하는 경량 얼굴 인식(LFR) 챌린지에서 ArcFace가 평가되었습니다. ArcFace는 LFR2019-Image 트랙에서 챌린지 우승자와 비슷한 성능을 달성했으며, LFR2019-Video 트랙에서는 우승자를 능가했습니다.

마지막으로 ArcFace 모델은 피사체의 중심 또는 특징에서 신원이 보존된 얼굴 이미지를 합성하는 데 사용되었습니다. 이 모델은 이미지 품질과 신원 보존 측면에서 다른 모델보다 훨씬 뛰어난 성능을 보였습니다.

전반적으로 이 논문은 ArcFace가 여러 테스트와 평가에서 다른 방법을 능가하는 매우 효과적인 얼굴 인식 모델임을 입증합니다.

### 5 CONCLUSIONS

이 논문에서는 심층 특징 임베딩의 변별력을 크게 향상시키는 얼굴 인식용 부가적 각도 마진 손실 함수인 ArcFace를 소개합니다. 이 알고리즘은 깨끗한 얼굴에는 하나의 우세 서브클래스를, 딱딱하거나 노이즈가 많은 얼굴에는 비우세 서브클래스를 권장하여 대규모 웹 얼굴을 정리하는 데 도움이 됩니다. 또한 ArcFace는 특징 벡터를 얼굴 이미지에 매핑할 수 있는 향상된 생성 성능을 보여줍니다.

ArcFace는 네트워크 그라데이션과 BN 전제 조건만을 사용하여 훈련 데이터 내부와 외부의 피사체에 대해 신원이 보존된 얼굴 이미지를 생성할 수 있습니다. 그러나 현재는 반전 시 특정 얼굴 포즈와 표정을 제어할 수 없습니다.

향후 연구에서는 이러한 한계를 해결하여 얼굴 인식 모델을 더욱 다양하게 활용할 수 있도록 하는 것이 목표입니다. 또한, 연구자들은 얼굴 인식 모델을 반전할 수 없도록 만들어 모델 가중치로 얼굴 이미지가 재구성되는 것을 방지함으로써 개인 정보를 보호하는 방법을 연구할 계획입니다.

- 모델의 입력과 출력
    
    모델인 ArcFace는 주로 얼굴 인식 작업에 사용됩니다. 그러므로, 모델의 입력과 출력은 다음과 같습니다:
    
    입력:
    ArcFace 모델의 입력은 주로 사전 처리된 얼굴 이미지입니다. 이 이미지는 일반적으로 얼굴 감지와 정렬을 통해 처리되며, 각 얼굴은 적절한 크기와 방향으로 조정됩니다. 추가적으로, 이미지는 일반적으로 특정 크기로 리사이즈되고, 필요에 따라 정규화되거나 색상 공간 변환(예: RGB에서 GRAYSCALE)이 수행될 수 있습니다.
    
    출력:
    ArcFace 모델의 출력은 얼굴 임베딩입니다. 이는 이미지를 고차원 벡터로 변환합니다. 이 벡터는 얼굴의 고유한 특성을 캡처하며, 다른 얼굴과 비교할 수 있는 표현 형식입니다. 얼굴 인식 시스템은 이 임베딩을 사용하여 새로운 입력 이미지가 기존에 알려진 얼굴과 일치하는지(즉, 얼굴 인식)를 결정하거나, 입력 이미지가 특정 얼굴 클래스에 속하는지(즉, 얼굴 검증)를 결정할 수 있습니다.
    
    ArcFace는 추가로 angular margin penalty를 사용하여 클래스 간 분리를 더욱 강화합니다. 이는 모델이 서로 다른 얼굴 클래스를 더욱 잘 구별하게 도와줍니다. ArcFace는 또한 sub-center ArcFace를 도입하여 실제 세계의 노이즈에 대한 내부 클래스 제약을 완화시키며, 이는 얼굴 인식 성능을 더욱 향상시킵니다.
    
- 의의
    
    ArcFace는 고전적인 얼굴 인식 방법과 많은 차별성을 가지고 있습니다. 이전의 얼굴 인식 방법과 ArcFace의 주요 차이점은 아래와 같습니다:
    
    1. **Angular Margin Loss:** ArcFace는 기존의 얼굴 인식 모델에서 사용되는 softmax loss 함수 대신에 새로운 Additive Angular Margin Loss라는 loss 함수를 제안하였습니다. 이는 각 클래스 간의 각도 마진을 최적화하여 클래스 간의 분리를 향상시키는 역할을 합니다. 이 기술은 얼굴 특징 임베딩의 판별력을 크게 향상시키며, 기존 모델보다 더욱 높은 인식 성능을 보여줍니다.
    2. **Sub-center 구조:** ArcFace는 또한 sub-center ArcFace라는 개념을 도입했습니다. 이는 대규모 실제 세계 노이즈에 대한 클래스 내 제약을 완화하기 위한 것입니다. Sub-center ArcFace는 깨끗한 얼굴들이 주를 이루는 주류 서브 클래스와, 어려운 혹은 노이즈가 있는 얼굴들이 포함된 비주류 서브 클래스를 통해 자동으로 분리를 수행합니다. 이는 웹 얼굴 데이터를 정리하는 데 사용될 수 있습니다.
    3. **Generative Power:** ArcFace는 또한 generative model로서의 역할을 수행할 수 있습니다. 이는 얼굴 이미지를 생성하는 데 사용될 수 있습니다. 이를 통해, 학습 데이터 내부 및 외부의 주체에 대해 신원을 보존한 얼교 이미지를 생성할 수 있습니다.
    
    이 세 가지 요소는 ArcFace를 이전의 얼굴 인식 방법들과 비교하여 뛰어난 성능을 보여주는 주요 요인들입니다.
    
- 얼굴인식 모델
    
    일반적인 얼굴 인식 모델은 크게 두 가지 단계로 구성되어 있습니다: 얼굴 검출(face detection) 및 얼굴 인식(face recognition).
    
    **얼굴 검출 (Face Detection)**:
    이 단계에서는 이미지 또는 비디오에서 얼굴의 위치를 검출합니다. 이는 보통 머신러닝 방법, 예를 들어 Haar 특징 기반의 AdaBoost 또는 딥러닝 방법, 예를 들어 CNN (Convolutional Neural Network)을 사용하여 수행됩니다.
    
    **얼굴 인식 (Face Recognition)**:
    얼굴 검출 단계를 통해 찾아진 얼굴 영역이 주어지면, 이제 각 얼굴을 고유한 개체로 인식하는 단계가 이어집니다. 이 단계에서도 다양한 방법들이 사용될 수 있습니다. 가장 단순한 형태로는 픽셀 기반의 비교가 있지만, 이는 조명, 표정, 포즈 등의 변화에 매우 취약합니다.
    
    따라서 이러한 변화에 대응하기 위해 더 복잡한 기법들이 도입되었는데, 주로 피처 기반의 방법입니다. 이들은 얼굴의 특징점(예를 들어 눈, 코, 입 등)을 추출하거나, 얼굴 전체의 질감 패턴을 분석하는 방법들입니다. 이러한 특징들은 분류기(예를 들어 SVM, KNN 등)에 입력되어 각 얼굴이 어느 클래스에 속하는지를 결정합니다.
    
    딥러닝의 발전으로 인해 최근에는 Convolutional Neural Networks (CNN)나 Deep Neural Networks (DNN)와 같은 모델이 널리 사용되고 있습니다. 이러한 모델들은 이미지에서 직접적으로 특징을 학습하고, 이를 바탕으로 얼굴 인식을 수행합니다.
    
    또한, 얼굴을 벡터 공간에 임베딩하여 인식하는 방법도 널리 사용되고 있습니다. 대표적인 예로는 FaceNet, DeepFace, ArcFace 등이 있습니다. 이러한 모델들은 얼굴 이미지를 임베딩 벡터로 변환하고, 이 벡터 간의 거리를 이용해 얼굴을 인식합니다. 이는 신원이 같은 얼굴들의 임베딩은 가깝게, 신원이 다른 얼굴들의 임베딩은 멀게 위치하도록 학습됩니다.