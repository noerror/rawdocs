# MobileHumanPose: Toward Real-Time 3D Human Pose Estimation in Mobile Devices

[https://github.com/SangbumChoi/MobileHumanPose](https://github.com/SangbumChoi/MobileHumanPose)

[https://openaccess.thecvf.com/content/CVPR2021W/MAI/html/Choi_MobileHumanPose_Toward_Real-Time_3D_Human_Pose_Estimation_in_Mobile_Devices_CVPRW_2021_paper.html](https://openaccess.thecvf.com/content/CVPR2021W/MAI/html/Choi_MobileHumanPose_Toward_Real-Time_3D_Human_Pose_Estimation_in_Mobile_Devices_CVPRW_2021_paper.html)

### 1. Introduction

이 연구는 로봇 공학, 감시, 증강 현실, 가상 현실과 같은 분야, 특히 모바일 기기용 애플리케이션을 위해 설계된 새롭고 효율적인 3D 인체 포즈 추정 모델을 소개합니다. 딥러닝 기반 모델은 3D 인체 자세 추정에서 상당한 성능을 보여 왔지만, 상당한 연산 능력이 필요하기 때문에 스마트폰과 같이 리소스가 제한된 디바이스에는 적합하지 않은 경우가 많습니다. 이 연구는 이전 연구에서 충분히 탐구되지 않은 이 문제를 해결하는 것을 목표로 합니다.

![잔차와 스킵 연결 구조 사이의 차이. 잔차 연결은 다운/업 샘플링된 특징을 가진 인접 블록 사이에 구현됩니다. 반면, 스킵 연결은 차원이 같은 인코더와 디코더 사이의 순수한 연결입니다.](MobileHumanPose%20Toward%20Real-Time%203D%20Human%20Pose%20Est%20e1d7ca7e56874757baa916fd40d71c9a/Untitled.png)

잔차와 스킵 연결 구조 사이의 차이. 잔차 연결은 다운/업 샘플링된 특징을 가진 인접 블록 사이에 구현됩니다. 반면, 스킵 연결은 차원이 같은 인코더와 디코더 사이의 순수한 연결입니다.

저자들은 성능과 계산 비용 사이의 균형을 맞추기 위해 '모바일 친화적인' 네트워크를 제안합니다. 저자들은 MobileNetV2와 같은 경량 모델이 이미지 분류 작업에는 잘 작동하지만 3D 사람 포즈 추정을 위한 미세 조정에는 어려움을 겪는다는 사실을 관찰했습니다. 제안된 해결책은 모델의 구조를 수정하고 데이터 세트에 대해 사전 학습되지 않은 무작위로 초기화된 버전을 사용하는 것입니다. 이러한 수정에는 채널 수 조정, 활성화 기능, U-Net에서 영감을 얻은 스킵 연결 추가 등이 포함됩니다.

성능과 효율성을 비교하기 위해 대형, 소형, 초소형 등 다양한 버전의 모델이 설계되었습니다. 대형 모델은 현재 선도적인 모델에 필적하는 유망한 결과를 보여주지만 매개변수와 계산 요구 사항이 훨씬 적습니다. 초소형 모델은 작은 크기에도 불구하고 인상적인 정확도와 속도를 제공합니다.

![모바일 애플리케이션에서 우리의 모델을 사용한 전체 구현 과정 예시. 먼저, 개별적으로 잘라낸 이미지가 MobileHumanPose 모델로 전달되고, 이 모델이 3D 관절 좌표를 제공합니다. 그 다음, 3D 관절 좌표가 해당 스켈레톤과 함께 3D 공간에 표시됩니다. 마지막으로, 시각화 과정에서 스켈레톤 뒤의 효과가 제거되고 카메라 시점에서 남은 효과 부분이 남습니다. 이렇게 하면 실제 애플리케이션에서 다양한 가상 3D 효과를 사용할 수 있습니다.](MobileHumanPose%20Toward%20Real-Time%203D%20Human%20Pose%20Est%20e1d7ca7e56874757baa916fd40d71c9a/Untitled%201.png)

모바일 애플리케이션에서 우리의 모델을 사용한 전체 구현 과정 예시. 먼저, 개별적으로 잘라낸 이미지가 MobileHumanPose 모델로 전달되고, 이 모델이 3D 관절 좌표를 제공합니다. 그 다음, 3D 관절 좌표가 해당 스켈레톤과 함께 3D 공간에 표시됩니다. 마지막으로, 시각화 과정에서 스켈레톤 뒤의 효과가 제거되고 카메라 시점에서 남은 효과 부분이 남습니다. 이렇게 하면 실제 애플리케이션에서 다양한 가상 3D 효과를 사용할 수 있습니다.

이 연구의 주요 기여는 다음과 같습니다:

- 충분히 연구되지 않은 3D 인체 포즈 추정의 효율성 문제에 대한 조사.
- 실시간 3D 인체 포즈 추정을 위한 효율적인 모델인 MobileHumanPose를 제안하고, 제한된 계산 능력에서 다른 대안에 비해 가장 우수한 성능을 보였습니다.
- 3D 인체 자세 추정을 기반으로 한 실제 모바일 애플리케이션을 개발하여 연구자들이 코드를 공유함으로써 더 많은 사람들이 사용할 수 있도록 했습니다.

### 2. Related work

관련 작업 섹션에서는 저자가 자신의 연구와 관련된 다양한 주제에 대해 논의합니다:

효율적인 아키텍처: AlexNet과 VGG가 출시된 후 많은 연구자들이 더 깊고 넓은 신경망을 제안했습니다. 그러나 이러한 모델은 네트워크 깊이가 증가함에 따라 기울기가 사라지는 문제에 직면했습니다. 이 문제는 역전파 신호 강도를 유지하기 위해 잔여 연결을 사용하여 해결되었습니다. MobileNetV2 및 MobileNeXt와 같은 특정 네트워크는 더 적은 매개변수와 낮은 계산 비용으로 리소스가 제한된 상황을 위해 설계되었습니다. 다른 연구에서는 모바일 디바이스를 대상으로 모델 효율성을 위해 신경망 아키텍처 검색(NAS)을 사용하기도 했습니다. 일부 접근 방식은 저렴한 연산자를 사용하거나 '고스트 모듈'과 같이 채널 크기를 줄임으로써 계산 성능을 줄입니다.

2D 인체 포즈 추정: 이를 위한 방법은 일반적으로 상향식 접근 방식과 하향식 접근 방식으로 나뉩니다. 상향식 접근 방식은 사람 관절의 가능한 모든 후보를 검색하여 가장 정확한 연결점을 찾는 반면, 하향식 접근 방식은 먼저 사람을 감지한 다음 포즈를 추정합니다. 저자는 2D 인체 포즈 추정에 사용된 U-Net 구조의 효율성을 검토하고 이를 3D 작업에 적용합니다.

3D 인체 포즈 추정: 이러한 방법은 2단계 접근 방식과 1단계 접근 방식으로 분류할 수 있습니다. 2단계 방식은 2D 관절을 추출한 다음 3D로 변환하는 반면, 1단계 방식은 체적 히트맵을 기반으로 3D 관절을 직접 추출합니다. 그러나 대부분의 포즈 추정 모델은 성능에 초점을 맞추기 때문에 많은 모바일 애플리케이션에 적합하지 않은 높은 계산 비용이 필요합니다. 몇몇 모델만이 효율성 문제를 해결하지만 정확성과 효율성 사이에서 완벽한 균형을 맞추지 못합니다. 이 문제를 해결하기 위해 저자들은 3D 인체 포즈 추정을 위한 새로운 경량 모델을 제안합니다.

### 3. Proposed Method

저자들이 제안한 방법인 'MobileHumanPose'는 3D 인체 포즈 추정에 대한 가볍고 효율적인 접근 방식을 중심으로 합니다. 이 방법은 몇 가지 주요 구성 요소로 이루어져 있습니다:

초기화 문제: 대부분의 3D 인체 포즈 추정 논문은 ImageNet에서 사전 학습된 백본 네트워크를 활용합니다. 그러나 이 연구에서는 무작위로 초기화된 네트워크도 동일한 성능을 발휘한다고 제안합니다. 연구 결과에 따르면 무작위로 초기화된 네트워크는 56.38mm MPJPE의 낮은 평가 오류를 산출합니다.

![제안된 연결 구조의 그림. 스킵 연결은 우리의 최종 모델에 사용되었습니다](MobileHumanPose%20Toward%20Real-Time%203D%20Human%20Pose%20Est%20e1d7ca7e56874757baa916fd40d71c9a/Untitled%202.png)

제안된 연결 구조의 그림. 스킵 연결은 우리의 최종 모델에 사용되었습니다

백본 네트워크: 저자들은 모델 효율성을 위해 경량 백본 네트워크를 통합하도록 기준 구조를 수정합니다. 여러 네트워크의 성능을 테스트하고 특정 수정을 거친 후 궁극적으로 MobileNetV2를 백본으로 선택합니다.

활성화 기능: 이 연구에서는 학습 가능한 파라미터로 인해 성능이 향상된다는 점에 주목하여 2D 사람 포즈 추정 작업에서 파라메트릭 ReLU(PReLU) 함수를 사용합니다. 그런 다음 3D 포즈 추정 작업에 PReLU를 적용하여 표준 ReLU 활성화 함수보다 성능이 뛰어나다는 것을 확인했습니다.

연결 건너뛰기: 추론 속도를 개선하고 모델 효율성을 높이기 위해 저자는 '잔여 연결'과 '건너뛰기 연결'이라는 두 가지 유형의 서로 다른 연결 구조를 사용할 것을 제안합니다. 건너뛰기 연결은 인코더에서 디코더로 낮은 수준의 특징 신호를 도출할 수 있기 때문에 선호되며, 잔여 연결은 그렇지 않습니다.

손실: 저자는 손실 함수에 대해 기준 좌표와 예측 좌표 사이의 L1 손실을 사용합니다.

결론적으로 이 연구는 초기화, 네트워크 선택, 활성화 함수, 연결 구조에 중점을 두고 모델 효율성에 중점을 둔 3D 인체 포즈 추정에 대한 새로운 접근 방식을 제안합니다. 연구 결과에 따르면 무작위 초기화, MobileNetV2 사용, PReLU 구현, 스킵 연결의 적용이 더 나은 성능과 효율적인 모델로 이어진다는 것을 보여줍니다.

### 4. Experiment

저자들은 두 가지 3D 인체 포즈 데이터 세트인 Human3.6M과 MuCo-3DHP, 그리고 추가 2D 인체 포즈 MPII 데이터 세트와 인체 키포인트 감지를 위한 COCO 데이터 세트에 대해 일련의 실험을 수행합니다. 데이터 세트는 두 가지 프로토콜로 나뉘며, 각 프로토콜에는 특정 훈련 및 테스트 데이터 세트가 있습니다. 관절 위치 오차당 평균(MPJPE)과 관절 위치 오차당 프로크루스테스 분석 평균(PA-MPJPE)이 평가 지표로 사용됩니다.

저자들은 성능 향상을 위해 사전 학습된 백본 네트워크가 필요하지 않다는 이전 실험 결과를 바탕으로 무작위 초기화 방법을 활용했습니다. 초기 학습률은 10^-3, 배치 크기는 24인 아담 옵티마이저를 사용했으며, 두 개의 NVIDIA TITAN RTX GPU를 사용하여 25회에 걸쳐 MobileHumanPose 모델을 훈련했습니다. 회전, 수평 플립, 컬러 지터링, 합성 오클루전 등의 데이터 증강도 적용되었습니다.

베이스라인 트레이닝에는 PyTorch를, 모바일 디바이스 구현에는 TFLite를 사용했습니다. 다양한 백본 네트워크를 비교하기 위해 실험을 수행한 결과, 처음 4개의 반전된 잔여 블록에 대한 채널 크기를 수정한 MobileNetV2가 선택되었습니다.

초기화, 채널 수정, 활성화 기능 및 연결 구조에 초점을 맞춘 추가 절제 연구가 수행되었습니다:

초기화 및 채널 수정: 초기화가 무작위로 이루어졌는지, ImageNet 데이터 세트에서 사전 학습되었는지 여부에 관계없이 수정된 버전의 MobileNetV2가 더 낮은 MPJPE를 보였습니다.
활성화 기능: PReLU 기능을 사용하면 ReLU 기능에 비해 MPJPE가 2.65mm 더 낮아졌습니다. 그러나 PReLU는 처리량과 추론 시간에는 큰 영향을 미치지 않았지만 추가 기울기 변수로 인해 GPU에 더 많은 역전파 메모리가 필요했습니다.
연결 구조: 건너뛰기 연결이 더 효과적이었으며, 아키텍처의 더 깊은 계층에 더 풍부한 정보를 전달할 수 있었습니다. 잔여 연결은 채널 크기가 커져 매개변수 수와 FLOP이 증가하더라도 성능이 좋지 않았습니다.
비용 효율성: 저자는 백본 폭 승수와 중간 계층의 채널 크기라는 두 가지 차원을 고려하여 아키텍처 설계를 검토했습니다. 그 결과 폭 배수를 줄이면 성능에 큰 영향을 주지 않으면서 아키텍처 효율성이 향상된다는 사실을 발견했습니다. 그 결과 512개의 중간 채널 크기가 소형 모델에서 구현하기에 적합하며 인코더 부분이 정보 용량의 병목 현상이라는 결론을 내렸습니다.

저자들은 최신 방법과 비교한 결과, 대형 모델이 Human3.6M 프로토콜 2에서 51.44mm의 관절당 평균 위치 오류(MPJPE)를 달성한다는 사실을 입증했습니다. 그러나 이 모델은 훨씬 적은 수의 매개변수와 FLOPS로 계산 효율성 측면에서 다른 모델보다 훨씬 뛰어난 성능을 보입니다. 소형 모델도 우수한 성능을 발휘하여 2.24M 파라미터와 3.92 GFLOPS만으로 56.94mm MPJPE를 달성했습니다.

![웹에서 크롤링한 다양한 이미지에서의 질적 결과.](MobileHumanPose%20Toward%20Real-Time%203D%20Human%20Pose%20Est%20e1d7ca7e56874757baa916fd40d71c9a/Untitled%203.png)

웹에서 크롤링한 다양한 이미지에서의 질적 결과.

MuPoTS의 다인 3D 포즈 추정 작업에서 저자들의 대형 모델은 절반의 장면에서 다른 연구의 소형 모델보다 성능이 뛰어나며, 일부 장면에서는 최첨단 성능을 제공합니다. 모델의 효율성 또한 다른 모델보다 우수합니다.

![MuPoTS에서의 질적 결과](MobileHumanPose%20Toward%20Real-Time%203D%20Human%20Pose%20Est%20e1d7ca7e56874757baa916fd40d71c9a/Untitled%204.png)

MuPoTS에서의 질적 결과

저자들은 또한 추론 분석을 수행하여 소프트맥스 함수가 있는 모델과 없는 모델의 성능을 비교했습니다. 저자들이 제안한 모델의 추론 시간은 처리량, 추론 시간, 정확도, 모델 크기 등 모든 지표에서 황 박사팀과 문 박사팀이 제안한 모델보다 우수했습니다. 이들은 모바일 애플리케이션을 위해 설계된 초소형 모델을 소개하는데, 이 모델은 MoVNect와 비슷한 성능을 달성하면서도 훨씬 더 나은 MPJPE와 짧은 추론 시간을 제공합니다.

마지막으로 이들은 제안한 모델이 다양한 모바일 애플리케이션, 특히 3D 아바타 제어가 필요한 애플리케이션에서 구현될 수 있다고 제안합니다. 이들은 다양한 시각 효과를 위한 3D 조인트 좌표를 전달하기 위해 Android 및 Unity3D용 커스텀 디스패처를 개발했습니다. 또한 3D 인체 포즈 추정을 기반으로 모바일 애플리케이션을 개발하기 위한 코드를 공개할 계획입니다.

### 5. Conclusion

논문의 결론에서 저자는 높은 정확도를 유지하는 경량 모델을 개발하는 데 중점을 두었다고 요약합니다. 저자들은 기존의 경량 백본 아키텍처가 포즈 추정 작업에서 성능이 떨어진다고 주장합니다. 이 문제를 극복하기 위해 이들은 MobileNetV2 백본 네트워크의 수정된 버전을 제안합니다.

또한 건너뛰기 연결과 파라메트릭 활성화 기능을 활용하여 비용 효율성을 유지하면서 정확도를 향상시키는데, 이는 기본 아키텍처와 모델을 차별화하는 전략입니다. 그 결과 모바일 기기에서 구현할 수 있는 매우 정밀하고 컴팩트한 모델인 MobileHumanPose가 탄생했습니다.

저자들은 이 연구에 사용된 기법이 하향식 및 1단계 방식에 국한되지 않고 모든 유형의 3D 인체 포즈 추정에도 사용될 수 있다고 제안합니다. 저자들은 이번 연구를 통해 모바일 기기에서 실시간 3D 인체 자세 추정을 위한 새로운 아이디어를 얻을 수 있기를 기대합니다.