# Position Based Dynamics

[https://www.beosil.com/download/PositionBasedDynamics_VRIPHYS06.pdf](https://www.beosil.com/download/PositionBasedDynamics_VRIPHYS06.pdf)

- 2006

### 1. Introduction

컴퓨터 그래픽스 분야에서 물리 기반 애니메이션의 연구는 매우 중요한 부분을 차지합니다. 이 연구의 목적은 강체, 변형 가능한 객체, 유체 흐름과 같은 다양한 물리 현상을 컴퓨터 상에서 시뮬레이션하는 새로운 방법을 찾는 것입니다. 컴퓨터 과학 분야에서 시뮬레이션의 정확성이 가장 중요한 반면, 컴퓨터 그래픽스에서는 시뮬레이션이 얼마나 안정적이고, 신속하며, 실제와 유사하게 보이는지가 더 중요합니다. 이는 컴퓨터 그래픽스에서 사용되는 방법들이 컴퓨터 과학에서 직접 가져온 것이 아니라, 그래픽스의 특별한 요구사항에 맞게 특별히 설계되어야 함을 의미합니다.

이 논문에서 제안하는 방법은 바로 이런 특별한 요구를 충족시키기 위한 것입니다. 전통적인 물리 시뮬레이션 방식은 대체로 힘의 개념을 사용하는데, 이는 내부 및 외부 힘을 시간 단계마다 모아서 물체의 가속도로 변환한 다음, 이를 통해 속도와 위치를 계산합니다. 하지만 컴퓨터 그래픽스와 특히 컴퓨터 게임에서는 객체의 위치를 직접 제어할 수 있는 것이 종종 더 바람직합니다. 사용자는 특정 정점을 운동하는 객체에 부착하거나 정점이 충돌하는 객체 밖으로 나가지 않도록 하고 싶을 수 있습니다. 이런 조작을 쉽게 하기 위해, 우리가 제안하는 방법은 위치에 직접 작용합니다. 이는 명시적 통합의 전형적인 불안정성 문제를 제거하고, 정점의 위치와 객체 부분을 시뮬레이션 도중에 직접 조작할 수 있는 능력을 제공합니다. 또한, 일반적인 제약 조건을 위치 기반 설정에서 처리할 수 있게 하며, 위치 기반 해결사는 이해하고 구현하기 쉽다는 장점이 있습니다.

![압력을 받는 옷감 캐릭터에 적용된 알려진 변형 벤치마크 테스트.](Position%20Based%20Dynamics%207ba41a0be0f8410696e9b05859b550c5/Untitled.png)

압력을 받는 옷감 캐릭터에 적용된 알려진 변형 벤치마크 테스트.

### 2. Related Work

컴퓨터 그래픽스에서 변형 가능한 객체를 시뮬레이션하기 위한 연구는 매우 다양하고 광범위합니다. 이러한 연구의 목표는 물리적으로 신뢰할 수 있으면서도 계산적으로 효율적인 방법을 찾아내어, 컴퓨터 상에서 실제와 같은 물리 현상을 재현하는 것입니다. 최신 연구 동향을 살펴보면, 컴퓨터 그래픽스에서는 주로 질량-스프링 시스템, 유한 요소 방법, 유한 차분 접근법 같은 기법들이 사용되고 있습니다.

하지만, 이러한 방법들 중에서도 위치 기반 동역학(Position Based Dynamics, PBD)은 특별한 주목을 받고 있습니다. PBD는 객체의 동적인 행동을 시뮬레이션하는 데 있어서 힘 대신 객체의 위치를 직접 조정함으로써 작동합니다. 이 접근 방식은 사용자가 더 직접적으로 객체의 움직임을 제어할 수 있게 하며, 명시적인 통합 문제와 같은 일반적인 불안정성을 해결하는 데 유용합니다.

이 챕터에서 언급된 몇몇 연구들은 PBD의 초기 형태나 아이디어를 다루고 있지만, 이를 명확하게 '위치 기반 동역학'이라고 칭하진 않았습니다. 예를 들어, Jakobsen은 위치 기반 접근을 사용하여 그의 Fysix 엔진을 구축했으며, 이는 속도를 직접 조정하는 대신 현재와 이전 위치를 사용하여 간접적으로 속도를 업데이트하는 방식을 채택했습니다. 이 방법은 주로 거리 제약 조건에 초점을 맞추었지만, 보다 일반적인 제약 조건을 다루는 방법에 대해서는 구체적이지 않았습니다.

Desbrun과 Provot는 매스 스프링 시스템에서 스프링의 과도한 스트레칭을 방지하기 위해 제약 조건 프로젝션을 사용했으나, 이는 전체적인 위치 기반 접근법의 기초로 사용되기보다는 보정 과정으로만 사용되었습니다. 반면에 Müller et al.은 객체를 특정 목표 위치로 이동시키는 방식으로 변형 가능한 객체를 시뮬레이션했는데, 이 방법은 이 논문에서 제안하는 접근법과 가장 유사합니다. 그들은 특별한 전역 제약 조건만을 다루었기 때문에 위치 해결사가 필요하지 않았습니다.

이 챕터는 위치 기반 동역학이 이미 여러 연구에서 조각적으로 나타났음을 보여주지만, 아직 이를 체계적으로 다루고 전체적인 프레임워크를 제공하는 연구는 많지 않음을 강조합니다. 따라서, 이 논문은 일반적인 제약 조건을 처리할 수 있는 전반적인 위치 기반 시뮬레이션 접근법을 제안함으로써, 이 분야에 기여하고자 합니다.

### 3. Position Based Simulation

위치 기반 시뮬레이션(Position Based Simulation, PBD)은 컴퓨터 그래픽스에서 동적 객체의 움직임을 시뮬레이션하는 혁신적인 방법입니다. 이 접근 방식의 핵심은 힘을 기반으로 한 전통적인 방법 대신 객체의 위치를 직접 조정하여 움직임을 시뮬레이션하는 것입니다. 이로 인해 사용자는 객체의 위치를 더 직접적으로 제어할 수 있으며, 시뮬레이션 과정에서 발생할 수 있는 불안정성 문제를 크게 줄일 수 있습니다.

**알고리즘 개요**

PBD 알고리즘은 다음과 같은 주요 단계로 구성됩니다:

1. **초기화**: 모든 정점의 위치, 속도, 질량의 역수(가벼운 물체일수록 더 큰 값)를 초기화합니다.
2. **시뮬레이션 루프**:
    - **외부 힘 적용**: 각 정점에 대해 외부 힘(예: 중력)을 속도에 적용합니다.
    - **속도 감쇠**: 속도를 감쇠시켜 물리적 현상을 더 잘 모방합니다.
    - **위치 예측**: 현재 속도를 기반으로 각 정점의 새 위치를 예측합니다.
    - **충돌 제약 생성**: 예측된 위치에 기반하여 충돌을 감지하고, 이에 대한 제약 조건을 생성합니다.
    - **제약 조건 해결**: 모든 제약 조건을 만족하도록 정점의 위치를 조정합니다. 이 과정은 여러 번 반복될 수 있습니다.
    - **위치 및 속도 업데이트**: 제약 조건에 따라 조정된 위치로 정점을 이동시키고, 이를 통해 속도를 업데이트합니다.

**제약 조건의 역할**

PBD에서 제약 조건은 시뮬레이션의 정확성과 현실성을 보장하는 데 중요한 역할을 합니다. 이러한 제약 조건에는 다양한 종류가 있으며, 각각은 특정한 물리적 제한을 나타냅니다. 예를 들어, 거리 제약 조건은 두 점 사이의 거리를 일정하게 유지시키며, 벤딩 제약 조건은 옷감이나 밧줄 같은 객체가 너무 많이 구부러지지 않도록 합니다. 제약 조건은 동등성(equality) 제약과 부등성(inequality) 제약으로 구분될 수 있으며, 각각은 제약이 정확히 만족되어야 하는 경우와 어느 정도의 유연성이 허용되는 경우를 나타냅니다.

![제약 조건 C(p1,p2) = |p1 − p2| − d의 투영. 수정 사항 ∆pi는 역 질량 wi = 1/mi에 따라 가중됩니다.](Position%20Based%20Dynamics%207ba41a0be0f8410696e9b05859b550c5/Untitled%201.png)

제약 조건 C(p1,p2) = |p1 − p2| − d의 투영. 수정 사항 ∆pi는 역 질량 wi = 1/mi에 따라 가중됩니다.

**장점**

PBD의 가장 큰 장점은 그 안정성과 직관성입니다. 사용자가 직접 객체의 위치를 조정할 수 있기 때문에, 예를 들어 게임 개발에서 캐릭터의 특정 부분을 직접 제어하거나 특정 상황에서 원하는 동작을 쉽게 구현할 수 있습니다. 또한, PBD는 전통적인 힘 기반 시뮬레이션에 비해 훨씬 더 안정적인 결과를 제공하며, 계산 과정에서 발생할 수 있는 에너지 증가나 오버슈팅 문제를 효과적으로 방지합니다.

![제안하는 구부림 항을 사용하면, 구부림과 스트레칭이 독립적인 매개변수가 됩니다. 상단 행은 (kstretching, kbending) = (1,1), (1/2,1) 및 (1/100,1)을 보여줍니다. 하단 행은 (kstretching, kbending) = (1,0), (1/2,0) 및 (1/100,0)을 보여줍니다.](Position%20Based%20Dynamics%207ba41a0be0f8410696e9b05859b550c5/Untitled%202.png)

제안하는 구부림 항을 사용하면, 구부림과 스트레칭이 독립적인 매개변수가 됩니다. 상단 행은 (kstretching, kbending) = (1,1), (1/2,1) 및 (1/100,1)을 보여줍니다. 하단 행은 (kstretching, kbending) = (1,0), (1/2,0) 및 (1/100,0)을 보여줍니다.

이러한 특징 덕분에 PBD는 옷감 시뮬레이션, 부드러운 몸체 시뮬레이션, 심지어 복잡한 충돌 해결 문제에 이르기까지 다양한 분야에서 널리 사용될 수 있습니다. 이 방법은 물리적 현상을 시각적으로 설득력 있게 모방하면서도 계산 비용을 절감할 수 있어, 실시간 응용 프로그램과 게임 개발에 매우 적합합니다.

### 4. Cloth Simulation

옷감 시뮬레이션은 컴퓨터 그래픽스에서 특히 중요한 주제입니다. 위치 기반 시뮬레이션 기법을 이용하면, 실시간으로 옷감의 움직임을 매우 현실적으로 재현할 수 있습니다. 이 방법은 게임과 영화에서 캐릭터의 옷이나 다른 직물류 객체를 더 생동감 있게 보이게 하는 데 사용됩니다.

![구부림 저항을 위해, 제약 함수 C(p1,p2,p3,p4) = arccos(n1 · n2) − ϕ0가 사용됩니다. 실제 이면각 ϕ는 두 삼각형의 법선 사이의 각도로 측정됩니다.](Position%20Based%20Dynamics%207ba41a0be0f8410696e9b05859b550c5/Untitled%203.png)

구부림 저항을 위해, 제약 함수 C(p1,p2,p3,p4) = arccos(n1 · n2) − ϕ0가 사용됩니다. 실제 이면각 ϕ는 두 삼각형의 법선 사이의 각도로 측정됩니다.

![제약 함수 C(q,p1,p2,p3) = (q − p1)· n − h는 q가 삼각형 p1,p2,p3 위로 옷감의 두께 h만큼 유지되도록 합니다.](Position%20Based%20Dynamics%207ba41a0be0f8410696e9b05859b550c5/Untitled%204.png)

제약 함수 C(q,p1,p2,p3) = (q − p1)· n − h는 q가 삼각형 p1,p2,p3 위로 옷감의 두께 h만큼 유지되도록 합니다.

**옷감의 표현**

옷감은 삼각형 메시(triangle mesh)로 표현됩니다. 각 정점(vertex)은 옷감의 한 점을 나타내며, 이들 사이의 연결(에지, edge)은 옷감의 구조적인 연결성을 나타냅니다. 사용자는 옷감의 질량을 면적 당 질량(예: kg/m²)으로 설정할 수 있으며, 이는 각 정점의 질량을 계산하는 데 사용됩니다.

**스트레칭과 벤딩 제약 조건**

옷감의 현실적인 움직임을 재현하기 위해, 두 가지 주요 제약 조건을 사용합니다:

1. **스트레칭 제약**: 이 제약은 옷감이 과도하게 늘어나거나 수축하는 것을 방지합니다. 각 에지에 대해 설정되며, 에지가 원래 길이에서 너무 멀리 떨어지지 않도록 합니다.
2. **벤딩 제약**: 이 제약은 옷감이 실제처럼 구부러지게 하며, 옷감의 주름이나 흐름을 현실적으로 만듭니다. 인접한 삼각형 쌍에 대해 설정되며, 삼각형 사이의 각도가 너무 크게 변하지 않도록 합니다.

**충돌 처리**

옷감 시뮬레이션에서 중요한 부분은 옷감이 다른 객체나 스스로와 충돌하는 것을 현실적으로 처리하는 것입니다. 위치 기반 시뮬레이션에서는 충돌을 감지하고 충돌에 대한 제약 조건을 생성하여, 옷감이 충돌하는 객체에 닿지 않도록 조정합니다. 이는 옷감이 캐릭터의 몸이나 다른 객체들 사이를 통과하지 않게 하여, 시뮬레이션의 현실성을 높입니다.

**자체 충돌과 옷감의 압력 모델링**

옷감 시뮬레이션에서는 옷감이 스스로와 충돌하지 않도록 관리하는 것도 중요합니다. 이를 위해 공간 해싱과 같은 기법을 사용하여 옷감의 다른 부분 사이의 충돌을 효율적으로 감지합니다. 또한, 옷감이 닫힌 메시인 경우 내부의 압력을 모델링하여, 예를 들어 풍선처럼 부풀어 오르게 할 수 있습니다. 이는 옷감의 볼륨을 유지하면서도 형태를 변화시키는 효과를 만듭니다.

**실시간 옷감 시뮬레이션**

위치 기반 동역학을 이용한 옷감 시뮬레이션의 가장 큰 장점 중 하나는 실시간으로 복잡한 옷감의 움직임을 처리할 수 있다는 것입니다. 게임이나 인터랙티브 애플리케이션에서 사용자의 행동에 따라 옷감이 자연스럽게 반응할 수 있습니다. 이를 통해 개발자와 아티스트는 캐릭터에게 생동감을 부여하고, 사용자에게 몰입감을 제공하는 시각적 효과를 만들어낼 수 있습니다.

### 5. Results

위치 기반 시뮬레이션 프레임워크를 사용하여 구현된 옷감 시뮬레이션 기술의 결과를 살펴보면, 이 기술이 실시간으로 복잡한 옷감의 움직임을 처리할 수 있음을 보여줍니다. 여러 실험을 통해 다음과 같은 결과를 관찰할 수 있었습니다:

**독립적인 스트레칭과 벤딩**

옷감의 스트레칭과 벤딩은 서로 독립적으로 조절할 수 있습니다. 이는 삼각형 메시의 인접한 삼각형 사이의 각도에 기반한 벤딩 제약 조건 덕분입니다. 이를 통해 개발자는 옷감이 얼마나 쉽게 늘어나고 구부러지는지를 정밀하게 조정할 수 있습니다. 실험 결과, 벤딩 저항력을 활성화하거나 비활성화해도 스트레칭 저항력에 영향을 주지 않음을 확인했습니다.

**충돌 처리와 자체 충돌**

옷감 시뮬레이션에서 충돌 처리는 매우 중요합니다. 개발된 시스템은 옷감이 캐릭터의 몸이나 다른 객체들과 충돌할 때 현실적으로 반응하도록 합니다. 또한, 옷감의 자체 충돌도 효과적으로 처리하여 옷감이 자연스럽게 움직이고 주름지는 모습을 잘 재현할 수 있었습니다.

![이 접힌 구성은 안정적인 자체 충돌 및 반응을 보여줍니다.](Position%20Based%20Dynamics%207ba41a0be0f8410696e9b05859b550c5/Untitled%205.png)

이 접힌 구성은 안정적인 자체 충돌 및 반응을 보여줍니다.

**실시간 성능**

실험은 PC Pentium 4, 3GHz에서 수행되었으며, 여러 시나리오에서 실시간으로 옷감 시뮬레이션을 수행할 수 있음을 보여주었습니다. 예를 들어, 1364개의 정점과 2562개의 삼각형으로 구성된 옷감 조각은 자체 충돌 검출, 충돌 처리, 렌더링을 포함하여 평균 30fps(프레임 당 초)로 시뮬레이션이 가능했습니다.

![캐릭터 내부의 과압력 시뮬레이션](Position%20Based%20Dynamics%207ba41a0be0f8410696e9b05859b550c5/Untitled%206.png)

캐릭터 내부의 과압력 시뮬레이션

**복잡한 시뮬레이션 시나리오**

시뮬레이션은 강체와의 상호작용, 옷감의 자체 충돌 및 응답 처리, 동적 강체에 옷감 조각을 부착하는 기능 등을 포함하여 다양한 복잡한 시나리오에서의 성능을 입증했습니다. 이러한 기능들은 옷감 시뮬레이션을 더욱 현실적이고 다양하게 만들어 줍니다.

![옷감 스트라이프는 상단의 정적 강체에 일방적 상호작용을 통해 부착되고, 하단의 강체에는 양방향 제약 조건을 통해 연결됩니다.](Position%20Based%20Dynamics%207ba41a0be0f8410696e9b05859b550c5/Untitled%207.png)

옷감 스트라이프는 상단의 정적 강체에 일방적 상호작용을 통해 부착되고, 하단의 강체에는 양방향 제약 조건을 통해 연결됩니다.

결과적으로, 위치 기반 시뮬레이션 프레임워크를 사용한 옷감 시뮬레이션 기술은 실시간으로 복잡한 옷감의 움직임을 처리할 수 있는 강력한 도구임을 증명했습니다. 이러한 기술은 게임 개발, 영화 제작, 가상 현실 응용 프로그램 등 다양한 분야에서 활용될 수 있습니다.

### 6. Conclusions

위치 기반 시뮬레이션 프레임워크를 통해 개발된 옷감 시뮬레이션 기술은 컴퓨터 그래픽스 분야에 새로운 가능성을 열어주었습니다. 이 기술은 일반적인 제약 함수를 사용하여 다양한 물리적 현상을 모델링할 수 있으며, 직접적인 위치 조정을 통해 높은 수준의 제어와 안정성을 제공합니다. 이로 인해 옷감과 같은 부드러운 객체의 동적인 움직임을 실시간으로, 그리고 매우 현실적으로 시뮬레이션할 수 있습니다. 이 연구의 성공은 옷감이 강체와 상호 작용하거나 자체 충돌을 처리하는 등의 복잡한 시나리오에서도 안정적인 성능을 유지할 수 있음을 보여줍니다. 결론적으로, 이 프레임워크는 객체의 직접적인 조작, 충돌 처리의 단순화, 명시적 통합 문제 해결 등, 컴퓨터 애니메이션과 시뮬레이션에 있어 핵심적인 이점들을 제공합니다.

### 7. Future Work

이 연구의 다음 단계는 위치 기반 시뮬레이션 프레임워크를 더욱 확장하여 강체 시뮬레이션에도 적용하는 것입니다. 현재의 프레임워크는 이미 다양한 유형의 부드러운 객체와 그들 간의 상호 작용을 효과적으로 처리할 수 있지만, 강체와 같은 더 단단한 객체를 포함시키는 것은 아직 탐색되지 않았습니다. 강체 시뮬레이션에 위치 기반 접근법을 적용하면, 충돌 해결 과정에서 선형 및 각운동량을 조정하여 움직임과 회전을 직접 적용할 수 있게 됩니다. 이는 기존의 강체 해결 방식을 대체하거나 보완할 수 있는 새로운 방법을 제시할 것입니다. 또한, 이 연구를 통해 개발된 기술들은 실시간 응용 프로그램과 게임 개발뿐만 아니라, 교육, 가상 현실, 그리고 실시간 시뮬레이션 필요성이 있는 다른 많은 분야에서도 유용하게 사용될 수 있을 것입니다. 이 프레임워크의 확장과 적용 가능성을 탐구하는 것은 앞으로의 연구에서 중요한 목표가 될 것입니다.