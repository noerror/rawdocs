# Large Steps in Inverse Rendering of Geometry

*새로운 프리컨디셔너 기술로 차별적인 렌더링에 혁신을 가져옵니다. 모호성을 해결하고 지오메트리 최적화를 개선하여 강력한 이미지 재구성을 위한 기반을 마련합니다. #AI #DifferentiableRendering #MachineLearning*

[https://www.youtube.com/watch?v=Y6ezNI0Idsc](https://www.youtube.com/watch?v=Y6ezNI0Idsc&)

[https://rgl.epfl.ch/publications/Nicolet2021Large](https://rgl.epfl.ch/publications/Nicolet2021Large)

이미지를 역으로 재구성하는 것은 많은 과학 및 엔지니어링 분야에서 핵심적인 문제입니다. 차별화 렌더링의 발전으로 수백만 개의 매개변수와 관련하여 전체 이미지 형성 프로세스를 효율적으로 차별화할 수 있게 되었습니다. 이는 그라데이션 기반 최적화를 통해 이러한 문제를 해결하는 데 도움이 됩니다.

![(a) 25개의 렌더링된 뷰를 사용하여 구형 시작 추측에서 네페르티티 흉상을 역으로 재구성한 모습(1 개 표시). (b) 미분 가능한 렌더러를 무심코 적용한 결과 렌더러를 무심코 적용하면 왜곡이나 자체 교차를 고려하지 않고 그라데이션 단계가 실루엣을 당길 때 사용할 수 없는 엉클어진 메시가 생성됩니다. (c) 정규화는 최적화가 메시 품질을 인식하도록 함으로써 이러한 문제를 완화할 수 있습니다. 반대로 지오메트리의 매끄럽지 않은 부분에 불이익을 주고 그라데이션 기반 옵티마이저에서 불만족스러운 수렴을 유발합니다. 최종 메시가 분명 더 좋아 보이지만 와이어프레임 렌더링을 자세히 살펴보면 다음과 같은 사실을 알 수 있습니다. 무수한 자기 교차점을 발견할 수 있습니다. (d) 우리의 방법은 두 가지 문제를 모두 해결하고 고품질 메시로 수렴합니다. (e) 아이소트로픽 리메싱 단계와 결합, 재구성은 레퍼런스의 미세한 디테일을 캡처합니다(f). 각 방법의 하이퍼 파라미터는 동일한 시간에 최상의 수렴을 얻기 위해 최적화되었습니다. 자체 교차점은 빨간색으로 표시되어 있습니다.](https://rgl.s3.eu-central-1.amazonaws.com/media/images/papers/Nicolet2021Large_teaser_1.jpg)

(a) 25개의 렌더링된 뷰를 사용하여 구형 시작 추측에서 네페르티티 흉상을 역으로 재구성한 모습(1 개 표시). (b) 미분 가능한 렌더러를 무심코 적용한 결과 렌더러를 무심코 적용하면 왜곡이나 자체 교차를 고려하지 않고 그라데이션 단계가 실루엣을 당길 때 사용할 수 없는 엉클어진 메시가 생성됩니다. (c) 정규화는 최적화가 메시 품질을 인식하도록 함으로써 이러한 문제를 완화할 수 있습니다. 반대로 지오메트리의 매끄럽지 않은 부분에 불이익을 주고 그라데이션 기반 옵티마이저에서 불만족스러운 수렴을 유발합니다. 최종 메시가 분명 더 좋아 보이지만 와이어프레임 렌더링을 자세히 살펴보면 다음과 같은 사실을 알 수 있습니다. 무수한 자기 교차점을 발견할 수 있습니다. (d) 우리의 방법은 두 가지 문제를 모두 해결하고 고품질 메시로 수렴합니다. (e) 아이소트로픽 리메싱 단계와 결합, 재구성은 레퍼런스의 미세한 디테일을 캡처합니다(f). 각 방법의 하이퍼 파라미터는 동일한 시간에 최상의 수렴을 얻기 위해 최적화되었습니다. 자체 교차점은 빨간색으로 표시되어 있습니다.

하지만 빠르게 차별화할 수 있다고 해서 반드시 역문제를 쉽게 해결할 수 있는 것은 아닙니다. 특히 메시 기반 표현은 잘못된 그라데이션 단계로 인해 메시의 일부가 엉망이 되어 메시가 뒤집어지거나 자기 교차점이 발생하거나 왜곡으로 인해 버텍스 예산이 오용되는 등의 문제를 일으킬 수 있습니다. 이러한 문제는 일반적으로 복구할 수 없으며 최적화 단계를 추가할수록 악화되는데, 이는 목적 함수의 상당한 비볼록성으로 인해 최적화 프로세스의 견고성이 부족하다는 것을 의미합니다.

일반적으로 이러한 견고성 문제는 라플라시안 에너지와 같은 정규화를 추가하여 현재 모델의 평활성을 개선함으로써 완화할 수 있습니다. 그러나 이는 이제 솔루션이 문제 해결과 평활성 사이에서 균형을 맞춰야 하기 때문에 자체적인 문제를 야기합니다. 또한 라플라시안 에너지를 포함하는 경사 단계는 선형 방정식을 풀 때 사용하는 느린 수렴 방법과 유사합니다.

- (참고: 정규화)
    
    역 렌더링은 관찰된 이미지에서 씬 파라미터(지오메트리, 머티리얼, 조명 등)를 복구하는 프로세스입니다. 역렌더링은 본질적으로 포지셔닝이 잘못되어 동일한 관찰 이미지를 생성하는 장면 구성이 여러 개 있을 수 있고, 이로 인해 모호성이 발생할 수 있기 때문에 어려운 문제입니다.
    
    정규화는 이러한 모호성을 처리하고 문제를 잘 배치하는 데 사용되는 기술입니다. 여기에는 솔루션에 대한 일종의 사전 지식이나 가정을 인코딩하는 최적화 목적 함수에 추가 항을 추가하는 것이 포함됩니다.
    
    역 렌더링의 맥락에서 정규화에는 더 간단하거나 부드러운 솔루션을 선호하는 제약 조건을 추가하는 것이 포함될 수 있습니다. 예를 들어, 표면 지오메트리나 머티리얼의 반사율 속성이 현실 세계에서 부드럽게 변화하는 경향이 있다고 가정하고 이러한 속성의 급격한 변화에 불이익을 주는 항을 목적 함수에 추가할 수 있습니다.
    
    이러한 정규화 항을 추가함으로써 솔루션을 보다 "그럴듯한" 또는 "가능성이 높은" 구성으로 편향시켜 문제를 명확히 하고 솔루션의 견고성을 개선하는 데 도움이 됩니다. 그러나 정규화 용어의 선택은 결과에 큰 영향을 미칠 수 있으며, 부적절한 선택으로 인해 솔루션이 잘못되거나 바람직하지 않은 방식으로 편향될 수 있다는 점에 유의해야 합니다.
    

이러한 문제를 해결하기 위해 저자는 사전 조건부 그라디언트 하강 프레임워크 내에서 차등 렌더링을 적용하는 실용적인 대안을 제안합니다. 이 방법은 최종 해가 매끄러울 필요 없이 그라디언트 단계를 매끄러운 해를 향해 편향시킵니다. 느리게 수렴하는 방법과 달리 각 그라데이션 단계가 모든 변수 간에 정보를 순환하므로 더 적은 수의 더 큰 단계로 더 빠르게 수렴할 수 있습니다.

이 방법은 메시에만 국한되지 않으며 일반적으로 부드러운 솔루션이 예상되는 다른 표현의 재구성 속도도 높일 수 있습니다. 저자는 기하학적 최적화와 텍스처 재구성에서 향상된 성능을 보여줍니다.

1 INTRODUCTION

디퍼렌셜 렌더링은 빛의 이동과 관련된 복잡한 역문제를 해결하는 데 사용되는 새로운 기술입니다. 이 기술은 전체 이미지 형성 프로세스를 통해 도함수를 계산하여 방대한 장면 파라미터 공간을 기반으로 사용자 정의 목적 함수를 최소화합니다. 이러한 도함수는 렌더링된 픽셀과 광원, 재질, 관찰된 물체의 모양 사이의 복잡한 관계를 나타냅니다. 그러나 이러한 도함수의 잠재력에도 불구하고 볼록하지 않은 목적함수의 그라데이션 기반 최적화는 품질이 낮은 솔루션으로 쉽게 이어질 수 있기 때문에 이러한 도함수를 사용할 수 있는 것이 궁극적인 해결책은 아닙니다.

메시 기반 기하학적 표현이 포함된 씬에서는 종종 문제가 발생합니다. 예를 들어, 큰 그라데이션 단계는 오브젝트를 왜곡하거나, 수많은 로컬 자체 교차점을 생성하거나, 주어진 버텍스 예산을 오용할 수 있습니다. 최적화가 렌더링 손실에만 의존하는 경우 이러한 문제를 해결하기가 거의 불가능하며, 그라데이션 스텝을 추가하면 이러한 문제가 악화될 가능성이 높습니다.

이러한 문제를 완화하는 일반적인 방법 중 하나는 라플라스 또는 바이 라플라스 평활도 에너지의 형태로 정규화를 적용하는 것입니다. 그러나 이는 새로운 과제를 야기합니다. 이제 솔루션은 원래의 목표를 달성하는 것과 평활성을 유지하는 것 사이에서 균형을 유지해야 합니다. 또한 이산 라플라시안 에너지를 최적화하기 위해 1차 기울기를 사용하면 수렴이 느려지는 경우가 많습니다.

저자는 더 강력하고 하이퍼파라미터 선택에 덜 민감하며 수렴을 가속화하는 라플라시안 정규화에 대한 대안을 제안합니다. 이 방법은 미분 렌더링을 소볼레프 사전 조건부 경사 하강 프레임워크에 캐스팅하거나 입력 지오메트리의 재파라미터화로 해석할 수 있으며, 최종 솔루션이 매끄러울 필요 없이 경사 단계를 매끄러운 솔루션으로 편향시킵니다. 다른 방법과 달리 이 접근법의 각 기울기 단계는 모든 변수 간에 정보를 순환시켜 더 빠른 수렴을 가능하게 합니다.

이 방법은 모든 반복에서 희소 선형 시스템을 풀어야 하므로 1차 및 차등 렌더링 단계에 비해 비용이 무시할 수 있을 정도로 저렴합니다. 적절한 이산 라플라스 연산자가 있는 모든 도메인에 적용할 수 있습니다. 저자는 지오메트리 최적화 및 텍스처 재구성의 맥락에서 그 성능을 평가합니다. 이 방법은 Baraff와 Witkin의 영향력 있는 논문에서 영감을 얻은 것으로, 확산 과정의 암시적 시간 단계로 볼 수도 있습니다.

2 BACKGROUND AND RELATED WORK

이 논문에서는 이미지에서 장면 및 객체를 재구성하는 데 있어 차등 렌더링의 다양한 측면과 그 응용에 대해 논의합니다. 차등 렌더링은 신경망 내의 렌더링 단계에서 잠재적인 장면 표현을 이미지로 전환하는 프로세스입니다. 이 프로세스에는 1차 최적화가 필요한 고차원 파라미터가 포함되므로 명시적 차별화를 포함하는 렌더링 방법에 대한 관심이 높아졌습니다. 이 논문에서는 래스터화 기반 방식과 물리 기반 방식이라는 두 가지 차별화 렌더링 알고리즘의 범주를 인정합니다.

래스터화 기반 방식은 Loper 등의 연구에서 시작된 것으로, 1차 가시성과 로컬 음영을 설명하지만 그림자나 상호 반사 같은 간접 효과는 지원하지 않습니다. 반면 물리 기반 방법은 물리 기반 조명 시뮬레이션을 도출합니다. 이 방법은 가역적인 계산 단계와 함께 빛의 물리적 상호성을 사용하지만 가시성으로 인한 불연속성에 대한 문제에 직면합니다.

이 논문에서는 전역 조명의 역할이 적은 형상 재구성에 초점을 맞추기 때문에 실험에 Laine 등의 차등 래스터라이저가 사용됩니다.

또 다른 핵심 사항은 현대 기하학 처리의 기본 도구인 라플라스 연산자입니다. 라플라스 연산자는 열 확산, 정전기 전위, 비압축성 유체 흐름과 같은 다양한 물리적 문제에 사용됩니다. 라플라스 연산자는 주파수 의존 감쇠에 도움이 되며, 이는 논의되는 방법의 중요한 부분입니다.

이산 라플라시안 개념은 다각형 메시의 맥락에서 소개합니다. 다양한 라플라스 연산자를 선택하여 약간 다른 특성을 얻을 수 있습니다. 또한 이 논문에서는 역 렌더링의 방법으로 소볼레프 사전 조건부 경사 하강을 소개합니다. 마지막으로 이 논문에서는 이 방법을 외력 및 고유 평활도 에너지에 따라 변형 가능한 메시를 최적화하는 능동 표면 모델에 연결합니다.

요약하자면, 이 논문에서는 이미지에서 도형과 장면을 재구성할 때 미분 렌더링, 라플라시안 연산자, 그라데이션 하강을 사용하는 방법을 살펴보고 있습니다.

3 METHOD

제안된 연구의 목적은 차등 렌더링을 사용하여 메시 최적화 문제에서 큰 단계를 수행하는 방법을 개발하는 것입니다. 메쉬 최적화는 렌더러가 생성한 이미지의 정확도를 측정하는 함수를 최소화하는 것을 포함합니다. 이 최적화 문제를 해결하기 위해 종종 경사 하강 알고리즘이 사용되는데, 이 알고리즘은 메시의 정점 위치를 조정하여 생성된 이미지와 대상 이미지 간의 차이를 최소화하는 것입니다.

![차등 렌더링에서 발생하는 기하학적 그라데이션: (a) 버텍스 위치를 교란하면 표면 법선이 회전하여 셰이딩 계산에 영향을 줍니다. 결과 셰이딩 그라데이션은 비교적 부드럽고 크기가 작습니다. (b) 실루엣 그라데이션은 한 셰이프가 다른 셰이프를 부분적으로 가릴 때 발생합니다. 이 경우 정점 위치의 작은 섭동이 실루엣을 움직여 픽셀의 강도에 갑작스러운 변화를 일으킬 수 있습니다. 이러한 그라데이션은 드문드문 나타나며 크기가 매우 클 수 있습니다.](Large%20Steps%20in%20Inverse%20Rendering%20of%20Geometry%202334c74aa8af48ad905b31c752419d88/Untitled.png)

차등 렌더링에서 발생하는 기하학적 그라데이션: (a) 버텍스 위치를 교란하면 표면 법선이 회전하여 셰이딩 계산에 영향을 줍니다. 결과 셰이딩 그라데이션은 비교적 부드럽고 크기가 작습니다. (b) 실루엣 그라데이션은 한 셰이프가 다른 셰이프를 부분적으로 가릴 때 발생합니다. 이 경우 정점 위치의 작은 섭동이 실루엣을 움직여 픽셀의 강도에 갑작스러운 변화를 일으킬 수 있습니다. 이러한 그라데이션은 드문드문 나타나며 크기가 매우 클 수 있습니다.

그러나 기존의 그라데이션 하강은 큰 스텝과 실루엣 불일치로 인해 메시가 왜곡될 수 있습니다. 이를 처리하는 일반적인 방법은 원래 최적화 문제에 라플라시안 정규화 항을 추가하는 것입니다. 이 방법을 사용하면 큰 스텝을 더 쉽게 관리할 수 있지만 여전히 메시 왜곡으로 인해 어려움을 겪습니다.

또 다른 접근 방식은 뉴턴의 방법과 같은 2차 최적화 방법을 사용하는 것인데, 이는 이차 함수를 다룰 때 좋은 성능을 발휘할 수 있습니다. 그러나 이 접근 방식은 계산 비용이 많이 들고 복잡한 렌더링 조건을 처리할 수 없습니다.

제안된 솔루션은 그라데이션 하강 방법을 수정하여 아이덴티티 행렬과 메시 라플라스카이안의 볼록한 조합을 그라데이션의 전제 조건으로 사용하는 것입니다. 이렇게 하면 잠재적으로 희박하고 집중될 수 있는 그라데이션 업데이트를 전체 도메인에 분산시켜 메시 왜곡을 줄일 수 있습니다. 이 방법은 소볼레프 또는 역 라플라시안 전제 조건의 일종으로 볼 수 있습니다.

수정된 경사 하강 방법은 원시 및 라플라시안 정규화된 경사 하강 방법보다 결과가 크게 개선되어 최적화 프로세스에서 큰 단계의 필요성과 메시 왜곡을 방지해야 하는 요구 사항의 균형을 맞추는 것으로 나타났습니다.

![특히 입력 모양이 너무 거칠거나 메시 토폴로지가 부적합해 왜곡을 유발하는 경우 왜곡을 유발할 수 있습니다. 이 그림은 아이코사면체에서 시작하여 스탠포드 용을 복원하는 극단적인 경우를 보여줍니다. 중간 삽입은 리메싱 단계 이후의 모양을 모양을 시각화합니다.](Large%20Steps%20in%20Inverse%20Rendering%20of%20Geometry%202334c74aa8af48ad905b31c752419d88/Untitled%201.png)

특히 입력 모양이 너무 거칠거나 메시 토폴로지가 부적합해 왜곡을 유발하는 경우 왜곡을 유발할 수 있습니다. 이 그림은 아이코사면체에서 시작하여 스탠포드 용을 복원하는 극단적인 경우를 보여줍니다. 중간 삽입은 리메싱 단계 이후의 모양을 모양을 시각화합니다.

이는 메시 포지셔닝의 결과를 개선하기 위해 모멘텀 항과 함께 경사 하강 변형을 사용하는 다소 기술적인 설명입니다. 여기에서는 좀 더 접근하기 쉬운 용어로 요약하려고 합니다:

이 섹션에서는 모멘텀 항을 통합하여 경사 하강 알고리즘의 성능을 향상시켜 결과를 개선하는 방법에 대해 설명합니다. 기존의 모멘텀 변형은 메시 위치를 제어하는 매개변수 "u"에 적용되는 특정 업데이트 규칙으로 구성됩니다.

널리 사용되는 옵티마이저 중 하나인 Adam은 2차 모멘트에 기반한 구성 요소별 사전 조건화 체계를 도입하여 이를 확장합니다. 그러나 저자는 이 전제 조건의 공격적인 단계가 결과의 부드러움을 방해할 수 있음을 관찰했습니다. 따라서 저자들은 보다 균일한 적응을 제안하며, 이를 UniformAdam이라고 부릅니다.

이 논문에서는 6가지 그라디언트 기반 최적화 방법을 비교하여 컴포넌트별 분할로 인한 "x" 최적화와 "u" 최적화 간의 차이점을 강조합니다. 결과는 파라메트릭 표현 "u"의 최적화를 기반으로 합니다.

또한 저자는 보쉬와 코벨트의 기법을 사용하여 최적화 중에 한 번 또는 주기적으로 적용되는 리메싱 단계와 이 방법을 결합하는 방법에 대해 설명합니다. 여기에는 현재 평균값의 절반에 해당하는 목표 에지 길이로 형상을 등방성 리메시징하는 작업이 포함됩니다.

![최적화 중 리메싱의 효과입니다. (a) 정규화된 10K 버텍스에서 시작하는 까다로운 두개골의 재구성 아이코스피어는 매우 왜곡된 메시를 생성합니다. (b) 우리의 방법은 이를 개선하여 이를 개선하고, (c) 당연히 디테일을 더욱 향상시킬 수 있습니다. 버텍스 예산이 ∼ 35K 버텍스로 증가하여 디테일을 더욱 향상시킬 수 있지만, 이 또한 아티팩트가 발생합니다, 예를 들어, 광대 아치 위의 누락된 구멍이 있습니다. (d) 원래 해상도에서 최적화하여 최상의 결과를 얻으려면 절반의 시간 동안 원래 해상도로 최적화하고, 다시 메쉬링하여 을 다시 실행하여 정점 수를 3.5배로 늘린 다음 최적화를 계속하면 최상의 결과를 얻을 수 있습니다. 이렇게 하면 임시 솔루션에 대한 메시 연결을 조정하여 보다 안정적인 훨씬 더 균일한 결과로 수렴할 수 있습니다. 메시가 여전히 위상학적으로 구입니다. 재구성은 자동으로 두 개의 부분적인 '뼈'를 자동으로 돌출하여 아치를 생성합니다.](Large%20Steps%20in%20Inverse%20Rendering%20of%20Geometry%202334c74aa8af48ad905b31c752419d88/Untitled%202.png)

최적화 중 리메싱의 효과입니다. (a) 정규화된 10K 버텍스에서 시작하는 까다로운 두개골의 재구성 아이코스피어는 매우 왜곡된 메시를 생성합니다. (b) 우리의 방법은 이를 개선하여 이를 개선하고, (c) 당연히 디테일을 더욱 향상시킬 수 있습니다. 버텍스 예산이 ∼ 35K 버텍스로 증가하여 디테일을 더욱 향상시킬 수 있지만, 이 또한 아티팩트가 발생합니다, 예를 들어, 광대 아치 위의 누락된 구멍이 있습니다. (d) 원래 해상도에서 최적화하여 최상의 결과를 얻으려면 절반의 시간 동안 원래 해상도로 최적화하고, 다시 메쉬링하여 을 다시 실행하여 정점 수를 3.5배로 늘린 다음 최적화를 계속하면 최상의 결과를 얻을 수 있습니다. 이렇게 하면 임시 솔루션에 대한 메시 연결을 조정하여 보다 안정적인 훨씬 더 균일한 결과로 수렴할 수 있습니다. 메시가 여전히 위상학적으로 구입니다. 재구성은 자동으로 두 개의 부분적인 '뼈'를 자동으로 돌출하여 아치를 생성합니다.

마지막으로 메시 연결성을 기반으로 희소 선형 시스템을 풀어야 하는 수치 해법에 대해 논의합니다. 이들은 공액 경사법과 희소 콜레스키 인수분해에 기반한 직접 솔버라는 두 가지 접근법을 실험했습니다. 실험 결과 후자가 더 빠른 것으로 판명되었지만, 특정 경우에는 전자의 잠재적인 이점을 발견할 수 있었습니다.

![큰 그라디언트 단계는 더 큰 기준 구에 대한 구의 단일 뷰 최적화에서 상당한 불균일성을 초래할 수 있습니다. 우리의 방법(맨 윗줄)은 수백 번의 반복으로 고품질의 솔루션으로 수렴하는 반면, 정규화는 정규화 파라미터 𝜆의 강도에 따라 불만족스러운 왜곡을 가진 메시를 생성합니다. 왜곡이 있는 메시를 생성합니다. 부드러움을 우선시하는 경우 솔루션은 결국 최대한 부드러운 모양으로 수렴합니다. 많이. 개별 손실 조건의 플롯을 보면 정규화를 희생하면서 이미지 손실이 먼저 최적화되고, 이후 이미지 손실이 최소에 도달하면 따라잡습니다. 이 방법은 두 가지 상충되는 목표 사이에서 이러한 절충을 요구하지 않습니다.](Large%20Steps%20in%20Inverse%20Rendering%20of%20Geometry%202334c74aa8af48ad905b31c752419d88/Untitled%203.png)

큰 그라디언트 단계는 더 큰 기준 구에 대한 구의 단일 뷰 최적화에서 상당한 불균일성을 초래할 수 있습니다. 우리의 방법(맨 윗줄)은 수백 번의 반복으로 고품질의 솔루션으로 수렴하는 반면, 정규화는 정규화 파라미터 𝜆의 강도에 따라 불만족스러운 왜곡을 가진 메시를 생성합니다. 왜곡이 있는 메시를 생성합니다. 부드러움을 우선시하는 경우 솔루션은 결국 최대한 부드러운 모양으로 수렴합니다. 많이. 개별 손실 조건의 플롯을 보면 정규화를 희생하면서 이미지 손실이 먼저 최적화되고, 이후 이미지 손실이 최소에 도달하면 따라잡습니다. 이 방법은 두 가지 상충되는 목표 사이에서 이러한 절충을 요구하지 않습니다.

이러한 개념에 익숙하지 않은 분들에게는 이 설명이 여전히 복잡할 수 있다는 점을 기억하세요. 보다 자세한 이해를 위해서는 최적화, 선형 대수학, 컴퓨터 그래픽에 대한 배경 지식이 필요할 수 있습니다.

4 RESULTS

이 요약은 다양한 관점에서 관찰한 셰이딩과 실루엣 그라데이션을 모두 사용하여 3D 메시를 최적화하는 방법을 제시하는 연구에 관한 것입니다. 저자는 다양한 테스트를 통해 이 방법을 시연하고 다른 기법과 비교합니다. 핵심 사항은 다음과 같습니다:

- 큰 타임스텝: 저자들은 구의 3D 메시를 더 큰 기준 구 이미지와 일치하도록 최적화하는 방법을 탐구했습니다. 이 방법을 사용하여 수백 번의 반복만으로 수렴을 달성할 수 있었습니다. 정규화 계수인 λ를 변경하여 최종 결과에 미치는 영향을 관찰했습니다. 정규화를 너무 많이 하면 최적화 목표를 무시하고 부드러움만 지나치게 강조하게 됩니다.
- 메시 재구성: 원하는 출력 토폴로지에 맞춰 다양한 초기화 상태로 6개의 메시를 재구성했습니다. 저자의 방법은 고품질 메시로 안정적으로 수렴한 반면, 정규화의 효과는 미묘한 차이가 있고 문제에 따라 달라졌습니다.
- 뷰포인트의 영향: 사용 가능한 시점의 수가 증가함에 따라 재구성 품질이 향상되었습니다. 그러나 많은 수의 시점에서도 기준 재구성에서 불안정성이 관찰되었습니다.
- λ 파라미터 튜닝: 이 방법은 확산 프로세스의 암시적 타임스텝을 제어하는 조정 가능한 λ 파라미터를 사용합니다. 값이 너무 크거나 무한대이면 고주파가 약화되어 미세한 디테일을 재구성하는 데 방해가 될 수 있습니다.
- 텍스처 재구성: 이 방법은 일반적으로 작은 무작위 텍스셀 하위 집합만 관찰하는 고해상도 텍스처와 관련된 설정에서도 테스트되었습니다. 이 방법은 텍스처에 도달하기 전에 미세한 규모의 노이즈를 감쇠시키고 수렴을 가속화하며 더 유용한 솔루션을 생성하는 데 성공했습니다.
- 구현: 저자들은 TITAN RTX 그래픽 카드가 장착된 Linux Ryzen 워크스테이션을 사용하여 파이프라인을 구현했습니다. nvdiffrast, 구형 하모닉스 셰이딩 모델, PyTorch와 같은 기존 소프트웨어와 툴을 활용했습니다.
- 성능: 스파스 콜레스키 인수분해를 사용한 프리컨디셔닝 비용은 원시 및 인접 렌더링 단계에 소요된 시간에 비해 무시할 수 있을 정도로 적었습니다. 선형 시스템의 반복적 솔루션은 가능했지만 반복당 비용이 상당히 높았습니다.

5 CONCLUSION

디퍼런셜 렌더링은 이미지에서 이해를 도출하여 여러 분야의 복잡한 역문제를 해결할 수 있는 강력한 도구입니다. 하지만 볼록하지 않은 목표와 사소하지 않은 매개변수의 반전이라는 모호함으로 인해 프로세스가 까다로울 수 있습니다. 이러한 문제로 인해 그라디언트 기반 최적화가 실패하거나 불만족스러운 솔루션을 생성하는 경우가 많습니다.

프로세스를 보다 실용적으로 만들려면 솔루션의 예상 특성에 대한 지식을 주입해야 합니다. 기존의 접근 방식은 정규화를 사용했는데, 이는 원래 문제를 해결하는 데 필연적으로 트레이드오프가 수반됩니다.

이 연구에서 설명하는 방법은 강력한 지오메트리 최적화를 향한 중요한 진전을 나타냅니다. 이 방법은 전제 조건을 사용하여 씬의 가시성 미분으로 인해 발생하는 문제를 완화합니다. 이 방법은 계산 비용이 저렴하고 구현하기 쉬우며 동일한 시간 프레임에서 재구성 품질을 크게 향상시킵니다. 하지만 여전히 왜곡과 자기 교차가 발생할 수 있고 구멍을 만들거나 겹치는 지오메트리를 병합하여 토폴로지를 변경할 수 없기 때문에 결함이 없는 것은 아닙니다.

또한 연구진은 전체 1차 최적화 내에서 견고성을 향상시키기 위해 문제의 하위 집합에 2차 접근 방식을 사용하는 것의 가치를 강조합니다. 실제 애플리케이션에서 차별적인 렌더링을 구현하려면 카메라 포즈, 지오메트리, 텍스처 등 다양한 파라미터를 동시에 최적화해야 하는 경우가 많습니다. 이로 인해 자유도가 긴밀하게 얽혀 있어 1차 하강이 복잡한 최적화 환경을 탐색하기 어렵고 작은 단계가 필요합니다.

2차 최적화의 부분적인 사용을 다른 파라미터 조합으로 확장하는 것은 향후 유망한 연구 방향이 될 수 있습니다.

- 요약
    
    차별화 렌더링: 알고리즘을 사용하여 이미지를 생성하지만 차별화할 수 있는 방식으로 이미지를 생성하는 강력한 도구입니다. 즉, 입력 매개변수(예: 장면에서 물체의 위치나 색상)의 작은 변화가 출력 이미지에 어떤 영향을 미치는지 이해할 수 있습니다. 특히 주어진 이미지에서 장면이나 물체를 이해해야 하는 복잡한 역문제에 유용합니다.
    
    문제: 디퍼런셜 렌더링은 사소하지 않은 파라미터(예: 물체의 모양이나 광원의 위치)를 반전시키는 복잡성과 모호함으로 인해 어려울 수 있습니다. 이로 인해 그라데이션 기반 최적화에 실패하거나 비현실적인 솔루션을 생성하는 등의 문제가 발생합니다.
    
    지식 주입의 필요성: 차별화 렌더링을 보다 실용적으로 구현하려면 솔루션의 예상 특성에 대한 지식을 입력하는 것이 필수적입니다. 이는 전통적으로 정규화라는 프로세스를 통해 수행할 수 있습니다.
    
    정규화: 정규화는 모델의 과적합 또는 과소적합을 방지하는 데 사용되는 방법입니다. 차별적 렌더링의 맥락에서 정규화는 모델에 약간의 지식을 주입하여 모델을 보다 실용적으로 만들지만, 이는 종종 원래 문제의 일부분을 타협하는 것을 의미합니다.
    
    제안된 방법: 연구진은 강력한 지오메트리 최적화를 향한 중요한 진전을 보여주는 방법을 제안합니다. 이 방법은 전제 조건을 사용하여 씬의 가시성 미분으로 인해 발생하는 문제를 처리하여 재구성 품질을 개선합니다.
    
    제안된 방법의 장점과 한계: 이 방법은 구현하기 쉽고, 계산 비용이 저렴하며, 향상된 재구성을 제공하지만 결함이 없는 것은 아닙니다. 왜곡과 자기 교차가 발생할 수 있으며 토폴로지를 변경할 수 없습니다.
    
    2차 최적화의 부분적 사용: 연구진은 또한 전체 1차 최적화 프로세스 내에서 2차 접근 방식을 사용할 경우 얻을 수 있는 잠재적 이점을 강조합니다. 이를 통해 모델의 견고성을 높이고 복잡한 최적화 환경에서의 탐색을 개선할 수 있습니다.
    
    향후 연구 방향: 2차 최적화의 부분적인 사용을 다른 파라미터 조합으로 일반화하면 차별적인 렌더링을 더욱 개선할 수 있습니다. 이는 프로세스를 더욱 효과적이고 효율적으로 만들 수 있는 유망한 향후 연구 방향입니다.
    
- 디퍼런셜 렌더링
    
    물론 여기에는 차별화 렌더링의 간단한 단계별 프로세스가 나와 있습니다:
    
    렌더링 함수를 만듭니다: 3D 장면 매개변수(예: 오브젝트 모양, 재질, 조명, 카메라 속성)를 가져와 2D 이미지를 생성하는 과정을 시뮬레이션하는 함수입니다. 여기에는 3D 지오메트리를 2D 픽셀 그리드로 변환하는 래스터화 또는 씬을 통과하는 광선의 경로를 시뮬레이션하는 광선 추적과 같은 기술이 포함될 수 있습니다.
    
    입력을 정의합니다: 렌더링 함수에 대한 입력은 최적화하려는 파라미터입니다. 오브젝트의 모양부터 조명의 위치, 카메라의 시점에 이르기까지 장면의 모든 측면이 입력될 수 있습니다. 이러한 파라미터는 일반적으로 배열 또는 텐서(Tensor)로 표현됩니다.
    
    렌더링 함수를 실행합니다: 렌더링 함수를 입력 파라미터에 적용하여 2D 이미지를 생성합니다. 결과는 동일한 장면 매개변수가 주어졌을 때 실제 카메라가 캡처할 수 있는 시뮬레이션입니다.
    
    손실 계산: 손실은 렌더링된 이미지가 특정 대상에서 얼마나 멀리 떨어져 있는지를 측정하는 값입니다. 타겟은 일치시키려는 실제 사진일 수도 있고 다른 모델에서 생성한 이미지일 수도 있습니다. 손실 함수의 정확한 형태는 작업에 따라 다르지만 일반적으로 렌더링된 이미지와 대상 이미지 사이의 차이(예: 평균 제곱 오차)입니다.
    
    그라디언트를 계산합니다: 자동 미분을 사용하여 입력 파라미터에 대한 손실의 기울기를 계산합니다. 이 그라데이션은 입력 파라미터와 동일한 모양의 텐서이며, 그라데이션의 각 요소는 해당 입력 파라미터의 작은 변화가 손실에 얼마나 영향을 미치는지를 나타냅니다.
    
    파라미터를 업데이트합니다: 음의 그라데이션 방향으로 입력 파라미터를 조정합니다. 이는 그라데이션 하강 또는 그 변형과 같은 최적화 알고리즘을 사용하여 수행됩니다. 아이디어는 손실을 줄일 수 있는 매개변수를 조금씩 조정하는 것입니다.
    
    반복: 업데이트된 파라미터를 사용하여 3단계로 돌아갑니다. 렌더링, 손실 계산, 그라데이션 계산, 파라미터 업데이트 과정을 반복하여 손실이 충분히 낮아지거나 추가 반복을 해도 크게 개선되지 않을 때까지 반복합니다.
    
    이 프로세스를 통해 최적화 또는 머신 러닝 기술을 사용하여 원하는 출력 이미지를 생성하는 장면 매개변수를 찾을 수 있습니다. 3D 재구성, 이미지 기반 렌더링, 3D 데이터와 관련된 작업에 대한 신경망 훈련과 같은 작업을 위한 강력한 도구입니다.