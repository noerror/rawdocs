# HAAR: Text-Conditioned Generative Model of 3D Strand-based Human Hairstyles

[https://arxiv.org/abs/2312.11666](https://arxiv.org/abs/2312.11666)

- Dec 2023

### 1. Introduction

![텍스트 설명이 주어지면 우리의 방법은 사실적인 사람의 헤어스타일을 생성합니다. 3D 스트랜드 기반 지오메트리 표현을 사용하기 때문에 시뮬레이션 및 렌더링을 위해 기존 컴퓨터 그래픽 파이프라인에 쉽게 통합할 수 있습니다[3, 7, 9].](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled.png)

텍스트 설명이 주어지면 우리의 방법은 사실적인 사람의 헤어스타일을 생성합니다. 3D 스트랜드 기반 지오메트리 표현을 사용하기 때문에 시뮬레이션 및 렌더링을 위해 기존 컴퓨터 그래픽 파이프라인에 쉽게 통합할 수 있습니다[3, 7, 9].

3D 아바타의 급속한 발전과 헤어의 과제

최근 몇 년 동안 이미지, 동영상, 심지어 텍스트와 같은 다양한 입력을 통해 실제와 같은 3D 얼굴 및 머리 아바타를 만드는 데 상당한 진전이 있었습니다. 하지만 이 분야에서 가장 중요한 부분 중 하나는 사실적인 헤어 렌더링입니다. 기존 방식은 거친 메시 지오메트리 또는 암시적 표면을 사용했기 때문에 대부분의 렌더링 시스템에서 사용되는 스트랜드 기반 모델과 원활하게 통합되지 못했습니다. 이러한 차이는 애니메이션 아바타에서 자연스러운 헤어 다이내믹을 구현하는 데 큰 장애물이 되었으며, 3D 헤어의 사실적인 생성은 완전히 사실적이고 개인화된 아바타를 제작하는 데 큰 걸림돌로 작용했습니다.

HAAR: 텍스트 설명을 통한 헤어 생성의 혁신

이러한 문제를 극복하기 위해 HAAR(Hair: Automatic Animatable Reconstruction)이라는 새로운 솔루션이 개발되었습니다. HAAR는 텍스트 설명으로 구동되는 최초의 생성 모델로, 고전적인 스트랜드 기반 헤어 표현을 생성하는 것이 특징입니다. 이러한 표현은 기존 렌더링 시스템과 완벽하게 호환되어 사실적인 애니메이션을 지원합니다. HAAR의 혁신은 3D 헤어를 수동으로 생성하는 복잡하고 노동 집약적인 프로세스를 사용자 친화적인 채팅형 인터페이스로 대체하여 초보자도 고품질의 3D 헤어 에셋을 효율적으로 생성할 수 있도록 지원합니다.

이전 시도와 그 한계

이전에는 제너레이티브 모델을 사용하여 이미지, 비디오, 심지어 무작위 노이즈로부터 3D 스트랜드 기반 헤어를 생성했습니다. 대표적인 예로는 스마트폰 비디오 캡처를 사용하여 충실도가 높은 헤어스타일을 재구성한 Neural Haircut과 무조건적인 헤어 제너레이티브 모델인 GroomGen이 있습니다. 하지만 이러한 모델은 헤어 지오메트리에 대한 제어가 부족하고 적용 범위가 제한적이었습니다. 반면 HAAR은 텍스트 조건부 제너레이티브 모델로서 광범위한 제어 기능을 제공하고 다양한 헤어 에셋을 빠르게 생성할 수 있는 선구적인 모델입니다.

텍스트 조건부 제너레이티브 모델의 역할

스테이블 디퓨전으로 대표되는 텍스트 조건부 생성 모델은 이미지 및 비디오 생성에 광범위하게 활용되고 있습니다. TECA를 비롯한 이러한 모델은 신경 방사장을 사용하여 텍스트로부터 머리카락을 생성할 수 있는 잠재력을 입증했습니다. 그러나 이러한 모델은 주로 3D 형상의 외부 표면만 캡처하는 데 한계가 있고 의미 있는 내부 구조가 부족하여 애니메이션 용도로는 적합하지 않았습니다.

HAAR 접근 방식: 상세한 인사이트

HAAR은 잠재 확산 모델을 사용하는 텍스트 가이드 생성 방식을 도입했습니다. 이 모델은 3D 헤드 모델의 두피에 있는 헤어스타일을 텍스처 맵으로 표현하며, 각 텍스처 맵 값은 3D 헤어 스트랜드의 잠재적 표현에 해당합니다. 이 프로세스에는 개별 잠재 가닥을 샘플링하고 해당 3D 헤어 스트랜드를 재구성하는 등 여러 단계가 포함됩니다. HAAR의 방법론은 3D 헤어스타일에 대한 포괄적인 데이터 세트의 필요성, 헤어스타일과 텍스트 설명의 정렬, 생성된 헤어를 텍스트에 맞게 조정하는 등의 몇 가지 주요 문제를 해결합니다.

HAAR을 위한 데이터 수집 및 주석

HAAR을 훈련시키기 위해 다양한 소스에서 약 10,000개의 3D 헤어스타일로 구성된 방대한 데이터 세트를 수집했습니다. 대규모 시각 언어 모델(VLM)을 사용하여 정확한 헤어스타일 설명을 생성하기 위해 새로운 접근 방식이 사용되었습니다. 이는 미리 생성된 프롬프트를 시각적 질문-응답 시스템에 입력한 다음 응답을 일관된 텍스트 설명으로 통합하는 방식으로 이루어졌습니다.

실제 적용 및 발전

HAAR의 스트랜드 기반 표현은 기존 컴퓨터 그래픽 파이프라인과 원활하게 통합되어 머리카락을 사실적으로 밀도화하고 렌더링할 수 있습니다. 또한 이 모델은 가닥 수 업샘플링이나 텍스트 프롬프트를 사용한 헤어스타일 편집과 같은 다양한 의미론적 조작을 용이하게 합니다. TECA와 같은 다른 방식에 비해 HAAR는 몇 시간이 아닌 몇 초 만에 헤어스타일을 생성할 수 있어 훨씬 더 효율적입니다.

주요 기여 및 가용성

사실적인 3D 스트랜드 기반 헤어스타일 생성을 위한 선구적인 텍스트 조건부 확산 모델 도입, 헤어의 시맨틱 편집 방법 개발, VQA 시스템을 사용한 합성 헤어 에셋의 주석 자동화 등이 HAAR의 주요 공헌 사항입니다. HAAR 모델은 연구 목적으로도 사용할 수 있게 되어 3D 아바타 생성 분야에서 큰 진전을 이룰 것으로 기대됩니다.

### 2. Related work

텍스트-3D 변환 방법의 등장

3D 모델링 분야에서 최근의 발전은 텍스트 기반 이미지 생성의 성공에 크게 영향을 받았습니다. 텍스트-3D 접근법이라고 통칭되는 다양한 방법이 개발되었습니다. 이러한 접근 방식은 학습에 의한 합성 패러다임에 따라 3D 형상을 생성할 때 이미지 공간 안내를 사용한다는 점에서 특히 주목할 만합니다. 이러한 방법은 처음에는 이미지와 텍스트 사이의 공유 클립 임베딩에 의존하여 모델 출력이 텍스트 설명을 준수하도록 했습니다. 그러나 점수 증류 샘플링(SDS) 절차가 등장하면서 그 초점이 바뀌었습니다. 특히 안정적 확산과 같은 텍스트-이미지 생성 확산 모델과 함께 사용할 경우 SDS는 텍스트를 고품질 3D 에셋으로 변환하는 데 더욱 효과적인 수단을 제공합니다.

기존 방법의 한계와 SDS의 등장

TECA와 같은 SDS 기반 방법은 특히 신경 방사 필드(NeRF)로 볼륨 헤어스타일을 생성하는 데 있어 가능성을 보였지만, 상당한 한계가 있습니다. 이러한 방법은 주로 헤어의 외부 표면만 렌더링할 수 있으며 시뮬레이션 및 물리 기반 렌더링에 적용하는 데 필요한 내부 구조가 부족합니다. 또한 SDS 프로세스 자체가 느리고 텍스트 프롬프트에 정확하게 반응하기 위해 광범위한 최적화 시간이 필요한 경우가 많습니다. 반면, 이 백서에서 설명하는 것과 같은 새로운 접근 방식은 1분 이내에 텍스트로부터 헤어스타일을 생성하고 렌더링할 수 있어 효율성이 크게 향상됩니다.

한 올 한 올 정확한 헤어 모델링: 중요한 발전
이 분야의 핵심적인 발전은 가닥 형태의 헤어스타일을 생성하는 것입니다. 가닥 단위의 정확한 헤어 모델링은 컴퓨터 비전 및 그래픽 분야의 다양한 응용 분야, 특히 표준 툴을 사용한 후속 물리 기반 렌더링 및 시뮬레이션을 가능하게 하는 데 필수적입니다. 역사적으로 3D 헤어 재구성 시스템은 스트랜드 기반 제너레이티브 모델링의 주요 응용 분야였습니다. '원샷' 시나리오에서 자주 사용되는 이러한 시스템은 이미지에서 추출한 방향 맵과 같은 단서를 활용하여 단일 이미지에서 헤어스타일을 예측합니다. 그러나 이러한 시스템은 이미지에서 추출한 단서에 크게 의존하기 때문에 의미론 기반 또는 무조건적인 헤어스타일 생성을 위한 유연성이 부족합니다.

제너레이티브 모델의 제어 문제

현재 작업과 더 밀접한 관련이 있는 방법으로는 헤어스타일 에셋의 합성 데이터 세트를 활용하여 무조건 생성 모델을 훈련하는 Neural Haircut과 GroomGen이 있습니다. 이러한 모델은 멀티뷰 헤어 재구성을 규칙화하는 데 중요한 역할을 했습니다. 하지만 합성된 결과물에 대한 충분한 제어 기능이 부족합니다.

새로운 기여: 텍스트 기반, 스트랜드 기반 헤어 생성

이러한 격차를 해소하기 위해 이번 연구에서는 텍스트 설명에 기반한 스트랜드 기반 헤어스타일 생성 기능을 제공하는 선구적인 작업을 진행했습니다. 이 새로운 접근 방식은 헤어 생성 모델의 제어 가능성을 향상시킬 뿐만 아니라 텍스트-3D 기술 분야에서 중요한 진전을 이루었습니다. 간단한 텍스트 입력으로 한 올 한 올 세밀하고 정확한 헤어스타일을 생성하는 기능은 사실적인 아바타 제작의 새로운 가능성을 열어주며 컴퓨터 비전과 그래픽 모두에서 잠재적인 응용 분야를 확장합니다.

### 3. Method

HAAR 메서드는 컬, 길이, 스타일과 같은 헤어 특성에 대한 텍스트 설명을 사실적인 3D 스트랜드 기반 헤어 에셋으로 변환합니다. 이렇게 생성된 헤어스타일은 컴퓨터 그래픽 툴에 원활하게 통합되어 사실적인 렌더링과 애니메이션을 구현할 수 있습니다.

![개요. 텍스트 가이드 및 스트랜드 기반 헤어 생성을 위한 새로운 방법을 소개합니다. 훈련 세트의 각 헤어스타일 H에 대해 잠복 헤어 맵 Z를 생성하고 상용 VQA 시스템[26]과 맞춤형 주석 파이프라인을 사용하여 텍스트 캡션 P로 주석을 달았습니다. 그런 다음 조건부 확산 모델 D[16]를 훈련시켜 이 잠재 공간에서 안내 가닥을 생성하고 잠재 업샘플링 절차를 사용해 텍스트 설명이 주어지면 최대 10만 개의 가닥이 포함된 밀도 높은 헤어스타일을 재구성합니다. 그런 다음 생성된 헤어스타일은 상용 컴퓨터 그래픽 기술을 사용하여 렌더링됩니다[9].](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%201.png)

개요. 텍스트 가이드 및 스트랜드 기반 헤어 생성을 위한 새로운 방법을 소개합니다. 훈련 세트의 각 헤어스타일 H에 대해 잠복 헤어 맵 Z를 생성하고 상용 VQA 시스템[26]과 맞춤형 주석 파이프라인을 사용하여 텍스트 캡션 P로 주석을 달았습니다. 그런 다음 조건부 확산 모델 D[16]를 훈련시켜 이 잠재 공간에서 안내 가닥을 생성하고 잠재 업샘플링 절차를 사용해 텍스트 설명이 주어지면 최대 10만 개의 가닥이 포함된 밀도 높은 헤어스타일을 재구성합니다. 그런 다음 생성된 헤어스타일은 상용 컴퓨터 그래픽 기술을 사용하여 렌더링됩니다[9].

메서드의 핵심 구성 요소

잠복 확산 모델: 이 방법의 핵심은 헤어스타일 설명의 텍스트 임베딩을 조건으로 하는 잠복 확산 모델입니다. 이 모델은 변형 자동 인코더(VAE)가 생성한 잠재 공간 내에서 작동합니다. VAE는 저차원 공간에서 개별 헤어 스트랜드의 형상을 콤팩트하게 표현하도록 훈련됩니다.

헤어스타일 파라메트리화: 3D 헤어스타일은 두피에 균일하게 분포된 헤어 스트랜드 세트로 표현됩니다. 이는 지정된 해상도의 '헤어 맵'을 사용하여 수행되며, 각 픽셀은 머리카락 가닥을 폴리라인으로 저장합니다. 가닥은 VAE를 사용하여 잠재 맵으로 인코딩된 다음 처리되어 3D 모발 가닥을 생성합니다.

조건부 헤어 확산 모델: 텍스트 인코더는 헤어스타일 설명을 임베딩으로 변환하여 노이즈 제거 네트워크의 조건부 입력으로 사용합니다. 이 네트워크는 주의 메커니즘을 사용하며 2D U-Net 아키텍처를 기반으로 합니다. 이 네트워크는 텍스트 설명의 영향을 받아 잠재적 헤어 맵을 반복적으로 개선합니다.

사실감을 위한 업샘플링: 3D 헤어스타일의 한계를 극복하기 위해 이 방법은 처음에는 저해상도 잠복 헤어 맵으로 훈련합니다. 그런 다음 이 맵을 더 높은 해상도로 업샘플링하여 가닥 수를 늘리고, 근사 이웃 및 선형 보간 기법을 혼합하여 사용합니다. 이 업샘플링은 사실적인 지오메트리와 스트랜드 간의 다양성을 보장하기 위해 미세 조정됩니다.

![데이터 세트 수집. 렌더링된 정면 및 후면 헤어스타일과 사전 정의된 질문 세트 Q는 VQA[26, 27]를 통해 전송되어 헤어스타일 설명을 얻고, 이 설명은 고정 텍스트 인코더 네트워크[22]를 사용하여 추가로 인코딩됩니다.](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%202.png)

데이터 세트 수집. 렌더링된 정면 및 후면 헤어스타일과 사전 정의된 질문 세트 Q는 VQA[26, 27]를 통해 전송되어 헤어스타일 설명을 얻고, 이 설명은 고정 텍스트 인코더 네트워크[22]를 사용하여 추가로 인코딩됩니다.

데이터 생성 및 훈련

3D 헤어스타일 데이터: 훈련 데이터 세트는 아티스트가 제작한 헤어스타일과 공개적으로 사용 가능한 데이터 세트를 혼합하여 약 9825개의 다양한 헤어스타일 컬렉션으로 구성됩니다. 이러한 헤어스타일은 스트레칭 및 컬링과 같은 기술을 사용하여 가변성을 위해 증강됩니다.

헤어스타일 설명 생성: 헤어스타일에는 텍스트 주석이 없기 때문에 설명을 생성하는 데 시각적 질문-응답 모델(VQA)이 사용됩니다. 여기에는 다양한 각도에서 헤어스타일을 렌더링하고 미리 정의된 질문 세트를 사용하여 상세하고 다양한 주석을 생성하는 작업이 포함됩니다.

세부 사항 훈련: 확산 모델은 수렴을 강화하고 과적합을 피하기 위해 서브샘플링된 헤어스타일에 대해 훈련됩니다. 효과적인 훈련을 위해 소프트 Min-SNR 가중치 및 오일러 조상 샘플링과 같은 고급 전략이 사용됩니다. 전체 프로세스는 하이엔드 NVIDIA A100 GPU에서 약 5일이 소요됩니다.

핵심 사항

HAAR 방법은 잠재 공간에서 헤어 스트랜드 표현을 인코딩, 컨디셔닝 및 정제하는 정교한 프로세스입니다. 텍스트 설명과 고급 머신러닝 기술을 활용하여 현재 컴퓨터 그래픽 기술과 호환되는 사실적이고 다양하며 애니메이션이 가능한 3D 헤어 스트랜드를 성공적으로 생성합니다.

### 4. Experiments

제너레이티브 헤어 모델링의 영역에서 HAAR은 TECA 및 뉴럴 헤어컷과 같은 주목할 만한 방법과 비교하여 평가되었습니다. 이러한 비교는 텍스트 설명에서 사실적인 스트랜드 기반 헤어를 생성하는 HAAR의 효율성과 품질을 강조하는 데 매우 중요했습니다.

![비교. 조건부 생성 모델의 질적 비교. 여러 세대의 TECA [54]와 우리의 모델을 보여줍니다. 업샘플링 전(의사색으로 표시)과 후의 지오메트리를 시각화하여 결과를 확인합니다. 우리 모델은 더 높은 품질의 헤어스타일을 가진 더 다양한 샘플을 생성합니다. 또한 TECA가 경우에 따라 입력 설명을 잘 따르지 않아 긴 머리 대신 짧은 머리를 생성하는 경우도 있습니다(아래줄). 디지털 줌인을 권장합니다.](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%203.png)

비교. 조건부 생성 모델의 질적 비교. 여러 세대의 TECA [54]와 우리의 모델을 보여줍니다. 업샘플링 전(의사색으로 표시)과 후의 지오메트리를 시각화하여 결과를 확인합니다. 우리 모델은 더 높은 품질의 헤어스타일을 가진 더 다양한 샘플을 생성합니다. 또한 TECA가 경우에 따라 입력 설명을 잘 따르지 않아 긴 머리 대신 짧은 머리를 생성하는 경우도 있습니다(아래줄). 디지털 줌인을 권장합니다.

TECA 및 뉴럴 헤어컷과의 비교 분석

TECA 비교: 신경 방사장(NeRF)을 사용하여 머리카락을 포함한 종합적인 아바타를 생성하는 TECA가 주요 비교 대상이었습니다. TECA는 시각적 품질은 뛰어나지만 정확한 형상 재구성이 부족하고 샘플 하나를 생성하는 데 몇 시간이 걸리는 등 시간이 오래 걸립니다. 반면, HAAR는 사실적인 헤어 지오메트리에 초점을 맞추며 약 4.3초 만에 헤어스타일을 생성하는 등 훨씬 빠릅니다.

뉴럴 헤어컷 비교: 또 다른 경쟁 기술인 뉴럴 헤어컷은 다양한 조명 조건에서 동영상이나 이미지에서 3D 헤어스타일을 재구성하는 데 탁월합니다. 하지만 데이터 양, 모델 아키텍처 및 훈련 전략에 의해 제한을 받습니다. 신경 헤어컷은 HAAR과 달리 헤어스타일 생성 과정에 대한 제어 기능이 부족합니다.

무조건 및 조건부 확산 품질 평가하기

무조건 확산: HAAR과 동일한 데이터로 재훈련했을 때, Neural Haircut은 최소 매칭 거리(MMD) 및 커버리지(Cov)와 같은 지표를 사용하여 평가되었습니다. 이러한 지표는 생성된 헤어스타일이 훈련 분포와 얼마나 가깝게 일치하는지를 평가합니다. HAAR은 실측 분포와 더 유사하고 다양성이 높은 샘플을 생성하는 데 더 뛰어난 성능을 보였습니다.

조건부 확산: HAAR의 조건부 생성을 TECA와 비교했습니다. TECA는 종종 좋은 결과를 생성했지만, 다양성에서 한계를 보였고 때때로 눈에 띄는 아티팩트를 생성했습니다. 반면, HAAR은 다양한 프롬프트에 걸쳐 상세하고 물리적으로 그럴듯한 지오메트리를 일관되게 제공했습니다.

제거 연구: 주요 결과

텍스트 인코더 성능: HAAR의 조건부 생성 품질은 텍스트 인코더 네트워크에 따라 크게 달라졌습니다. 다양한 사전 학습 및 사용자 지정 학습 인코더를 평가한 결과, BLIP 텍스트 인코더가 헤어스타일 생성에 가장 효과적인 조건부 생성을 보여주었습니다.

업샘플링 방식 성능: 헤어스타일의 풍성함을 향상시키기 위해 다양한 업샘플링 전략을 테스트했습니다. 가장 가까운 이웃과 빌리니어 보간을 조합하고 잠재 공간에 노이즈를 추가한 결과 가장 사실적인 결과를 얻을 수 있었습니다.

![업샘플링. 가이딩 스트랜드 간 보간에 사용되는 다양한 업샘플링 방식 비교(어두운 색으로 표시). 여기서는 시각화를 위해 약 15,000개의 스트랜드를 표시했습니다. 블렌더 보간은 3D 공간에서 얻어지는 반면, 우리의 보간은 잠재 공간에서 계산됩니다. 두 변형 모두에서 가장 가까운 이웃을 사용하면 안내 가닥 지오메트리(어두운 색으로 표시)에 따라 정확도가 향상되지만, 전체적으로 비현실적인 모양이 됩니다. 이중 선형 방식은 평균 헤어 스트랜드의 침투와 원래 안내 가닥의 구조 손실로 이어집니다. 이 두 가지 방법을 혼합하면 제안된 문제를 해결하고 사실적인 렌더링을 얻을 수 있습니다. 잠재 공간에 노이즈를 추가하면 사실감을 더욱 높이고 그리드 구조를 제거하는 데 도움이 됩니다.](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%204.png)

업샘플링. 가이딩 스트랜드 간 보간에 사용되는 다양한 업샘플링 방식 비교(어두운 색으로 표시). 여기서는 시각화를 위해 약 15,000개의 스트랜드를 표시했습니다. 블렌더 보간은 3D 공간에서 얻어지는 반면, 우리의 보간은 잠재 공간에서 계산됩니다. 두 변형 모두에서 가장 가까운 이웃을 사용하면 안내 가닥 지오메트리(어두운 색으로 표시)에 따라 정확도가 향상되지만, 전체적으로 비현실적인 모양이 됩니다. 이중 선형 방식은 평균 헤어 스트랜드의 침투와 원래 안내 가닥의 구조 손실로 이어집니다. 이 두 가지 방법을 혼합하면 제안된 문제를 해결하고 사실적인 렌더링을 얻을 수 있습니다. 잠재 공간에 노이즈를 추가하면 사실감을 더욱 높이고 그리드 구조를 제거하는 데 도움이 됩니다.

헤어스타일 편집 및 한계

텍스트 기반 헤어스타일 편집: Imagic과 마찬가지로 HAAR에서도 텍스트 기반 헤어스타일 편집이 가능합니다. 여기에는 텍스트 반전, 최적화 및 보간 기술을 사용하여 원하는 텍스트 프롬프트에 따라 입력된 헤어스타일을 수정할 수 있습니다.

![헤어스타일 편집. Imagic [17]과 유사하게 텍스트 프롬프트를 사용하여 입력 이미지를 편집합니다. 확산 모델을 추가로 조정하지 않은 경우(처음 두 행)와 조정한 경우(두 번째 두 행)의 편집 결과를 제공합니다. 확산 모델을 미세 조정하면 편집이 더 부드러워지고 입력 헤어스타일을 더 잘 보존할 수 있습니다.](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%205.png)

헤어스타일 편집. Imagic [17]과 유사하게 텍스트 프롬프트를 사용하여 입력 이미지를 편집합니다. 확산 모델을 추가로 조정하지 않은 경우(처음 두 행)와 조정한 경우(두 번째 두 행)의 편집 결과를 제공합니다. 확산 모델을 미세 조정하면 편집이 더 부드러워지고 입력 헤어스타일을 더 잘 보존할 수 있습니다.

확인된 한계: HAAR의 주요 한계는 특히 지오메트리와 텍스트 주석 측면에서 훈련 데이터 세트의 다양성과 품질에 대한 의존성입니다. 두피 간섭과 극도로 곱슬거리는 헤어스타일의 제한된 표현과 같은 문제가 지적되었습니다. 또한 현재 HAAR은 머리 색깔이나 텍스처가 아닌 지오메트리에만 초점을 맞추고 있습니다.

![한계점. 두피 영역으로의 침투(왼쪽)를 포함한 실패 사례는 원칙적으로 후처리 단계에서 해결할 수 있습니다. 또한 아프로 헤어스타일(오른쪽)의 경우 가닥의 컬링 정도를 높여야 합니다.](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%206.png)

한계점. 두피 영역으로의 침투(왼쪽)를 포함한 실패 사례는 원칙적으로 후처리 단계에서 해결할 수 있습니다. 또한 아프로 헤어스타일(오른쪽)의 경우 가닥의 컬링 정도를 높여야 합니다.

HAAR은 텍스트 설명에서 사실적인 스트랜드 기반 헤어를 생성하는 데 있어 상당한 발전을 이루었습니다. 효율성과 다양한 헤어스타일을 생성할 수 있다는 점에서 기존 방식과 차별화됩니다. 하지만 다른 혁신적인 기술과 마찬가지로 데이터 세트의 다양성, 색상 및 텍스처 생성을 포함한 기능 확장 등 개선할 부분이 있습니다.

### 5. Conclusion

HAAR은 3D 모델링 및 컴퓨터 그래픽 분야의 선구적인 단계입니다. 순수하게 텍스트 설명만으로 사실적인 가닥 기반 헤어스타일을 생성할 수 있는 최초의 방법입니다. 이 혁신적인 접근 방식은 다양한 디지털 애플리케이션 내에서 헤어스타일을 생성하고 통합하는 방식을 혁신할 수 있는 잠재력을 가지고 있습니다.

컴퓨터 그래픽과 비전에 미치는 영향

컴퓨터 그래픽 향상: 컴퓨터 그래픽 영역에서 HAAR의 기능은 헤어스타일 생성 프로세스를 크게 가속화합니다. 블렌더와 같은 인기 도구와 원활하게 통합되어 헤어 편집을 용이하게 하고 물리 기반 애니메이션을 구현할 수 있습니다. 이러한 통합은 복잡하고 시간이 많이 걸리던 작업을 획기적으로 간소화합니다.

컴퓨터 비전 발전: 컴퓨터 비전의 경우, HAAR은 아바타를 생성하고 합성 훈련 데이터를 생성하는 강력한 도구로 사용됩니다. 사실적인 헤어스타일을 생성하는 능력은 아바타의 사실성과 다양성을 향상시켜 더욱 섬세하고 정확한 컴퓨터 비전 애플리케이션에 기여합니다.

향후 방향과 한계

HAAR은 상당한 발전을 이루었지만, 주로 의존하는 데이터 세트와 관련된 한계가 없는 것은 아닙니다. 데이터의 다양성과 품질은 생성할 수 있는 다양한 헤어스타일에 직접적인 영향을 미칩니다. 하지만 이러한 한계에도 불구하고 HAAR은 완전히 제어 가능한 자동 헤어스타일 생성을 향한 중요한 첫걸음입니다. 이 기술의 개발은 새로운 가능성을 열어주고 이 분야의 미래 혁신을 위한 토대를 마련합니다.

### Appendix

헤어스타일 확산 모델의 구현 및 훈련

HAAR은 이미지 크기, 입력 채널 등과 같은 특정 매개변수가 있는 조건부 확산 모델에 U-Net 아키텍처를 활용하여 생성 프로세스를 최적화합니다. 트레이닝 파이프라인은 EDM 라이브러리를 기반으로 하며, 최적화 도구로 AdamW를 사용합니다. 이 설정을 통해 효율적인 학습과 텍스트 설명을 기반으로 한 정확한 헤어 생성이 가능합니다.

![비교. TECA와의 확장된 비교. 우리의 방법은 TECA에서 생성된 샘플보다 더 다양하고 고품질의 샘플을 생성하며, 물리 시뮬레이터에서 머리카락의 애니메이션을 표현할 수 있습니다.](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%207.png)

비교. TECA와의 확장된 비교. 우리의 방법은 TECA에서 생성된 샘플보다 더 다양하고 고품질의 샘플을 생성하며, 물리 시뮬레이터에서 머리카락의 애니메이션을 표현할 수 있습니다.

프롬프트를 사용한 데이터 주석 프로세스

비전-질문-응답(VQA) 모델을 사용한 데이터 주석에는 다양한 세부 프롬프트가 사용되었습니다. 질감, 길이, 스타일과 같은 특정 헤어스타일 특징을 추출하도록 설계된 이러한 프롬프트는 정확하고 다양한 데이터 세트 주석을 생성하는 데 필수적이었습니다. 이 접근 방식은 생성된 헤어스타일이 사실적이고 텍스트 설명과 거의 일치하도록 보장했습니다.

![분류기 없는 안내. 안내 가중치 w를 0에서 2.5로 변경하는 동안의 샘플 품질. 가중치 w = 0은 무조건 생성에 해당하고, w = 1은 조건부 생성에 해당합니다. w > 1의 경우 과도한 조건부 결과를 얻습니다. 실험에서는 가중치가 높을수록 더 많은 침투가 발생하고 현실감이 떨어지므로 w = 1.5로 고정했습니다. 처음 네 줄은 두 개의 서로 다른 무작위 시드가 있는 '볼륨 있는 스트레이트 헤어'에 대한 생성 샘플에 해당하고, 마지막 네 줄은 '웨이브 있는 긴 헤어'에 대한 샘플입니다.](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%208.png)

분류기 없는 안내. 안내 가중치 w를 0에서 2.5로 변경하는 동안의 샘플 품질. 가중치 w = 0은 무조건 생성에 해당하고, w = 1은 조건부 생성에 해당합니다. w > 1의 경우 과도한 조건부 결과를 얻습니다. 실험에서는 가중치가 높을수록 더 많은 침투가 발생하고 현실감이 떨어지므로 w = 1.5로 고정했습니다. 처음 네 줄은 두 개의 서로 다른 무작위 시드가 있는 '볼륨 있는 스트레이트 헤어'에 대한 생성 샘플에 해당하고, 마지막 네 줄은 '웨이브 있는 긴 헤어'에 대한 샘플입니다.

텍스트 기반 모델 및 생략

"LLaVAv1.5" 모델은 낮은 오류율로 텍스트 설명을 생성하는 데 가장 적합한 것으로 확인되었습니다. CLIP과 BLIP을 포함한 다양한 텍스트 인코더 모델을 실험하고, BERTTokenizer를 기반으로 구축된 최적화 가능한 Transformer와 비교했습니다. 이러한 실험을 통해 작업에 가장 효과적인 텍스트 인코더를 찾는 것이 목표였습니다.

추가 절제 및 결과

- TECA와의 정성적 비교: TECA와의 확장된 비교를 통해 특히 복잡한 프롬프트에서 HAAR의 우수한 구성 능력이 입증되었습니다.
- 분류기-프리-가이드 중요도: 훈련 중 분류기 없는 안내를 사용하여 조건부 모델의 샘플 품질을 향상시켰습니다. 이 접근 방식은 조건부 프롬프트의 강도와 비현실적인 샘플을 피하는 것 사이의 균형을 최적화하는 데 도움이 되었습니다.
- 헤어스타일 보간 및 편집: 텍스트 프롬프트 사이를 선형으로 보간하고 헤어스타일을 편집하는 기술이 개발되었습니다. 이러한 프로세스에는 텍스트 반전, 최적화, 확산 미세 조정과 같은 단계가 포함되어 다양한 헤어스타일을 생성하는 데 있어 모델의 유연성을 높이는 데 기여했습니다.
- 업샘플링 방식 및 일반화 기능: 사실감을 위해 다양한 업샘플링 방식을 테스트한 결과, 가장 가까운 이웃과 선형 보간을 혼합한 방식이 가장 효과적인 것으로 나타났습니다. 이 모델은 다양한 헤어스타일 유형, 질감, 길이를 구분할 수 있는 강력한 일반화 기능을 보여주었습니다.
    
    ![업샘플링. 서로 다른 방식을 사용하여 얻은 가이드 가닥 사이의 헤어스타일 보간에 대한 확장된 결과. 더 나은 시각적 비교를 위해 헤어스타일을 약 15,000개 가닥으로 보간하고, 잠재 공간에서 보간하는 우리 방식에 대한 가이딩 가닥(어두운 색으로 표시)을 추가로 시각화했습니다. 노이즈를 추가한 최종 방법은 격자 모양의 아티팩트를 제거하여 헤어스타일의 사실감을 향상시킵니다.](HAAR%20Text-Conditioned%20Generative%20Model%20of%203D%20Stran%200bea58a1a6db4b1291c24c27acc3115b/Untitled%209.png)
    
    업샘플링. 서로 다른 방식을 사용하여 얻은 가이드 가닥 사이의 헤어스타일 보간에 대한 확장된 결과. 더 나은 시각적 비교를 위해 헤어스타일을 약 15,000개 가닥으로 보간하고, 잠재 공간에서 보간하는 우리 방식에 대한 가이딩 가닥(어두운 색으로 표시)을 추가로 시각화했습니다. 노이즈를 추가한 최종 방법은 격자 모양의 아티팩트를 제거하여 헤어스타일의 사실감을 향상시킵니다.
    
- 시뮬레이션 및 향후 연구 방향: 생성된 헤어스타일은 다양한 시나리오에서 사실적인 시뮬레이션을 위해 언리얼 엔진에 통합되었습니다. 이 연구는 향후 각 헤어스타일에 대한 개별적인 물리적 속성을 예측하여 아티스트의 프로세스를 더욱 간소화할 수 있는 가능성을 시사했습니다.

결론

- HAAR의 구현 및 훈련 세부 사항은 텍스트 설명에서 사실적인 헤어스타일을 생성하는 모델의 정교함을 강조합니다. 광범위한 절제 연구와 실험을 통해 다양한 헤어스타일을 정확하게 렌더링하고 다양한 시나리오에 적응할 수 있는 능력을 보여주며, 향후 이 분야의 발전을 위한 강력한 토대를 마련했습니다.