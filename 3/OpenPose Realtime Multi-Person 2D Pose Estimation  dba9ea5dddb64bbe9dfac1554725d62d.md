# OpenPose: Realtime Multi-Person 2D Pose Estimation using Part Affinity Fields

*이 논문에서는 실시간 다중 인원 2D 포즈 추정 시스템인 OpenPose를 소개합니다. 저자는 명시적인 비파라메트릭 표현을 활용하여 사람의 팔다리의 위치와 방향을 모두 인코딩하는 접근 방식을 소개합니다. 제안된 아키텍처는 부위 감지와 연관성을 동시에 학습하고, 고품질의 신체 포즈 파싱을 효율적으로 생성하기 위해 욕심 많은 파싱 알고리즘을 사용합니다. 이 연구는 또한 파트 선호도 필드(PAF)를 개선하면 런타임 성능과 정확도가 모두 크게 향상된다는 점을 강조합니다. 또한 신체와 발 추정을 단일 모델로 통합하면 각 구성 요소의 정확도가 개별적으로 향상되고 추론 시간이 단축됩니다. 저자는 15,000개의 발 키포인트 인스턴스로 구성된 발 키포인트 데이터 세트를 생성하여 작업을 보완했습니다. 오픈소스로 공개된 OpenPose는 현재 사람 재식별, 리타겟팅, 인간-컴퓨터 상호작용과 같은 연구 분야에서 널리 사용되고 있으며, OpenCV 라이브러리에 통합되었습니다.*

[https://arxiv.org/pdf/1812.08008.pdf](https://arxiv.org/pdf/1812.08008.pdf)

[https://arxiv.org/abs/1812.08008](https://arxiv.org/abs/1812.08008)

[https://github.com/CMU-Perceptual-Computing-Lab/openpose_unity_plugin](https://github.com/CMU-Perceptual-Computing-Lab/openpose_unity_plugin)

- Dec 2018

### 1 INTRODUCTION

이 논문은 이미지와 동영상에서 사람의 포즈를 추정하는 과정, 즉 사람 2D 포즈 추정에 관한 것입니다. 목표는 신체의 중요한 부분 또는 "키포인트"를 식별하고 위치를 지정하는 것입니다. 이미지에 사람이 여러 명 있을 때는 그 수가 얼마든지 많을 수 있고, 이들의 상호 작용과 겹침으로 인해 개별 신체 부위를 식별하기 어려울 수 있기 때문에 더 까다로운 작업입니다. 또한 이미지에 사람이 많을수록 처리하는 데 더 많은 컴퓨팅 리소스가 필요하므로 실시간 성능이 느려질 수 있습니다.

이 문제를 해결하기 위한 일반적인 방법 중 하나는 먼저 개별 인물을 감지한 다음 각 인물의 포즈를 개별적으로 추정하는 것입니다. 하지만 이 접근 방식에는 몇 가지 문제가 있습니다. 사람 감지 기능이 실패하면(사람들이 서로 가까이 있을 때 발생할 수 있음) 이를 수정할 수 있는 쉬운 방법이 없습니다. 또한 각 사람의 포즈를 개별적으로 추정하기 때문에 이미지에 포함된 사람의 수가 많아질수록 처리 시간이 늘어납니다.

또 다른 접근 방식은 "상향식" 방식입니다. 이 방법은 처음에 개별 인물과 연결하지 않고 전체 이미지에서 신체 부위를 식별하려고 시도하므로 더 강력하고 잠재적으로 이미지의 사람 수에 대한 처리 시간의 의존성을 줄일 수 있습니다. 그러나 이러한 방법은 다른 신체 부위와 사람의 맥락적 단서를 최대한 활용하지 못하는 경우가 많으며, 이 접근법의 초기 버전은 시간이 많이 걸리는 전역 추론 과정으로 인해 효율성이 떨어졌습니다.

![상단: 여러 사람 포즈 추정. 발 키포인트(엄지발가락, 새끼발가락, 발뒤꿈치)를 포함하여 같은 사람에 속한 신체 부위가 연결됩니다. 왼쪽 아래: Part 팔다리에 해당하는 선호도 필드(PAF)가 연결되어 있습니다. 오른쪽 팔꿈치와 손목. 색상은 방향을 인코딩합니다. 오른쪽 아래: 모든 PAF의 각 픽셀에 있는 2D 벡터는 팔다리의 위치와 방향을 인코딩합니다.](OpenPose%20Realtime%20Multi-Person%202D%20Pose%20Estimation%20%20dba9ea5dddb64bbe9dfac1554725d62d/Untitled.png)

상단: 여러 사람 포즈 추정. 발 키포인트(엄지발가락, 새끼발가락, 발뒤꿈치)를 포함하여 같은 사람에 속한 신체 부위가 연결됩니다. 왼쪽 아래: Part 팔다리에 해당하는 선호도 필드(PAF)가 연결되어 있습니다. 오른쪽 팔꿈치와 손목. 색상은 방향을 인코딩합니다. 오른쪽 아래: 모든 PAF의 각 픽셀에 있는 2D 벡터는 팔다리의 위치와 방향을 인코딩합니다.

이 논문에서 저자는 여러 사람의 포즈를 추정하는 새롭고 더 효율적인 '상향식' 방법을 제시합니다. 저자들은 이미지에서 팔다리의 위치와 방향을 나타내는 2D 벡터 필드인 파트 선호도 필드(PAF)를 소개합니다. 이러한 PAF를 감지와 함께 추론함으로써 충분한 컨텍스트를 인코딩하여 고품질의 결과를 빠르게 생성할 수 있습니다.

이 논문은 또한 몇 가지 새로운 기여를 합니다. 첫째, PAF를 세분화하는 것이 정확도에 매우 중요한 반면 신체 부위 예측을 세분화하는 것은 그다지 중요하지 않다는 것을 보여줍니다. 네트워크 깊이를 늘리고 신체 부위 세분화 단계를 제거함으로써 이 방법의 속도와 정확도를 높일 수 있었습니다. 또한 15,000개의 사람 발 인스턴스가 포함된 데이터 세트를 소개하며, 이를 신체 키포인트와 결합하여 학습한 모델이 신체 전용 모델만큼 빠르고 정확하다는 것을 보여줍니다. 또한 이 방법을 차량 키포인트 추정 작업에도 적용할 수 있음을 보여줍니다. 마지막으로 실시간 다인 2D 포즈 감지를 위한 오픈소스 라이브러리인 OpenPose를 공개하고, 이 라이브러리가 Mask R-CNN이나 Alpha-Pose와 같은 다른 방법보다 계산적으로 더 효율적이라는 것을 보여 줍니다.

### 2 RELATED WORK

이 단원에서는 이미지 또는 비디오에서 사람의 신체 부위의 위치와 방향을 결정하는 프로세스인 사람 포즈 추정에 사용되는 몇 가지 방법에 대한 개요를 제공합니다.

한 사람의 포즈 추정에는 전통적으로 신체 부위의 국소적 관찰과 그 사이의 공간적 관계를 사용합니다. 이 작업은 신체 부위 간의 공간적 관계를 설명하는 트리 구조의 그래픽 모델 또는 폐색, 대칭 및 장거리 관계를 고려하는 비트리 모델을 사용하여 수행할 수 있습니다. 이러한 관찰에는 일반적으로 컨볼루션 신경망(CNN)이 사용되며, 이를 통해 포즈 추정 정확도가 크게 향상됩니다.

이 글에서는 1인 포즈 추정 분야에 기여한 여러 특정 연구를 언급하고 있습니다. 이 연구들은 매개변수가 공동으로 학습되는 심층 네트워크와 그래픽 모델을 사용하고, 대규모 수용 필드를 사용하여 전역 공간 종속성을 포착하는 등 다양한 구조적 개선 사항을 제안합니다. 하지만 이러한 방법들은 모두 이미지에 한 사람이 있다고 가정합니다.

여러 사람의 포즈를 추정하는 경우, 대부분의 방법은 하향식 접근 방식을 취합니다. 먼저 이미지에서 사람을 감지한 다음 각 사람의 포즈를 독립적으로 추정합니다. 이 방식은 1인 추정용으로 개발된 기술을 바로 적용할 수 있지만 단점이 있습니다. 이 접근 방식은 여러 사람 간의 공간적 의존성을 고려하지 못하기 때문에 글로벌 추론이 필요합니다. 또한 사람 감지 단계에서 실패할 경우 이를 수정할 방법이 없습니다.

일부 다인 포즈 추정 방법은 사람 간 의존성을 고려하지만, 사람 감지기가 필요하고 이미지당 몇 분씩 걸리는 등 계산 비용이 많이 들 수 있습니다.

이 연구는 파트 선호도 필드(PAF)를 도입한 이전 연구를 확장한 것입니다. PAF는 여러 사람의 신체 부위 사이의 비정형적인 쌍 관계를 인코딩하는 흐름 필드입니다. 이 방법을 사용하면 추가 학습 단계 없이도 쌍별 점수를 효율적으로 계산할 수 있으며, 고품질의 실시간 다중 인원 포즈 추정이 가능합니다.

이 작업에서는 몇 가지 수정이 이루어졌습니다. 저자는 높은 정확도를 위해서는 PAF를 세분화하는 것이 중요하다는 것을 증명하고, 더 빠르고 정확한 모델을 제시합니다. 또한 주석이 달린 발 데이터 세트를 사용하여 신체와 발 키포인트 검출기를 결합한 최초의 모델을 공개합니다. 이 결합된 접근 방식은 정확도를 유지하면서 추론 시간을 줄여줍니다. 마지막으로 실시간 신체, 발, 손, 얼굴 키포인트 감지를 위한 오픈소스 라이브러리인 OpenPose를 소개합니다.

### 3 METHOD

이 단원에서는 이미지에서 사람의 포즈를 추정하는 데 사용되는 딥러닝 기반 방법에 대한 자세한 개요를 제공합니다. 이 시스템은 컬러 이미지를 입력으로 받아 이미지에서 개인의 주요 해부학적 지점을 식별합니다. 시스템의 주요 단계는 다음과 같습니다:

![전체 파이프라인. (a) 전체 이미지를 입력으로 사용하여 CNN이 (b) 신체 부위 감지를 위한 신뢰도 맵과 (c) 부위 연관을 위한 PAF를 공동으로 예측하는 방법. (d) 파싱 단계에서는 신체 부위 후보를 연결하기 위해 일련의 이분법적 매칭을 수행합니다. (e) 마지막으로 이미지에 있는 모든 사람의 전신 포즈로 조합합니다.](OpenPose%20Realtime%20Multi-Person%202D%20Pose%20Estimation%20%20dba9ea5dddb64bbe9dfac1554725d62d/Untitled%201.png)

전체 파이프라인. (a) 전체 이미지를 입력으로 사용하여 CNN이 (b) 신체 부위 감지를 위한 신뢰도 맵과 (c) 부위 연관을 위한 PAF를 공동으로 예측하는 방법. (d) 파싱 단계에서는 신체 부위 후보를 연결하기 위해 일련의 이분법적 매칭을 수행합니다. (e) 마지막으로 이미지에 있는 모든 사람의 전신 포즈로 조합합니다.

입력 이미지를 컨볼루션 신경망(CNN)으로 분석하여 신체 부위 위치에 대한 2D 신뢰도 맵과 신체 부위 간의 연관성을 측정하는 2D 벡터 필드(부위 선호도 필드, PAF)를 예측합니다. 각 신체 부위와 팔다리는 고유한 맵 또는 필드로 표현됩니다.

네트워크 아키텍처는 여러 단계에 걸쳐 PAF와 신뢰도 맵의 예측을 반복적으로 개선하여 반복할 때마다 더 정확하고 우수한 예측을 제공합니다. 저자들은 이전 모델보다 더 큰 네트워크 깊이를 사용했으며, 계산을 줄이면서 수용 필드를 유지하기 위해 더 큰 컨볼루션 커널을 여러 개의 작은 커널로 대체했습니다. 각 컨볼루션 커널의 출력은 비선형성 레이어 수를 세 배로 늘리고 하위 수준과 상위 수준의 특징을 모두 유지하는 DenseNet과 유사한 접근 방식을 모방하여 연결됩니다.

먼저 사전 초기화된 CNN이 이미지를 분석하여 특징 맵 세트를 생성합니다. 그런 다음 이 맵을 시스템의 첫 번째 단계에 입력하면 PAF 세트가 생성됩니다. 이후 각 단계에서는 이전 단계의 예측과 원본 이미지 특징이 결합되어 보다 정교한 예측을 생성합니다. 신뢰도 맵의 탐지는 가장 최근에 업데이트된 PAF 예측으로 시작됩니다. 이 방법은 여러 단계에서 PAF와 신뢰도 맵을 개선하여 단계별로 필요한 계산을 효과적으로 줄인다는 점에서 이전 접근 방식과 다릅니다.

신뢰도 맵은 개별 신체 부위를 감지하는 데 사용됩니다. 지상 실측 신뢰도 맵은 주석이 달린 2D 키포인트로부터 생성됩니다. 각 신뢰도 맵은 특정 신체 부위가 특정 픽셀에 위치할 수 있다는 믿음을 나타냅니다. 그런 다음 개별 신뢰도 맵을 집계하여 최종 신뢰도 맵을 생성합니다.

신체 부위 선호도 필드는 신체 부위를 연결하는 데 사용되며, 각 신체 부위 감지 쌍 간의 연관성을 측정해야 할 필요성을 해결합니다. 이 필드는 사지 영역 전반의 위치와 방향 정보를 모두 보존합니다. 그라운드트루스 PAF는 사지의 한 부분에서 다른 부분을 가리키는 단위 벡터로 사지의 위치에서 정의됩니다. 테스트 중에 후보 부위 탐지 간의 연관성은 후보 부위 위치를 연결하는 선분을 따라 해당 PAF에 대한 선 적분을 계산하여 측정됩니다.

이 과정은 딥러닝을 사용하여 주어진 이미지에서 다양한 신체 부위를 감지하고 연관시키는 복잡하고 반복적인 프로세스입니다. 궁극적인 목표는 이미지 내에서 인체의 포즈를 정확하게 2차원으로 표현하는 것입니다.

이 글에서는 파트 선호도 필드(PAF)를 사용하여 단일 이미지에서 여러 사람을 파싱하는 방법에 대해 설명합니다. 이 방법은 주로 다양한 신체 부위를 감지하여 올바른 개인과 정확하게 연관시켜야 하는 사람 포즈 추정에서 사용됩니다.

이 방법을 자세히 설명합니다:

파트 후보 위치: 이 방법은 탐지 신뢰도 맵에서 최대값이 아닌 억제를 수행하여 잠재적인 신체 부위 위치를 식별하는 것으로 시작합니다. 각 부위에 대해 여러 사람이 있거나 오탐으로 인해 여러 후보가 식별될 수 있습니다.

사지 후보 점수 매기기: 신체 부위 쌍으로 정의된 각 잠재적 사지는 PAF의 선 적분 계산을 기반으로 점수를 매깁니다. 최적의 구문 분석을 찾는 과정은 NP-Hard이지만, 지속적으로 좋은 결과를 얻기 위해 욕심 많은 완화가 사용됩니다.

신체 부위 감지 후보: 이미지에 있는 모든 사람에 대해 신체 부위 감지 후보 집합을 얻습니다. 그런 다음 이러한 신체 부위 감지 후보를 서로 연결하여 동일한 사람의 연결된 팔다리를 식별합니다. 이는 최적의 연결 할당을 찾는 문제로 모델링됩니다.

최적의 연결: 특정 사지에 대해 한 쌍의 부위(예: 목과 오른쪽 엉덩이)를 고려하는 경우, 최적의 연관성을 찾는 것은 최대 가중치 이분 그래프 매칭 문제가 됩니다. 노드는 신체 부위 감지 후보이고 에지는 잠재적 연결이며, 각 노드는 부위 선호도 합계에 따라 가중치가 부여됩니다. 헝가리어 알고리즘을 사용하여 최대 가중치를 가진 매칭을 찾습니다.

![부위 연결 전략. (a) 두 신체 부위 유형에 대한 신체 부위 감지 두 신체 부위 유형에 대한 후보(빨간색과 파란색 점) 및 모든 연결 후보(회색 선). (b) 중간점(노란색 점) 표현을 사용한 연결 중간점(노란색 점) 표현을 사용한 결과: 올바른 연결(검은색 선) 및 잘못된 연결 (녹색 선)과 발생률 제약 조건도 만족하는 올바른 연결(검은색 선). (c) PAF를 사용한 결과(노란색 화살표). 인코딩 위치 및 팔다리의 지지대에 대한 방향을 인코딩함으로써 PAF는 잘못된 연관성을 제거합니다.](OpenPose%20Realtime%20Multi-Person%202D%20Pose%20Estimation%20%20dba9ea5dddb64bbe9dfac1554725d62d/Untitled%202.png)

부위 연결 전략. (a) 두 신체 부위 유형에 대한 신체 부위 감지 두 신체 부위 유형에 대한 후보(빨간색과 파란색 점) 및 모든 연결 후보(회색 선). (b) 중간점(노란색 점) 표현을 사용한 연결 중간점(노란색 점) 표현을 사용한 결과: 올바른 연결(검은색 선) 및 잘못된 연결 (녹색 선)과 발생률 제약 조건도 만족하는 올바른 연결(검은색 선). (c) PAF를 사용한 결과(노란색 화살표). 인코딩 위치 및 팔다리의 지지대에 대한 방향을 인코딩함으로써 PAF는 잘못된 연관성을 제거합니다.

여러 사람의 포즈: 여러 사람의 전신 포즈를 결정할 때는 K-차원 매칭 문제를 해결해야 합니다. 이 문제는 전체 그래프를 사용하는 대신 최소한의 에지 수를 선택하여 사람의 포즈 골격을 형성하고 문제를 이분법 매칭 하위 문제 집합으로 분해함으로써 단순화됩니다.

중복 PAF 연결: 이 모델은 혼잡한 이미지에서 정확도를 향상시키기 위해 중복 PAF 연결을 통합합니다. 이러한 중복 연결은 약간 수정된 다인 구문 분석 알고리즘에 의해 처리되며, 이 알고리즘은 가능한 모든 쌍별 연결을 PAF 점수에 따라 정렬하고 신뢰도가 높은 PAF 연결과 모순되는 연결은 삭제합니다.

이렇게 제안된 방법은 완전히 연결된 그래프에 대한 최적화보다 효율적이며, 혼잡한 이미지에서 더 높은 정확도를 제공합니다.

### 4 OPENPOSE

이 글에서는 실시간 다인 2D 사람 포즈 추정을 위한 오픈소스 시스템인 OpenPose에 대해 설명합니다. 이 시스템은 단일 이미지에서 신체, 발, 손, 얼굴 키포인트(총 135개)를 동시에 감지하는 최초의 시스템으로, 수많은 컴퓨터 비전 및 머신 러닝 애플리케이션에 유용함을 입증했습니다.

시스템: OpenPose는 프레임 판독기, 결과 시각화를 위한 디스플레이, 출력 파일 생성 등 모든 기능이 포함되어 있어 다른 2D 신체 포즈 추정 라이브러리 중에서도 단연 돋보입니다. 다양한 플랫폼(우분투, 윈도우, 맥 OSX, 임베디드 시스템)과 하드웨어(CUDA GPU, OpenCL GPU, CPU 전용 디바이스)를 지원합니다. 사용자는 입력(이미지, 비디오, 웹캠, IP 카메라 스트리밍)을 선택하고 결과 표시, 디스크 저장, 디텍터 활성화/비활성화, 사용할 GPU 개수 제어 등 다양한 기능을 유연하게 선택할 수 있습니다.

블록: OpenPose는 (a) 신체+발 감지, (b) 손 감지, (c) 얼굴 감지의 세 가지 블록으로 구성됩니다. 핵심 블록은 신체+발 키포인트 감지기가 결합된 블록입니다. 얼굴 및 손 바운딩 박스 제안은 신체 감지기의 출력을 기반으로 생성됩니다.

성능: OpenPose는 고품질의 결과를 유지하면서 추론 시간에서 다른 방법보다 성능이 뛰어납니다. Nvidia GTX 1080 Ti가 탑재된 컴퓨터에서 초당 약 22프레임(FPS)으로 실행할 수 있으며, 높은 정확도를 유지합니다. 사람 재식별, 비디오 리타겟팅, 인간-컴퓨터 상호작용, 3D 포즈 추정, 3D 휴먼 메시 모델 생성 등 다양한 분야에서 활용되고 있습니다.

확장된 발 키포인트 감지: 포즈 추정의 정확도를 높이기 위해 저자는 엄지발가락과 발뒤꿈치 같은 추가 발 키포인트를 포함하도록 모델을 확장했습니다. 이를 위해 레이블이 지정된 데이터 세트를 만들었습니다. 단순한 발 키포인트 감지기를 구축하는 대신 신체 추정에 사용된 것과 동일한 아키텍처를 훈련하여 신체와 발의 위치를 동시에 예측했습니다. 이 접근 방식은 네트워크가 신체 키포인트, 특히 발목 위치와 같은 다리 키포인트를 더 정확하게 예측하는 데 암시적으로 도움이 됩니다.

![발 키포인트 분석. (a) 발 키포인트 주석, 엄지발가락, 새끼발가락, 발뒤꿈치로 구성되어 있습니다. (b) 몸통만 오른쪽 발목이 제대로 추정되지 않은 모델 예제. (c) 유사한 신체+발 모델 예시, 발 정보는 오른쪽 발목 위치를 예측하는 데 도움이 됩니다.](OpenPose%20Realtime%20Multi-Person%202D%20Pose%20Estimation%20%20dba9ea5dddb64bbe9dfac1554725d62d/Untitled%203.png)

발 키포인트 분석. (a) 발 키포인트 주석, 엄지발가락, 새끼발가락, 발뒤꿈치로 구성되어 있습니다. (b) 몸통만 오른쪽 발목이 제대로 추정되지 않은 모델 예제. (c) 유사한 신체+발 모델 예시, 발 정보는 오른쪽 발목 위치를 예측하는 데 도움이 됩니다.

요약하자면, OpenPose는 여러 사람의 포즈 추정을 위한 포괄적이고 사용자 친화적인 시스템입니다. 광범위한 키포인트를 감지하고 실시간으로 실행할 수 있어 컴퓨터 비전 및 머신 러닝의 다양한 애플리케이션을 위한 강력한 도구입니다.

### 5 DATASETS AND EVALUATIONS

세 가지 데이터 세트에 대해 평가한 여러 사람의 포즈 추정 방법에 대한 자세한 보고서를 공유하고 계신 것 같습니다: MPII 휴먼 멀티퍼슨, COCO 키포인트 챌린지, 그리고 사용자 지정 발 데이터 세트입니다. 이 방법은 신체 부위를 연결하는 다른 상향식 접근 방식보다 우수한 것으로 입증된 PAF(파트 선호도 필드)라는 새로운 특징 표현을 사용합니다.

다음은 보고서를 기반으로 한 주요 내용입니다:

![Untitled](OpenPose%20Realtime%20Multi-Person%202D%20Pose%20Estimation%20%20dba9ea5dddb64bbe9dfac1554725d62d/Untitled%204.png)

MPII 다인 데이터 세트 결과

이 방법은 288개의 이미지 하위 집합에서 이전의 최신 상향식 방법보다 8.5% mAP 성능이 뛰어나며 추론 시간은 6배나 짧습니다.

스케일 검색을 사용하지 않을 경우, 이 방법은 이미 이전 방법보다 mAP가 13% 절대적으로 증가하여 성능이 뛰어납니다. 3 스케일 검색을 사용하면 성능이 75.6% mAP로 더욱 향상됩니다.

스켈레톤 구조에서 최소한의 에지를 사용하는 것으로도 비슷한 결과를 얻을 수 있습니다.

절제 분석에 따르면 PAF 방법의 정확도는 중간점 표현 방법보다 높으며, 정탐 예측을 정확하게 식별하여 성능을 향상시킵니다.

COCO 키포인트 챌린지 결과

높은 척도(APL)의 사람만 고려할 경우 정확도가 크게 떨어지는 것으로 나타났습니다.

상향식 방식은 58.4%의 AP를 달성하며, 재조정된 영역에 대해 단일 사람 CPM으로 결과를 세분화한 후 2.6% 개선됩니다.

CPM 개선이 없는 새로운 아키텍처는 기존 접근 방식보다 약 7% 더 정확하면서도 속도는 두 배 빨라집니다.

추론 런타임 분석

이 방법의 추론 시간은 마스크 R-CNN 및 알파 포즈와 같은 다른 방법과 달리 이미지의 사람 수에 변하지 않습니다.

새로운 결합 모델은 더 정확할 뿐만 아니라 GPU 버전을 사용할 때 원래 모델보다 2배 더 빠릅니다. 그러나 CPU 버전은 더 높은 메모리 요구 사항으로 인해 5배 더 느립니다.

이 결과는 포즈 추정 방법의 효과와 효율성을 나타내며, 이전 모델에 비해 속도와 정확도 측면에서 PAF 특징 표현의 이점과 접근 방식의 장점을 강조합니다.

이 단원에서는 이미지에서 인체의 주요 포인트를 식별하는 컴퓨터 비전 작업인 인체 포즈 추정 분야의 다양한 장단점과 연구 결과에 대해 설명합니다. 주요 요점은 다음과 같습니다:

속도와 정확도 사이의 트레이드오프: 저자들은 물체 감지를 위한 영역 제안 방법(예: Faster-rcnn)과 단일 샷 방법(예: YOLO, SSD)을 비교하여 속도와 정확도 간의 절충점을 찾았습니다. 영역 제안 방식은 특히 여러 사람이 있는 이미지에서 정확도는 높지만 속도가 느립니다. 하드웨어가 더 빨라지고 메모리 효율이 높아짐에 따라 상향식 방식이 하향식 방식과의 정확도 격차를 좁힐 수 있을 것입니다.

사람 포즈 성능 지표: 저자들은 현재의 성능 지표가 키포인트 정확도에만 초점을 맞추고 속도를 무시하기 때문에 잠재적으로 잘못된 평가로 이어질 수 있다고 주장합니다. 이들은 속도와 정확도를 모두 사용하여 보다 완벽한 방법 비교를 제공할 것을 제안합니다.

풋 키포인트 데이터 세트: 저자들은 발 키포인트 데이터 세트를 개발하여 평균 정밀도와 리콜을 계산하여 결과를 평가했습니다. 그 결과, 결합 방식과 신체 전용 방식 간에 약간의 차이가 있을 뿐이며, 훈련 데이터 크기가 작아 발 키포인트 감지에 약간의 제한이 있다는 사실을 발견했습니다.

차량 자세 추정: 저자들은 차량 키포인트 감지 작업으로 접근 방식을 확장하여 일반성을 입증했습니다. 이들은 더 작고 단순한 데이터 세트를 사용했기 때문에 차체 키포인트 작업보다 더 높은 평균 정밀도와 회상률을 달성했습니다.

![유효성 검사 세트의 차량 키포인트 감지 예시. 키포인트 위치가 성공적으로 추정됩니다. 차량 간 겹침, 잘린 차량, 다른 축척 등 까다로운 시나리오에서도 키포인트 위치를 성공적으로 추정합니다.](OpenPose%20Realtime%20Multi-Person%202D%20Pose%20Estimation%20%20dba9ea5dddb64bbe9dfac1554725d62d/Untitled%205.png)

유효성 검사 세트의 차량 키포인트 감지 예시. 키포인트 위치가 성공적으로 추정됩니다. 차량 간 겹침, 잘린 차량, 다른 축척 등 까다로운 시나리오에서도 키포인트 위치를 성공적으로 추정합니다.

실패 사례 분석: 일반적인 포즈가 아닌 경우, 거꾸로 된 경우, 신체가 가려진 경우, 사람이 겹치는 매우 혼잡한 이미지, 동물이나 조각상 이미지의 경우 시스템이 실패하여 오탐을 일으킬 수 있습니다.

이 글에서는 속도와 정확도가 포즈 추정 시스템의 성능에 중요한 역할을 한다는 점을 강조하며, 보다 다양한 훈련 예제를 통해 일부 실패 사례를 해결할 수 있다고 제안합니다.

### 6 CONCULUSION

이 글에서는 기계가 사람과 사람의 상호 작용을 시각적으로 이해하고 해석하는 데 중요한 요소인 실시간 다인 2D 포즈 추정에 대한 저자들의 연구를 요약합니다.

이 연구의 주요 결과와 공헌은 다음과 같습니다:

키포인트 연관 표현: 연구진은 사람 팔다리의 위치와 방향을 모두 인코딩하여 포즈 추정을 위한 세부 정보를 제공하는 키포인트 연상의 비모수적 표현을 제안했습니다.

부분 감지 및 연결의 공동 학습: 이 아키텍처는 부위 감지와 연상을 동시에 학습하도록 설계되어 이러한 프로세스의 시너지 효과를 보장합니다.

그리디 파싱 알고리즘: 간단한 욕심 구문 분석 알고리즘으로 고품질의 신체 포즈 구문을 생성하고 이미지에 포함된 사람의 수에 관계없이 효율성을 유지할 수 있음을 보여주었습니다.

PAF 개선: PAF(신체 부위 선호도 필드)를 세분화하는 것이 PAF와 신체 부위 위치를 모두 세분화하는 것보다 훨씬 더 중요하며, 그 결과 런타임 성능과 정확도가 모두 크게 개선된다는 사실을 발견했습니다.

신체 및 발 추정 결합: 신체와 발 추정을 단일 모델로 결합하면 각 구성 요소의 정확도가 향상되고 순차적으로 실행할 때보다 추론 시간이 단축된다는 사실을 입증했습니다.

발 키포인트 데이터세트: 15,000개의 발 키포인트 인스턴스로 구성된 발 키포인트 데이터세트를 생성했으며, 이를 공개적으로 사용할 수 있도록 할 계획입니다.

OpenPose: 이들은 신체, 발, 손, 얼굴 키포인트 감지를 위한 최초의 실시간 시스템인 OpenPose로 작업을 오픈소스화했습니다. OpenPose는 사람 재식별, 리타겟팅, 인간-컴퓨터 상호작용과 같은 다양한 연구 주제에 널리 사용되고 있습니다. 또한, 오픈포즈는 널리 사용되는 오픈소스 컴퓨터 비전 및 머신러닝 소프트웨어 라이브러리인 OpenCV 라이브러리에도 포함되어 있습니다.

- 요약
    
    이 백서에서는 기계가 인간의 행동과 상호작용을 시각적으로 이해하고 해석하는 데 중요한 요소인 실시간 다인 2D 포즈 추정에 초점을 맞춘 프로젝트에 대해 설명합니다. 아래는 방법론에 대한 단계별 분석입니다:
    
    문제 정의: 저자들은 실시간 다중 인원 2D 포즈 추정이라는 문제를 정의하는 것으로 시작합니다. 이는 이미지 또는 비디오에서 여러 사람의 포즈를 실시간으로 식별하는 프로세스입니다. 이는 오클루전, 시점 및 스케일 변화, 조명 조건 등의 요인으로 인해 까다로운 문제입니다.
    
    솔루션 제안: 저자는 사람 팔다리의 위치와 방향을 모두 인코딩하는 키포인트 연결의 명시적 비파라메트릭 표현을 사용하는 새로운 솔루션을 제안합니다.
    
    아키텍처 설계: 저자들은 부품 감지와 연관성을 공동으로 학습할 수 있는 아키텍처를 설계합니다. 정확한 포즈 추정을 위해서는 정확한 부분 감지와 연결이 필수적이므로 이는 매우 중요한 단계입니다.
    
    그리디 파싱 알고리즘 개발: 고품질의 신체 포즈 파싱을 생성할 수 있는 욕심 파싱 알고리즘을 개발합니다. 중요한 점은 이 알고리즘이 이미지에 포함된 사람의 수에 관계없이 효율성을 유지한다는 점입니다.
    
    PAF 개선의 중요성: 연구를 통해 저자는 신체 부위 선호도 필드(PAF)를 세분화하는 것이 PAF와 신체 부위 위치를 모두 세분화하는 것보다 런타임 성능과 정확도 측면에서 훨씬 더 유리하다는 사실을 발견했습니다.
    
    신체 및 발 추정 결합: 저자들은 신체와 발 추정을 결합한 모델을 제안합니다. 이 결합된 모델은 각 개별 구성 요소의 정확도를 높일 뿐만 아니라 순차적으로 실행할 때보다 추론 시간이 단축된다는 것을 보여줍니다.
    
    발 키포인트 데이터 세트 생성: 저자들은 연구를 더욱 지원하기 위해 15,000개의 풋 키포인트 인스턴스로 구성된 풋 키포인트 데이터 세트를 생성했습니다.
    
    OpenPose의 구현 및 오픈 소싱: 저자들은 오픈소스인 OpenPose라는 시스템에서 접근 방식을 구현했습니다. OpenPose는 신체, 발, 손, 얼굴의 키포인트를 감지할 수 있는 최초의 실시간 시스템입니다.
    
    평가 및 분석: 저자들은 이 접근 방식에 대한 광범위한 평가를 수행하여 OpenPose가 여러 사람의 포즈를 실시간으로 효과적으로 감지하고 추정할 수 있음을 보여줍니다.
    
    공개 사용 및 OpenCV에 통합: OpenPose가 출시된 후, 사람 재식별, 리타겟팅, 인간과 컴퓨터의 상호작용 등 다양한 분야의 많은 연구자들이 OpenPose를 채택하고 있습니다. 또한 OpenPose는 OpenCV 라이브러리에 통합되어 더 넓은 컴퓨터 비전 커뮤니티에서 그 범위와 사용성을 확장하고 있습니다.
    
- Part Affinity Fields (PAFs)
    
    파트 선호도 필드(PAF)는 2D 인체 포즈 추정을 위해 OpenPose 프레임워크에 도입된 새로운 개념입니다. 이는 이미지에서 개인 간 신체 부위를 연결하는 데 사용되는 2D 벡터 필드입니다.
    
    팔다리, 몸통, 머리 등 신체 부위를 식별하는 것뿐만 아니라 이미지나 비디오 프레임에 여러 사람이 있는 시나리오에서 이러한 신체 부위를 개별 인물과 정확하게 연관시키는 것이 과제이기 때문에 PAFs 개념은 여러 사람의 포즈 감지에 매우 중요합니다. 바로 이 부분에서 PAF가 유용한 솔루션을 제공합니다.
    
    각 PAF는 특정 사지(예: 팔 또는 다리)에 해당하며 입력 이미지와 동일한 크기를 갖습니다. PAF의 요소는 팔다리의 한 부분에서 다른 부분(예: 손목에서 팔꿈치까지)을 가리키는 2D 벡터입니다. 벡터의 방향은 신체 부위의 방향을 인코딩하고 크기는 해당 팔다리의 일부가 이미지에 존재한다는 확신을 인코딩합니다.
    
    학습 과정에서 PAF와 신뢰도 맵(신체 부위 감지)은 다단계 방식으로 네트워크에 의해 공동으로 학습됩니다. 네트워크는 일련의 PAF 및 신뢰도 맵 추정치를 출력하며, 각 후속 단계는 이전 단계의 예측을 개선합니다.
    
    OpenPose는 PAF를 사용하여 여러 사람의 2D 포즈 추정에서 흔히 발생하는 개인 간 오클루전 및 겹침 문제를 처리할 수 있습니다. 파싱 단계에서는 감지된 신체 부위를 씬의 개인과 연결하여 각 인물에 대한 정확한 포즈 추정을 보장하는 데 PAF가 사용됩니다.
    
    요약하면, 파트 선호도 필드는 여러 사람의 포즈 추정에서 파트 연관성 문제를 해결하는 창의적이고 효과적인 솔루션입니다. 이미지에서 팔다리의 존재 여부뿐만 아니라 방향과 존재 가능성까지 인코딩하여 감지된 부분을 개인과 올바르게 연결할 수 있습니다.
    
- BlazePose랑 비교
    
    Google은 사람의 포즈를 추정하는 모델인 포즈넷과 무브넷에 대한 연구를 통해 포즈 추정 분야에 기여해 왔습니다.
    
    포즈넷은 주요 신체 관절의 위치를 추정하여 이미지나 동영상에서 인물의 포즈를 추정하는 데 사용할 수 있는 비전 모델입니다. 그러나 PoseNet은 특히 여러 사람이 있는 복잡하거나 혼잡한 장면에서 OpenPose보다 일반적으로 정확도가 떨어지는 것으로 알려져 있습니다.
    
    무브넷은 실시간 인체 포즈 추적을 제공하는 것을 목표로 하는 Google의 또 다른 모델입니다. 가볍고 효율적으로 설계되어 저전력 기기에서도 사용하기에 적합합니다.
    
    OpenPose와 포즈넷 또는 무브넷을 비교했을 때, 특히 여러 사람이 있는 복잡한 장면에서 OpenPose가 일반적으로 더 높은 수준의 정확도를 제공합니다. 이는 사람이 많은 장면에서도 감지된 신체 부위를 정확한 개인과 정확하게 연결하는 데 매우 효과적인 PAF(파트 선호도 필드) 덕분입니다. 그러나 OpenPose의 정확도가 높아지면 계산 요구 사항이 증가하기 때문에 저전력 장치나 표준 하드웨어의 실시간 애플리케이션에는 적합하지 않은 경우가 많습니다.
    
    또한 모델마다 서로 다른 기능과 장단점이 있다는 점도 주목할 필요가 있습니다. 예를 들어 특정 포즈, 조명 조건 또는 오클루전 수준을 다른 모델보다 더 잘 처리할 수 있습니다. 필요한 정확도 수준, 사용 가능한 컴퓨팅 리소스, 처리 중인 장면의 복잡성 등 당면한 작업의 특정 요구 사항에 따라 모델을 선택할 수 있습니다.