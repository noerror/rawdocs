# Rectangular Multi-Chart Geometry Images

[http://www.cs.cmu.edu/~kmcrane/Projects/RectangularMultiChartGeometryImages/](http://www.cs.cmu.edu/~kmcrane/Projects/RectangularMultiChartGeometryImages/)

![Untitled](Rectangular%20Multi-Chart%20Geometry%20Images%205bddf5b2692a4e18b872bd755757fca4/Untitled.png)

### 1. Introduction

이 문서에서는 특징에 따른 스무딩, 반응 확산 텍스처링, 텍스처 합성, 메시 편집, 유체 흐름, 지오데식 추적과 같은 표면에서 작업을 처리하는 새로운 방법을 설명합니다. 이러한 작업은 일반적으로 편미분 방정식(PDE)의 해로 표현됩니다. 기존 방식은 표면 위에 불규칙한 메시를 사용하여 이러한 PDE를 해결합니다. 하지만 최근 지오메트리 이미지는 이미지 연산을 통해 풀이 과정을 간소화할 수 있는 효율적인 정사각형 도메인을 제공합니다.

지오메트리 이미지의 가장 큰 단점은 표면을 단일 직사각형 차트에 매핑할 때 발생하는 높은 수준의 왜곡입니다. 이 백서에서는 이 문제를 해결하기 위해 삼각형 메쉬를 준직사각형 클러스터로 분해하는 새로운 표면 매개변수화 방식을 소개합니다. 이러한 클러스터는 매개변수 공간에서 직사각형 차트에 매핑되며, 픽셀 또는 '텍셀'이 공유 경계를 따라 정렬되도록 배치됩니다. 이 시스템을 사용하면 이미지 세트에서 이미지 처리 연산을 사용하여 표면 PDE를 위한 쉽고 효율적인 솔루션을 구현할 수 있습니다.

이 방법의 중요한 구성 요소는 매개변수화 거리를 사용하여 클러스터의 모양을 안내하는 것입니다. 이 거리는 클러스터 중심 좌표계에서 측지 거리를 근사화합니다. 이 프로세스는 T-정션과 자기 이웃 차트를 허용하므로 유연하여 매개변수화의 왜곡을 최소화할 수 있습니다.

이 백서에서는 반복 클러스터링을 사용하여 직사각형 영역에 자연스럽게 매핑되는 적합한 차트를 찾는 섹션 3의 알고리즘에 대해 설명합니다. 이 새로운 데이터 구조의 효과는 섹션 7에서 다양한 표면 처리 애플리케이션을 통해 보여집니다. 섹션 6에서는 이 방법의 왜곡 수준을 다른 대안과 비교하여 표면 PDE 처리를 위한 우수한 선택임을 입증합니다. 이 방법의 한계와 개선이 필요한 잠재적 영역은 섹션 8에서 설명합니다.

### 2. Previous Work

이 섹션에서는 서피스 파라미터화 및 서페이스의 편미분 방정식(PDE) 분야의 이전 작업에 대해 설명합니다.

서피스 매개변수화:

지오메트리 이미지, 사각형 차트, 폴리큐브 맵은 메시 분해 처리를 위해 이전 작업에서 사용되었습니다. 하지만 이러한 접근 방식은 수작업이 필요하고 복잡한 피처를 처리하는 데 어려움을 겪는 경우가 많습니다. 반면, 새로운 방법은 메시에서 차트를 자동으로 생성합니다.
이전 기법은 T-정션 없이 반정형 사각형을 생성했습니다. 이 새로운 접근 방식은 개발 가능한(반드시 평면형일 필요는 없음) 표면 세그먼트에 T-접합을 사용하여 직사각형 클러스터를 생성하므로 왜곡을 최소화하는 데 도움이 됩니다.
이전 작업에서 고려한 다른 사항으로는 곡률이 높은 영역이나 평균 가시성이 낮은 영역을 통해 클러스터 경계를 안내하는 것이 있습니다. 이에 비해 이 새로운 방법은 성장을 직사각형 모양으로 제한하여 매개변수화의 일관성을 유지하는 데 도움이 됩니다.
이전의 일부 기법은 더 매끄러운 매개변수화를 생성했지만, 이 새로운 방법은 차트 전체에 걸쳐 연속성을 제공하므로 특정 애플리케이션에 더 적합합니다.
새로운 접근 방식은 수정된 체스판 메트릭을 사용하여 K-평균 클러스터링이 직사각형을 형성하도록 강제합니다.
표면 PDE:

이전 작업에서는 임베딩 공간의 복셀 그리드로 동역학을 끌어올려 확산 공식을 도출했습니다. 하지만 이는 많은 공간을 소비하고 표면 특징을 무시한 고정된 해상도에서 작동합니다. 새로운 방법은 표면과 직사각형 이미지 배열 사이에 연속적인 매핑을 구축하는 것을 목표로 하며, 이는 새로운 기여입니다.
이전의 노력은 매개변수 왜곡의 영향을 줄이기 위해 노력했지만, 종종 특별한 점을 중심으로 반복적으로 세분화해야 했습니다. 제안된 방법은 세분화를 위해 균등하게 분포된 베이스 메시를 자동으로 형성합니다.
이전 기법은 표면의 전역 컨포멀 파라미터화에서 PDE를 처리했기 때문에 요소 크기가 크게 달라졌습니다. 새로운 알고리즘은 곡률에 민감한 방식으로 서페이스를 균일한 크기의 사변형으로 매개변수화하여 이러한 편차를 줄이고 서피스 전체에 걸쳐 계산을 균등하게 분배합니다.

### 3. Algorithm Overview

이 알고리즘은 여러 연구자가 사용한 Sorkine 등의 욕심 많은 평탄화 경계 왜곡 매개변수화와 반복적 K-평균 메시 클러스터링 알고리즘에서 영감을 얻었습니다. 이 알고리즘은 크게 두 단계로 구성됩니다:

1단계: 반복적 얼굴 클러스터링
이 단계는 클러스터를 형성하기 위해 초기 시드 얼굴 세트를 선택하는 것으로 시작됩니다. 그런 다음 이러한 시드 얼굴로부터 클러스터가 바깥쪽으로 성장합니다. 이 성장은 할당되지 않은 트라이앵글의 큰 간격이 여전히 남아 있는 동안 계속됩니다. 클러스터는 로컬 파라미터 축을 따라 방향이 변경되고 시드 면으로부터 바깥쪽으로 계속 성장합니다. 필요한 경우 새 시드 면이 삽입됩니다. 나머지 면은 가장 가까운 클러스터에 추가됩니다.

2단계: 차트 매개변수화
두 번째 단계에서는 차트의 경계를 결정합니다. 그런 다음 각 차트에 대한 로컬 매개변수화를 해결합니다.

이 프로세스는 그림 5에 나와 있습니다. 1단계에서는 반복 클러스터링과 욕심 평탄화를 사용하여 대략 직사각형 영역으로 낮은 왜곡으로 매개변수화되는 면의 클러스터를 결정합니다. 2단계에서는 각 클러스터를 텍스처 공간의 직사각형 영역으로 변환합니다. 차트 경계를 가로질러 공유되는 가장자리는 두 차트에서 동일한 수의 텍셀을 샘플링합니다. 그 결과 렌더링, 저장 및 계산에 유용한 직사각형 영역 세트가 매끄럽게 생성됩니다.

### 4. Rectangular Cluster Formation

직사각형 클러스터 형성 장에서는 메시 생성에 반복 클러스터링을 사용하는 알고리즘에 대해 설명합니다. 유클리드 거리와 방향을 사용하여 나머지 면을 클러스터에 연결하는 표준 방법과 달리, 이 접근 방식은 매개변수화와 다양한 거리 메트릭을 사용하여 직사각형 모양의 클러스터를 생성하는 것을 목표로 합니다.

4.1 매개변수화 거리

이 알고리즘은 메시 표면에서 추정된 측지 거리를 사용하여 클러스터가 직사각형 모양으로 성장하도록 유도합니다. 이를 위해 클러스터 성장 중에 사용되는 매개변수화는 측지 거리를 근사화하는 데 사용됩니다. 이방성 체스판 메트릭을 사용하여 직사각형 클러스터 모양을 권장하며, 이 메트릭은 가로 세로 비율과 방향에 따라 달라집니다. 그 결과 각 클러스터는 고유한 거리 메트릭을 갖게 됩니다.

![체스판 아래에서 성장한 고립된 클러스터 메트릭 아래에서 성장한 격리 클러스터는 매개변수화 도메인에서 사각형을 형성합니다.](Rectangular%20Multi-Chart%20Geometry%20Images%205bddf5b2692a4e18b872bd755757fca4/Untitled%201.png)

체스판 아래에서 성장한 고립된 클러스터 메트릭 아래에서 성장한 격리 클러스터는 매개변수화 도메인에서 사각형을 형성합니다.

4.2 프론티어 페이스 파라미터화

클러스터의 가장자리에 있는 면을 프론티어 면이라고 합니다. 이를 클러스터에 포함하기 전에 네 가지 포함 기준에 따라 파라미터화해야 합니다:

![경계선에 인접한 삼각형의 세 가지 경우 에 인접한 삼각형의 세 가지 경우입니다.](Rectangular%20Multi-Chart%20Geometry%20Images%205bddf5b2692a4e18b872bd755757fca4/Untitled%202.png)

경계선에 인접한 삼각형의 세 가지 경우 에 인접한 삼각형의 세 가지 경우입니다.

클러스터 중심과의 매개변수적 거리
클러스터에 기여하는 왜곡 정도
중첩 또는 "폴드 오버" 가능성
경계 부드러움에 미치는 영향
파라미터화는 프론티어 면이 클러스터 경계와 공유하는 에지 수에 따라 달라지며, 공유 에지는 1개, 2개 또는 3개가 될 수 있습니다.

4.3 후보 기준
프런티어 면이 파라미터화되면 다음 기준에 따라 평가됩니다:

시드 면까지의 매개변수화 거리: 클러스터 중심까지의 거리는 클러스터 좌표 프레임의 매개변수를 사용하여 측정됩니다.

발생된 왜곡: 다양한 왜곡 메트릭이 존재하며, 선택은 이 알고리즘에만 국한되지 않습니다. 이 절차는 매개변수화된 삼각형에 대해 늘어남과 줄어듦을 모두 불이익을 주는 메트릭을 사용하며, 매개변수화가 완벽하게 아이소메트릭일 때 최소화됩니다.

폴드오버 방지: 이 알고리즘은 프론티어 면의 파라미터화가 기존 클러스터 파라미터화와 교차하지 않도록 보장합니다. 매개변수화된 경계 가장자리의 쿼드 트리를 사용하여 교차 쿼리를 신속하게 처리합니다.

경계 평활도: 이는 경계 제약 조건을 사용하여 보장됩니다. 클러스터의 최종 경계는 다른 클러스터 또는 후보 테스트에 실패한 프론티어 면과 접하는 경계 에지의 하위 집합입니다.

이 접근 방식은 삼각형 중심점에서 거리 메트릭을 평가할 때 흔히 발생하는 들쭉날쭉하거나 톱니 모양의 경계를 생성하지 않습니다. 이 알고리즘은 케이스 2 프런티어 면에 대한 클러스터 포함을 위한 다른 세 가지 기준에 의존하여 이를 수행하므로 경계 불규칙성을 실질적으로 제거합니다.

4.4 클러스터 재조정
패치 성장을 반복할 때마다 패치가 직사각형 형태를 취하도록 2단계 정제 프로세스를 수행합니다. 여기에는 패치의 중심을 다시 잡고 방향을 재조정하는 작업이 포함됩니다.

![패치 센터링 및 방향 변경 프로세스: (a) 이전, (b) 재센터링, (c) 방향 변경.](Rectangular%20Multi-Chart%20Geometry%20Images%205bddf5b2692a4e18b872bd755757fca4/Untitled%203.png)

패치 센터링 및 방향 변경 프로세스: (a) 이전, (b) 재센터링, (c) 방향 변경.

패치 센터링: 패치에 대한 질량 중심을 계산한 다음 이를 음수화하여 패치의 중심을 맞추기 위한 오프셋으로 사용합니다.

패치 방향 재조정 및 크기 추정: 주성분 분석을 사용하여 패치를 원하는 직사각형 모양에 더 가깝게 정렬하도록 패치 방향을 재조정합니다. 삼각형의 텍스처 좌표에서 계산된 공분산 행렬의 고유 벡터가 새 좌표 프레임을 정의합니다. 이 행렬의 고유값의 비율을 비교하여 다음 반복을 위한 목표 크기를 계산할 수 있습니다.

4.5 시드 면
새로운 클러스터의 성장을 시작하는 시드 면은 잠재적 클러스터의 크기를 최대화하기 위해 신중하게 선택됩니다. 메시 경계 또는 높은 곡률 영역과 같은 피처에 인접한 면으로부터 전진하는 면이 성장합니다. 이 전진 면에 도달한 마지막 면이 새 클러스터의 시드 면으로 사용됩니다. 처음에 이 새 클러스터는 알려진 종횡비 스케일 없이 파라미터화되므로 (1,1)의 목표 크기를 사용하여 바깥쪽으로 성장합니다. 중심을 다시 잡고, 방향을 바꾸고, 종횡비를 업데이트한 후 새 클러스터는 반복적인 성장 프로세스에 참여할 수 있습니다.

4.6 종료
알고리즘에는 수렴에 대한 공식적인 증명이 포함되어 있지 않지만, 더 많은 시드 면이 추가됨에 따라 좋은 솔루션에 접근하고 안정화되는 경향이 있습니다. 현재 구현에서는 패치 사이의 간격이 작아질 때까지 시드 면이 계속 추가됩니다. 알고리즘이 완료된 후 엄격한 평활도 기준으로 인해 클러스터에 할당되지 않은 얼굴은 왜곡, 평활도 및 폴드오버 기준을 무시하고 가장 가까운 클러스터에 할당됩니다. 이 할당은 최종 외향적 클러스터 성장 단계에서 수행됩니다.

![반복 클러스터링 프로세스를 거친 후 최종 매핑을 수행하는 드래곤 모델.](Rectangular%20Multi-Chart%20Geometry%20Images%205bddf5b2692a4e18b872bd755757fca4/Untitled%204.png)

반복 클러스터링 프로세스를 거친 후 최종 매핑을 수행하는 드래곤 모델.

### 5. Chart Parameterization

최종 패치 파라미터화 프로세스의 목표는 각 패치의 파라미터 도메인을 직사각형으로 만들고 패치 간에 완벽한 텍셀 연속성을 보장하는 것입니다. 이 접근 방식은 텍스처 좌표 할당이 기본 텍셀 그리드에 대한 지식으로 수행되므로 텍스처 해상도에 따라 달라집니다.

5.1 차트 경계 및 고정 버텍스

패치 간에 완벽한 텍스셀 연속성을 얻으려면 차트 내부 및 차트 간 공유 경계 세그먼트에 이산 텍스셀 길이를 할당해야 합니다. 경계 세그먼트를 시작하거나 끝내는 정점은 하나에서 여러 개의 패치가 모이는 이음새의 시작 부분에 위치한 정점인 고정 정점과 직사각형 매개변수 도메인의 네 모서리 중 하나에 배치되는 코너 정점의 두 가지 범주로 나뉩니다.

5.2 패치 크기 및 모서리 결정

각 패치에 대해 경계를 시계 반대 방향으로 이동하여 고정 정점과 모서리 정점을 정렬된 목록으로 수집합니다. 그런 다음 각 경계 세그먼트에 대한 텍셀 길이가 할당됩니다. 이미 방문한 패치와 공유된 경계 세그먼트의 경우 텍셀 길이는 인접한 패치의 해당 세그먼트 길이와 같습니다. 다른 경계 세그먼트 길이는 세그먼트의 3D 호 길이에 사용자가 지정한 파라미터 γ를 곱하여 텍셀 길이로 변환하여 계산합니다.

패치의 코너 정점은 먼저 패치 경계에 있는 정점을 파라미터화의 왼쪽 하단 모서리로 선택하여 선택합니다. 그런 다음 정렬된 목록을 순회하여 이 정점을 포함하는 세그먼트를 찾습니다. 나머지 세 모서리 정점이 목록에 추가되고 패치의 텍셀 너비와 높이가 계산됩니다.

5.3 패치 매개변수화 및 교차 에지

모든 패치에 대해 텍셀 크기, 경계 세그먼트 길이, 모서리 위치가 계산되면 각 패치를 직사각형으로 매개변수화할 수 있습니다. 내부 정점은 메시의 유효한 임베딩을 보장하는 선형 스프링 모델을 사용하여 해결됩니다. 파라미터 영역에서 변질된 트라이앵글이 형성되는 것을 방지하기 위해 패치 경계에 있지 않지만 끝 꼭지점이 패치 경계에 있는 에지(교차 에지라고 함)에 대한 특별한 처리가 필요합니다. 필요한 경우 퇴화를 방지하기 위해 로컬 리메싱이 수행됩니다.

5.4 파라미터화 최적화

파라미터화를 향상시키기 위해 스트레치 메트릭을 사용한 비선형 최적화가 적용됩니다. 최적화 프로세스에는 빠른 완화 방식을 사용하고 한 번에 하나씩 정점을 방문하고 공액 경사 하강을 수행하여 위치를 최적화함으로써 스트레치 오차를 더욱 최소화하는 것이 포함됩니다. 패치 간 경계에 있는 고정되지 않은 정점은 1 자유도를 사용하여 최적화할 수 있습니다.

### 6. Results and Discussion

각 패치를 강제로 완벽한 직사각형으로 만드는 과정은 자연스러운 차트 경계를 허용하는 알고리즘에 비해 추가적인 왜곡을 유발합니다. 그러나 이러한 왜곡은 직사각형 차트의 높은 패킹 효율로 인해 상쇄됩니다.

![양방향 차트 이미지 필터로 구현된 특징 보존 스무딩을 여러 번 반복한 후의 드래곤. 그래픽 하드웨어(GeForce 7800)에서 초당 약 7회의 반복으로 1.4M 삼각형 드래곤에 대한 스무딩을 수행했습니다.](Rectangular%20Multi-Chart%20Geometry%20Images%205bddf5b2692a4e18b872bd755757fca4/Untitled%205.png)

양방향 차트 이미지 필터로 구현된 특징 보존 스무딩을 여러 번 반복한 후의 드래곤. 그래픽 하드웨어(GeForce 7800)에서 초당 약 7회의 반복으로 1.4M 삼각형 드래곤에 대한 스무딩을 수행했습니다.

스트레치 효율성(각 표면 패치의 반전된 스트레치의 면적 가중 평균)을 지표로 사용하면 직사각형 다중 차트 기하형상 이미지(RMCGI)는 자연스러운 차트 경계를 허용하는 다중 차트 기하형상 이미지에 비해 추가적인 왜곡이 발생하는 것으로 나타났습니다. 그럼에도 불구하고 직사각형 차트의 패킹 효율은 각 차트에 자체 텍스처 맵이 있는 경우 100%에 달할 정도로 높습니다. 그 결과 전체적인 텍스처 효율성이 경쟁력이 있습니다.

표면 클러스터는 2.0의 스트레치 바운드를 사용하여 성장했으며, RMCGI 패치의 왜곡이 경계 근처에서 정점에 이르는 것을 관찰할 수 있었습니다. 이는 직사각형 클러스터에 스트래글러 트라이앵글이 최종적으로 추가되었기 때문입니다.

모양 제약 K-평균 클러스터링 알고리즘의 성능은 메시 크기와 모양의 복잡한 상호 작용에 의해 영향을 받습니다. 매개변수화는 곡률 분포와 테셀레이션 빈도에 영향을 받는 클러스터 경계의 복잡성에 의해 변조되는 차트 수의 함수에 더 명확하게 영향을 받습니다. RMCGI 접근 방식은 순수한 매개변수화 방법보다는 느리지만 지오메트리 이미지 구조를 생성하는 다른 일반 리테셀레이션보다는 빠릅니다.

이 접근법의 한계는 테셀레이션이 불규칙한 저다각형 메시에서 들쭉날쭉한 경계를 생성한다는 점입니다. 이 문제는 삼각형 분할 방식을 구현하여 차트 경계를 매끄럽게 하고 매개변수 왜곡을 줄임으로써 개선할 수 있습니다. 또한, 경계 근처의 연속성은 메시와 일치하는 매끄러운 표면에서 텍셀당 메트릭을 계산하여 개선할 수 있습니다.

각 차트를 자체 텍스처에 저장하면 텍스처 아틀라스에서 차트 사이의 간격으로 인한 텍스처 메모리 낭비를 방지할 수 있으므로 직사각형 차트의 메모리 효율성이 향상될 수 있습니다. 현재 그래픽 카드에서는 16개의 텍스처만 동시에 바인딩할 수 있다는 제한이 있지만, 향후 하드웨어가 발전함에 따라 이 제한은 변경될 것으로 예상됩니다.

### 7. Applications

제안된 접근 방식을 사용하여 여러 표면 처리 애플리케이션이 구현되었으며, 모두 GPU의 조각 파이프라인을 활용하여 단일 텍스처의 직사각형 영역에 저장된 데이터를 컨볼브합니다.

표면의 실시간 유체 흐름: 이 애플리케이션은 표면의 유체 흐름에 대한 비압축성 나비에-스토크스 방정식을 풀며, 스탬의 안정 유체 방법[Sta99]과 [Har04]에 자세히 설명된 GPU 구현을 따릅니다. 206,632개의 셀이 있는 시뮬레이션 그리드에서 20fps에 이르는 성능을 제공합니다. 나머지 왜곡은 곡선 좌표의 연산자[Sta03]를 사용하여 보정할 수 있습니다.

텍스처 합성: 심리스 파라미터화는 표면 위에 연속적인 텍스처를 합성하는 데 유용합니다. 스탠포드 버니의 주름을 생성하는 데는 위트킨과 카스[WK91]의 방법이 사용되었습니다. 왜곡은 여전히 결과에 영향을 미치므로 왜곡이 적은 차트 이미지를 생성하는 것이 중요하다는 점을 강조합니다.

측지학: 표면 위의 거리 필드는 아이코널 PDE |∇T| = 1을 풀고 단일 소스 정점에서 T = 0으로 설정하여 얻습니다. 모든 정점에서 소스까지의 측지 경로는 T에 대한 간단한 내리막 흐름으로 구할 수 있습니다. 빠른 행진 방법 [Set96]은 정적 격자에서 아이코널 방정식에 대한 근사 해를 제공합니다. RMCGI의 접근 방식을 사용하면 메시 [NK02]에서 전면의 원형 모양을 더 잘 보존할 수 있습니다.

쿼드 메시: 지오메트리 이미지는 텍스처에 규칙적으로 테셀레이션된 메시를 암시적으로 인코딩합니다. 그림 9는 토끼의 직사각형 패치 표현을 재구성하여 캣멀-클락 표면으로 렌더링한 쿼드 메시를 보여줍니다.

스무딩: 특징 보존 스무딩을 위해 양방향 필터링[TM98]이 구현됩니다. 차트 경계를 따라 매끄러운 스무딩은 다른 매개변수 공간 스무딩 방법[ST04]에 비해 구현이 더 간단한 경계 복사를 통해 이루어집니다. 1.4M 삼각형 드래곤 모델의 경우, 이 접근 방식은 초당 약 7회의 스무딩 반복을 수행했습니다.

### 8. Conclusion

다면체 표면에서 저왜곡 직사각형 차트를 생성하는 혁신적인 방법을 성공적으로 시연했습니다. 이 차트는 텍스처 이미지 처리를 위해 설계된 그래픽 하드웨어의 효율적인 사용을 용이하게 하며, 저왜곡 매핑은 그래픽 하드웨어가 표면 신호를 처리할 수 있는 수단을 제공합니다.

직사각형 차트 이미지에서 이미지 연산자로 서피스 PDE 애플리케이션을 다양하게 구현한 결과 이 맵의 효율성이 강조되었습니다. 단일 지오메트리 이미지[GGH02]에서 이러한 연산을 수행하면 왜곡 아티팩트가 더 커지고, 다중 차트 지오메트리 이미지[SWG∗03]의 사각형이 아닌 차트에서 정확하고 효율적으로 구현하는 것은 더 어렵습니다.

C0 연속성 및 다소 늘어난 저장 공간과 같은 타협점이 있지만, 이는 서피스 차트 이미지 데이터 구조의 효율성과 단순성으로 인해 정당화됩니다. 이 툴은 GPU 가속 그래픽에 효과와 사실감을 더해 향후 애플리케이션에서 잠재적인 유용성을 보여줍니다.