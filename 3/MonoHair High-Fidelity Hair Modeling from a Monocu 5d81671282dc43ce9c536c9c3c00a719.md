# MonoHair: High-Fidelity Hair Modeling from a Monocular Video

[https://arxiv.org/abs/2403.18356](https://arxiv.org/abs/2403.18356)

[https://keyuwu-cs.github.io/MonoHair/](https://keyuwu-cs.github.io/MonoHair/)

- 27 Mar 2024

## 1. Introduction

머리카락은 디지털 인간의 중요한 특징 중 하나이며, 정교한 3D 머리카락 모델은 현실감을 크게 향상시킬 수 있다. 하지만 머리카락 모델링은 매우 복잡한 작업으로, 각각의 머리카락 가닥이 다양한 방식으로 뒤틀리고 회전하는 독특한 기하학적 형태를 가지고 있기 때문에 어려움을 겪는다. 기존의 컴퓨터 그래픽에서는 3D 가닥 형태로 머리카락을 모델링하여 렌더링과 시뮬레이션을 용이하게 하고자 했으나, 이러한 방식은 머리카락의 내부 구조를 제대로 포착하지 못하고 외부만을 재구성하는 한계를 가지고 있었다.

![ 우리는 단안 비디오에서 3D 머리카락 모델링을 위한 일반적인 프레임워크를 제안한다 (a). 이는 볼륨 기반 표현으로 생성된 거친 원시 기하학으로 시작한다. 이후, 원시 기하학에서 머리의 외부 기하학을 추출하고 추론된 내부 구조와 결합하여 완전한 3D 머리카락 기하학을 얻는다 (b). 마지막으로, 대응하는 3D 머리카락 모델을 가닥 수준에서 복원한다. 우리의 방법은 다양한 헤어스타일을 재구성할 수 있으며 고품질의 머리카락 모델링 결과를 달성한다 (c).](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled.png)

 우리는 단안 비디오에서 3D 머리카락 모델링을 위한 일반적인 프레임워크를 제안한다 (a). 이는 볼륨 기반 표현으로 생성된 거친 원시 기하학으로 시작한다. 이후, 원시 기하학에서 머리의 외부 기하학을 추출하고 추론된 내부 구조와 결합하여 완전한 3D 머리카락 기하학을 얻는다 (b). 마지막으로, 대응하는 3D 머리카락 모델을 가닥 수준에서 복원한다. 우리의 방법은 다양한 헤어스타일을 재구성할 수 있으며 고품질의 머리카락 모델링 결과를 달성한다 (c).

이 문제를 해결하기 위해 여러 다중 뷰 기술이 제안되었지만, 대부분은 기존 데이터셋에 의존하여 내부 구조를 추론하면서 실험 설정을 단순화하려고 했다. 그러나 이러한 방식은 머리카락 재구성의 품질을 저하시킬 수 있다. 최근에는 일반 비디오에서 촬영된 영상을 활용하여 높은 품질의 재구성을 시도하는 방법이 등장했으나, 특정한 헤어스타일, 특히 곱슬머리와 같이 데이터셋에 잘 포함되지 않은 스타일에서는 과도하게 부드러운 재구성 결과를 초래하는 문제가 있었다.

본 연구에서는 단안 비디오를 활용한 머리카락 재구성의 새로운 방법을 제안한다. 우리의 접근 방식은 Neural Radiance Field(NeRF)를 사용하여 거친 기하학을 초기화하고, 이를 기반으로 다양한 복잡한 헤어스타일을 표현할 수 있는 밀집된 원시 포인트 클라우드를 생성하는 것으로 시작한다. 이후 PMVO를 도입하여 입력 비디오 프레임의 풍부한 정보를 활용해 고품질의 머리카락 외부 구조를 재구성한다. 마지막으로, 2D 헤어 정보를 입력으로 사용하여 누락된 내부 구조를 추론하는 데이터 기반 다중 뷰 방법을 채택하여, 훈련 데이터와 실제 테스트 데이터 간의 도메인 간극을 효과적으로 줄여 정확하고 신뢰할 수 있는 내부 구조 추론을 가능하게 한다.

결론적으로, 본 연구의 주요 기여는 다음과 같다. 첫째, 단안 비디오로부터 다양한 헤어스타일을 정교하게 재구성할 수 있는 경량의 일반적인 프레임워크를 제안한다. 둘째, 거친 기하학에서 고품질의 외부 구조를 추출하는 새로운 프로세스를 제시하며, 이를 통해 다중 뷰 최적화를 수행한다. 셋째, 합성 데이터와 실제 데이터 간의 간극을 줄여주는 단방향 스트랜드 맵을 도입하여 내부 구조 추론의 신뢰성을 높인다.

## 2. Related work

머리카락 모델링과 관련된 기존 연구는 크게 암묵적 표현을 사용하는 방법, 최적화 기반 재구성 방법, 그리고 데이터 프라이어를 활용한 방법으로 나눌 수 있다.

최근에는 NeRF와 같은 암묵적 표현을 활용한 3D 머리카락 모델링이 주목받고 있다. NeRF와 암묵적 표면을 사용하면 정밀한 카메라 보정 없이도 고품질의 결과를 얻을 수 있으며, 머리카락을 포함한 다양한 구조를 모델링하는 데 유연하게 사용할 수 있다. 예를 들어, 여러 연구들은 다중 뷰 이미지나 단안 비디오에서 볼륨 기반 표현을 사용하여 머리카락을 암묵적으로 포착하는 방식을 채택하고 있다. 하지만 이러한 방법들이 생성하는 머리카락 모델은 고품질의 3D 가닥 기반 재구성 기준에는 미치지 못한다. 그럼에도 불구하고, 이러한 표현 방식은 초기 거친 기하학을 제공하는 데 유용하다.

최적화 기반 머리카락 재구성 연구는 초기에는 가닥 기반 표현에 중점을 두었다. Paris et al.의 선구적인 연구를 시작으로, 다양한 최적화 기반 방법들이 등장했다. 예를 들어, Luo et al.은 머리카락 메쉬를 최적화하여 세밀한 디테일을 포함시키는 방법을 제안했다. 다른 연구들은 다중 뷰 스테레오(MVS) 기술을 사용하여 포인트 클라우드를 생성하고, 이를 최적화하여 완전한 머리카락 모델을 만드는 방법을 사용했다. 그러나 이러한 방법들은 다중 뷰 캘리브레이션과 특정 조명 조건이 필요하여 일반 사용자에게는 실용적이지 않으며, 재구성된 머리카락 모델이 내부 구조를 포함하지 못해 그 적용 범위가 제한된다.

USC-HairSalon 데이터셋이 공개된 이후, 데이터 프라이어를 활용한 3D 머리카락 재구성이 널리 연구되기 시작했다. 데이터 기반 방법들은 이미지에서 보이는 형태와 일치하도록 데이터베이스에서 헤어스타일을 선택하고 수정하는 방식을 사용한다. 합성 데이터를 사용하여 신경망을 훈련하고 이를 통해 단일 이미지에서 가닥 기반 머리카락 모델을 생성하는 방법들도 개발되었다. 이러한 딥러닝 방법들은 몇몇 다른 각도의 이미지를 입력으로 사용하여도 잘 작동하지만, 데이터베이스에 없는 헤어스타일을 정확하게 재구성하는 데 어려움을 겪는다. 또한, 합성 데이터와 실제 데이터 간의 도메인 차이로 인해 실제 데이터에 적용할 때 그 효과가 감소하는 문제가 있다.

최근 연구에서는 다양한 기술을 통합하여 이러한 문제를 완화하는 새로운 방법을 제안했다. 이 방법은 합성 데이터를 사용하는 문제를 해결하고 인상적인 결과를 도출하지만, 데이터 프라이어에 크게 의존하여 곱슬머리와 같은 헤어스타일을 재구성하는 데는 여전히 한계가 있다.

## 3. Method

![우리의 3D 머리카락 재구성 파이프라인 개요.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%201.png)

우리의 3D 머리카락 재구성 파이프라인 개요.

MonoHair의 파이프라인은 단안 비디오로부터 머리카락을 재구성하는 과정을 단계별로 설명한다. 먼저, 단안 비디오에서 균일하게 샘플링된 이미지 집합을 사용하여 NeRF를 통해 장면을 재구성한다. 이를 통해 머리카락 영역을 나타내는 거친 포인트 클라우드(Praw)를 생성하지만, 이는 매우 노이즈가 많다. 우리는 이 Praw를 기반으로 정확한 외부 레이어(Pout)를 재구성하고, 신뢰할 수 있는 내부 구조(Pin)를 추론하여 최종적으로 머리카락 가닥을 생성한다.

![원시 기하학에서 추출된 라인 맵 시각화.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%202.png)

원시 기하학에서 추출된 라인 맵 시각화.

PMVO(Patch-based Multi-View Optimization)는 이미지 정보를 활용하여 거친 포인트 클라우드를 정제하고, 각 포인트에 3D 헤어 성장 방향을 부여하여 외부 구조를 명확하게 만들어준다. 이 과정에서 3D 위치와 방향을 가진 3D 라인 맵을 생성하여 머리카락의 외부 영역을 구조적으로 표현하고, 이를 기반으로 일관성 있고 고품질의 2D 머리카락 구조를 생성한다.

다음으로, 우리는 기존의 DeepMVSHair 네트워크를 개선한 DeepMVSHair*을 사용하여 외부 구조로부터 머리카락의 복잡한 내부 구조를 추론한다. 이 네트워크는 합성 3D 머리카락 데이터베이스에서 사전 훈련되었으며, 외부 구조로부터 파생된 2D 비방향성 스트랜드 맵을 입력으로 받아 내부 구조를 추론한다. 이 과정에서 우리는 데이터 프라이어와의 도메인 차이를 줄이기 위해 2D 비방향성 스트랜드 맵을 사용한다.

![패치 기반 다중 뷰 최적화의 개략도.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%203.png)

패치 기반 다중 뷰 최적화의 개략도.

![다양한 2D 머리카락 성장 방향 맵의 시각화. (a) 인물 사진. (b) [13]에서 보고된 방향 맵. (c) 렌더링된 스트랜드 맵. (d) 렌더링된 비방향성 스트랜드 맵.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%204.png)

다양한 2D 머리카락 성장 방향 맵의 시각화. (a) 인물 사진. (b) [13]에서 보고된 방향 맵. (c) 렌더링된 스트랜드 맵. (d) 렌더링된 비방향성 스트랜드 맵.

마지막으로, 스트랜드 생성 모듈은 재구성된 외부 레이어(Pout)와 추론된 내부 구조(Pin)를 결합하여 최종 머리카락 가닥(S)을 생성한다. 이 과정은 외부와 내부 구조를 통합하여 완전한 3D 머리카락 모델을 만드는 단계로, Pout와 Pin을 결합하여 고해상도의 3D 방향 필드를 생성하고, 이를 기반으로 긴 가닥을 연결하여 최종 모델을 완성한다.

PMVO는 다중 뷰 이미지 정보를 통합하여 3D 라인 맵을 생성하는 과정에서 노이즈를 제거하고 머리카락의 세밀한 구조를 보존한다. 이를 위해, NeRF에서 추출한 거친 포인트 클라우드를 초기화하고, 각 포인트에 대해 최적의 3D 라인을 찾는 비용 함수를 최소화하는 방향으로 최적화한다. 이 과정에서 2D 방향 맵, 신뢰도 맵, 깊이 맵을 사용하여 각 포인트의 가시성을 평가하고, 이를 기반으로 3D 라인을 추출한다.

내부 구조를 추론하기 위해서는 DeepMVSHair*을 사용하여 외부 구조로부터 16개의 고정된 합성 뷰를 생성하고, 이를 기반으로 2D 비방향성 스트랜드 맵과 깊이 맵을 렌더링하여 내부 구조를 추론한다. 이 방법은 합성 데이터와의 일관성을 유지하면서도 이미지 품질, 시야각, 가림 현상 등의 문제를 해결한다.

최종적으로, 외부와 내부 구조를 통합하여 완전한 3D 스트랜드 모델을 생성하는 과정에서, 내부 구조의 포인트를 선택적으로 통합하여 외부 구조의 세부 사항을 보존하면서 전체 머리카락 기하학을 완성한다. 이를 통해 고품질의 3D 머리카락 모델을 생성할 수 있다.

## 4. Evaluation

![Neural Haircut [30]과의 질적 비교. Neural Haircut은 특히 곱슬머리와 같은 복잡한 헤어스타일을 재구성하는 능력이 제한적이다(재구성 결과는 모두 그들의 논문에서 가져옴). 반면, 우리의 재구성 결과는 이미지에서 더 많은 디테일을 유지할 수 있다.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%205.png)

Neural Haircut [30]과의 질적 비교. Neural Haircut은 특히 곱슬머리와 같은 복잡한 헤어스타일을 재구성하는 능력이 제한적이다(재구성 결과는 모두 그들의 논문에서 가져옴). 반면, 우리의 재구성 결과는 이미지에서 더 많은 디테일을 유지할 수 있다.

우리는 개선된 DeepMVSHair* 모델을 USCHairSalon 데이터셋으로 훈련하고, 합성 데이터와 실제 데이터로 방법을 평가하였다. USCHairSalon 데이터셋은 343개의 헤어스타일을 포함하고 있으며, 이를 증강하여 총 2,744개의 스트랜드 모델을 생성했다. 평가에는 정량적, 정성적 비교가 포함되었으며, 이를 통해 제안된 방법의 성능을 입증하였다. 특히, 합성 데이터와 H3DS 데이터셋, 그리고 실제 단안 비디오 캡처를 사용하여 평가를 수행하였다.

![Instant-NGP [21] 및 NeuS [32]와의 질적 비교. 이러한 볼륨 기반 접근 방식은 거친 머리카락 기하학만을 생성할 수 있다. 우리는 또 다른 초기화 방법(NeuS-PMVO)과의 결과도 비교했다. 유사한 결과를 도출하지만, NeuS를 사용하여 거친 기하학을 초기화하면 세밀한 디테일이 흐려지는 경향이 있다.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%206.png)

Instant-NGP [21] 및 NeuS [32]와의 질적 비교. 이러한 볼륨 기반 접근 방식은 거친 머리카락 기하학만을 생성할 수 있다. 우리는 또 다른 초기화 방법(NeuS-PMVO)과의 결과도 비교했다. 유사한 결과를 도출하지만, NeuS를 사용하여 거친 기하학을 초기화하면 세밀한 디테일이 흐려지는 경향이 있다.

![ H3DS [25] 데이터셋에서 DeepMVSHair [13]과의 질적 비교. 이미지에서 추출된 2D 방향 맵이 다른 뷰에서 일관성이 없을 수 있어, 그들의 결과는 일부 기하학을 잃는다. 우리의 개선된 DeepMVSHair*는 이 문제를 효과적으로 해결하지만, 데이터 프라이어 한계로 인해 여전히 일부 디테일이 손실된다. 반면, 우리의 방법은 이러한 한계에서 벗어나 더 풍부한 디테일과 함께 높은 품질의 결과를 달성한다.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%207.png)

 H3DS [25] 데이터셋에서 DeepMVSHair [13]과의 질적 비교. 이미지에서 추출된 2D 방향 맵이 다른 뷰에서 일관성이 없을 수 있어, 그들의 결과는 일부 기하학을 잃는다. 우리의 개선된 DeepMVSHair*는 이 문제를 효과적으로 해결하지만, 데이터 프라이어 한계로 인해 여전히 일부 디테일이 손실된다. 반면, 우리의 방법은 이러한 한계에서 벗어나 더 풍부한 디테일과 함께 높은 품질의 결과를 달성한다.

![단안 비디오를 주어졌을 때, 우리의 방법은 복잡한 곱슬머리를 포함하여 고품질의 스트랜드 모델을 재구성할 수 있다. 더 많은 결과는 보충 자료를 참조 바란다.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%208.png)

단안 비디오를 주어졌을 때, 우리의 방법은 복잡한 곱슬머리를 포함하여 고품질의 스트랜드 모델을 재구성할 수 있다. 더 많은 결과는 보충 자료를 참조 바란다.

### **4.1. Comparison**

비교 대상에는 여러 최첨단 머리카락 모델링 방법이 포함되었다. 여기에는 단안 비디오 기반의 Neural Haircut, 드문 다중 뷰 이미지를 사용하는 DeepMVSHair, SDF 표현을 사용하는 NeuS, 그리고 소설 뷰 합성을 위해 일반적으로 사용되는 Instant-NGP 등이 포함되었다. 우리는 이들 방법과 함께 우리의 방법을 비교하였고, NeuS-PMVO와 같은 변형도 포함하여 비교하였다.

정성적 비교에서 Neural Haircut은 데이터 프라이어 제약으로 인해 곱슬머리를 효과적으로 표현하지 못하는 반면, 우리의 방법은 곱슬머리에서도 더 견고한 결과를 보여주었다. 또한, 합성 데이터셋에서의 정량적 비교에서도 우리의 방법이 가장 높은 정밀도와 F-스코어를 기록하였다. 재구성 효율성 측면에서도 Neural Haircut이 3-4일이 소요되는 반면, 우리의 방법은 4-6시간 만에 완료되었다.

Instant-NGP와 NeuS와의 비교에서, 이들 방법은 거친 머리카락 기하학만을 생성할 수 있었으나, 우리의 방법은 보다 견고하고 정확한 결과를 제공하였다. NeRF 기반 방법은 노이즈가 많았고, NeuS는 더 깨끗한 3D 기하학을 얻는 데 효과적이었다. 그러나 NeuS-PMVO는 세부 사항에서 더 부드러운 결과를 보여주었기에 초기 거친 기하학을 Instant-NGP로 초기화하였다.

DeepMVSHair와의 정량적 및 정성적 비교에서는, DeepMVSHair가 그럴듯한 기하학을 생성할 수 있었으나, 입력 2D 방향 맵의 품질에 크게 영향을 받았다. 반면, 3D 라인 맵에서 파생된 비방향성 스트랜드 맵을 사용하는 우리의 개선된 DeepMVSHair*는 더 나은 결과를 도출할 수 있었다. 그러나 학습 방법이 데이터 프라이어 분포에 의해 제한되므로, 결과는 세부 사항에서 입력 이미지와 차이가 있을 수 있다. 우리의 방법은 고품질의 외부 구조를 합성하고 데이터 프라이어는 보이지 않는 내부 기하학에만 적용하여 우수한 결과를 얻었다.

### **4.2. Ablation Study**

각 구성 요소의 성능을 평가하기 위해 실제 데이터와 합성 데이터에서 소거 연구를 수행하였다. PMVO가 없을 경우, 카메라 매개 변수 오류로 인해 많은 머리카락 포인트가 노이즈로 제거되어 일부 머리카락 가닥이 손실된다. DeepMVSHair*를 적용하지 않을 경우, 내부 구조가 부족하여 고립된 세그먼트로 이루어진 쉘 형태로 나타난다. 추가적인 소거 연구는 보충 자료를 참조하기 바란다.

## 5. Conclusion and Discussion

![우리의 방법의 각 주요 구성 요소의 질적 평가. PMVO는 고품질의 외부 머리카락 기하학을 생성하는 데 도움을 준다. DeepMVSHair*는 내부 기하학을 추론하여 완전한 머리카락 기하학을 얻는 데 도움을 준다.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%209.png)

우리의 방법의 각 주요 구성 요소의 질적 평가. PMVO는 고품질의 외부 머리카락 기하학을 생성하는 데 도움을 준다. DeepMVSHair*는 내부 기하학을 추론하여 완전한 머리카락 기하학을 얻는 데 도움을 준다.

![ 우리의 방법의 주요 한계는 심한 교차와 가림이 있는 경우 연결 관계가 부정확할 수 있다는 점이다.](MonoHair%20High-Fidelity%20Hair%20Modeling%20from%20a%20Monocu%205d81671282dc43ce9c536c9c3c00a719/Untitled%2010.png)

 우리의 방법의 주요 한계는 심한 교차와 가림이 있는 경우 연결 관계가 부정확할 수 있다는 점이다.

이 논문에서는 기존의 다중 뷰 기반 머리카락 재구성 파이프라인을 재고하고, 대부분의 방법들이 데이터 프라이어를 전체 헤어스타일 재구성에 직접 적용하는 문제를 지적했다. 이는 훈련 데이터베이스의 다양성에 크게 제한을 받는다. 이러한 한계를 극복하기 위해, 우리는 MonoHair라는 일반적인 프레임워크를 제안했다. 이 프레임워크는 머리카락 모델링을 외부 기하학과 내부 기하학으로 이분화하여 접근한다.

MonoHair는 다중 뷰 이미지를 사용하여 데이터 프라이어에 의존하지 않고 외부 머리카락 구조를 추출한 후, 추출된 고품질 외부 머리카락 구조와 학습된 데이터 프라이어를 결합하여 내부 구조를 추론한다. 이러한 접근 방식은 다양한 실험을 통해 입증되었으며, [21]에서 제안한 방법으로 생성된 거친 기하학과 제안된 PMVO 및 내부 추론 모듈을 결합하여 높은 충실도의 스트랜드 모델을 재구성할 수 있음을 보여주었다. 특히, 곱슬머리와 같은 다양한 헤어스타일에 대해서도 우수한 성능을 발휘했다.

우리 방법의 주요 한계는, 교차와 가림이 심한 경우 복잡한 헤어스타일(예: 땋은 머리)에서 연결 관계가 부정확할 수 있다는 점이다. 이는 고품질의 머리카락 외부 구조를 재구성하는 데 성공하더라도 내부 기하학이 여전히 데이터 프라이어에 의존하기 때문이다. 이러한 한계를 극복하기 위해서는 데이터셋을 확장하여 더 다양한 헤어스타일을 포함하거나, CT2Hair [29]와 유사한 컴퓨터 단층 촬영을 사용하여 내부 구조를 직접 재구성하는 방법을 고려할 수 있다.

앞으로의 연구 방향으로는 더욱 다양한 헤어스타일을 포괄하는 대규모 데이터셋의 구축과, 데이터 프라이어의 의존성을 줄이기 위한 새로운 기술 개발이 필요하다. 이를 통해, 더 복잡하고 정교한 3D 머리카락 모델을 실현할 수 있을 것이다. MonoHair는 이러한 방향에서 중요한 첫 걸음을 내디뎠으며, 향후 연구에 있어 귀중한 기반이 될 것이다.