# Graphics Capsule: Learning Hierarchical 3D Face Representations from 2D Images

*이 논문에서는 비지도 얼굴 부분 검색 및 분할을 위해 훈련된 컨볼루션 신경망인 IGC-Net(해석 가능한 그래픽 캡슐 네트워크)에 대해 설명합니다. 이 네트워크는 얼굴 이미지를 의미적으로 일관된 6개의 부분으로 분해하여 다양한 조명과 포즈에서 캡처된 얼굴의 3D 표현을 제공합니다. IGC-Net은 크로스뷰 얼굴 인식 작업에서 2D 자동 인코더보다 뛰어난 성능을 발휘하여 얼굴 인식에서 형태보다 알베도가 중요하다는 것을 입증합니다. 또한 비지도 얼굴 분할 작업에서도 다른 방법보다 성능이 뛰어납니다. 제거 연구는 의미 있는 얼굴 부분을 발견하기 위한 네트워크의 원핫 연산과 의미적 제약의 중요성을 강조합니다. IGC-Net은 인식, 분할, 포즈 추정을 포함한 얼굴 분석 작업에 잠재적인 응용 가능성을 제공합니다.*

[https://openaccess.thecvf.com/content/CVPR2023/papers/Yu_Graphics_Capsule_Learning_Hierarchical_3D_Face_Representations_From_2D_Images_CVPR_2023_paper.pdf](https://openaccess.thecvf.com/content/CVPR2023/papers/Yu_Graphics_Capsule_Learning_Hierarchical_3D_Face_Representations_From_2D_Images_CVPR_2023_paper.pdf)

1. Introduction

이 글에서는 인간과 유사한 방식으로 이미지를 이해하고 해석할 수 있는 인공 지능 시스템을 구축하기 위한 새로운 접근 방식에 대해 설명합니다.

인간은 한 번도 본 적이 없는 물체를 보고 그 부분과 관계, 그리고 그것들이 어떻게 결합하여 전체를 이루는지 이해할 수 있습니다. 이러한 능력은 사물에 대한 계층적 구조적 설명을 구축하는 시각 처리와 관련이 있습니다. 계층적 설명이란 사물을 하나의 개체로만 보는 것이 아니라 그 부분과 그 부분들이 어떻게 연관되어 있는지를 이해하는 것을 의미합니다.

예를 들어, 자동차를 보면 바퀴, 창문, 문 등을 인식하고 이러한 부품이 서로 맞물려 전체 자동차를 구성한다는 것을 이해합니다. 특정 유형의 자동차를 본 적이 없더라도 이러한 구조를 알 수 있습니다.

연구자들은 AI 시스템에도 이와 유사한 능력을 부여하기 위해 노력해 왔습니다. 초기 연구에서는 사물의 계층 구조를 이해하고 각 개체를 구체적이고 이해하기 쉬운 매개변수로 설명하도록 설계된 신경망의 일종인 캡슐 네트워크를 사용했습니다. 이러한 방법은 대규모 이미지 세트를 가져와 숫자나 얼굴과 같은 부분으로 분해하여 네트워크가 사물을 이해하는 방식에 대한 인사이트를 제공할 수 있습니다. 하지만 이러한 방법은 평면 이미지와 같이 2D로 된 물체를 이해하는 데 제한이 있었습니다.

이 논문의 저자들은 사람처럼 3D로 사물을 이해할 수 있는 새로운 방법을 제안합니다. 저자들은 이 방법을 역 그래픽 캡슐 네트워크(IGC-Net)라고 부릅니다. IGC-Net은 컴퓨터 그래픽으로 정의된 그래픽 캡슐을 사용하여 레이블이 지정되지 않은 대규모 이미지 세트에서 물체를 3D로 표현하는 방법을 학습하는 방식으로 작동합니다.

이 과정에는 입력 이미지를 전역 모양과 알베도(밝기) 임베딩으로 인코딩하는 작업이 포함됩니다. 이렇게 인코딩된 이미지는 분해 모듈로 전송되어 부품 수준의 그래픽 캡슐로 분해됩니다. 그런 다음 이 캡슐을 디코딩하여 부품에 대한 명시적인 3D 설명을 얻고, 이를 깊이별로 조합하여 전체 오브젝트 표현을 생성합니다. 마지막으로 이러한 3D 오브젝트에 조명을 비추고, 포즈를 취하고, 입력 이미지와 일치하도록 렌더링합니다.

이 시스템은 비슷한 구조와 다양한 모양으로 인해 복잡한 피사체인 사람의 얼굴에 적용되었습니다. IGC-Net은 다양한 조명 조건과 포즈에서 캡처한 얼굴의 계층 구조를 구축하는 데 성공했습니다. 또한 이 시스템은 발견된 부분의 실루엣을 세그먼트 맵으로 사용하는 비지도 얼굴 분할 작업에서 테스트되었습니다.

요약하자면, 이 논문은 사람과 유사한 방식으로 이미지를 이해할 수 있는 새로운 AI 시스템에 관한 것으로, 물체의 부분과 3D 공간에서 서로 어떻게 어울리는지를 이해하는 데 중점을 두고 있습니다. 저자는 이 시스템이 사람의 얼굴을 이해하는 데 성공적으로 적용될 수 있음을 보여줍니다.

![역 그래픽 캡슐 네트워크(IGC-Net) 개요. 입력 이미지는 먼저 전역 형상 및 알베도 임베딩으로 인코딩된 다음 임베딩으로 인코딩한 다음 분해 모듈로 전송하여 공간적으로 분리된 파트 레벨 그래픽 캡슐을 얻습니다. 그 후 이 캡슐을 디코딩하여 부품에 대한 명시적인 3D 설명을 얻고, 이를 깊이별로 조합하여 오브젝트 캡슐을 오브젝트 중심 표현으로 생성합니다. 마지막으로 오브젝트 캡슐에 조명을 비추고, 포즈를 취하고, 입력 이미지에 맞게 렌더링합니다. 학습된 그래픽 캡슐은 학습 후 자연스럽게 계층적 3D 표현을 구축합니다.](Graphics%20Capsule%20Learning%20Hierarchical%203D%20Face%20Rep%20e4058f3876c84d1e90bcd7daa94a959e/Untitled.png)

역 그래픽 캡슐 네트워크(IGC-Net) 개요. 입력 이미지는 먼저 전역 형상 및 알베도 임베딩으로 인코딩된 다음 임베딩으로 인코딩한 다음 분해 모듈로 전송하여 공간적으로 분리된 파트 레벨 그래픽 캡슐을 얻습니다. 그 후 이 캡슐을 디코딩하여 부품에 대한 명시적인 3D 설명을 얻고, 이를 깊이별로 조합하여 오브젝트 캡슐을 오브젝트 중심 표현으로 생성합니다. 마지막으로 오브젝트 캡슐에 조명을 비추고, 포즈를 취하고, 입력 이미지에 맞게 렌더링합니다. 학습된 그래픽 캡슐은 학습 후 자연스럽게 계층적 3D 표현을 구축합니다.

2. Related Work

이 섹션에서는 AI 이미지 처리 분야에서 수행된 이전 연구와 이러한 연구를 기반으로 한 새로운 접근 방식에 대해 설명합니다.

2.1. 캡슐 네트워크

연구에 따르면 인간의 뇌는 희박하고 계층적인 방식으로 작동하며, 이는 '캡슐 네트워크'라는 것을 만들어내는 데 영감을 주었습니다. 이 네트워크는 이미지를 가져와서 이미지에 있는 물체의 기본 부분을 설명하는 '저수준' 캡슐 세트로 나눈 다음, 이를 '고수준' 캡슐로 조립하여 물체의 더 복잡한 측면을 설명합니다. SCAE 및 HP-Capsule과 같은 기존 캡슐 네트워크는 단순한 2D 물체나 얼굴은 처리할 수 있었지만, 더 복잡한 3D 이미지나 다양한 포즈의 얼굴을 처리하는 데는 한계가 있었습니다. 저자들은 3D로 물체를 표현하는 방법을 학습할 수 있는 "그래픽 캡슐"이라는 새로운 접근 방식을 제안합니다.

2.2. 비지도 파트 세분화

저자들은 객체를 보다 포괄적으로 표현하는 것 외에도 얼굴 이미지를 세분화(또는 분할)하는 그래픽 캡슐의 기능을 테스트했습니다. 이 작업에 대한 이전 방법에는 추론 중에 전체 데이터 세트를 최적화해야 하거나 부분을 분리할 때 집중력 손실에 의존해야 하는 등의 한계가 있었습니다. 저자들의 IGC-Net은 다양한 포즈를 취한 얼굴에서 일관성을 유지하면서 얼굴 부분의 해석 가능한 3D 표현을 제공합니다.

2.3. 비지도 3D 얼굴 재구성

2D 이미지에서 3D 얼굴을 재구성하는 것은 오랫동안 어려운 과제였습니다. 기존의 방법은 사람이 미리 정의한 균일한 토폴로지를 사용하여 얼굴을 설명하는 3D 모퍼블 모델의 파라미터를 추정했습니다. 최근에는 얼굴의 대칭적 특성을 이용해 3D 얼굴 재구성을 학습하는 방법이 등장했습니다. 이러한 방법에서 영감을 얻은 저자들은 이미지에서 계층적 3D 얼굴 표현을 학습하고 신경망이 얼굴을 부분으로 분해하는 방법을 학습하여 얼굴을 이해하는 방법에 대한 통찰력을 제공하는 그래픽 캡슐을 제안합니다.

3. Method

이 구절은 3D 사람 얼굴 표현의 비지도 학습에 초점을 맞춘 캡슐 네트워크의 일종인 역 그래픽 캡슐 네트워크(IGC-Net)의 구조와 학습 과정을 자세히 설명하는 것처럼 보입니다. 이 네트워크에는 계층적 3D 표현, 그래픽 캡슐, 그래픽 분해 모듈(GDM) 등 여러 가지 혁신적인 개념이 포함되어 있습니다.

IGC-Net에는 일련의 프로세스가 포함됩니다:

이미지 인코딩: 이미지 인코딩 단계에서는 CNN 기반 이미지 인코더가 입력 이미지 I를 가져와 형상(fs) 및 알베도(fa) 임베딩으로 인코딩합니다.

그래픽 분해: 그래픽 분해 모듈(GDM)은 글로벌 임베딩을 부분 수준 임베딩으로 분해하는 데 사용되며, 이 임베딩은 해석 가능한 그래픽 캡슐로 디코딩됩니다. 또한 GDM은 일관성을 위해 셰이프와 알베도 임베딩을 동시에 분해합니다.

파트 캡슐 어셈블리: 파트 캡슐은 깊이에 따라 조립되어 글로벌 오브젝트 캡슐을 생성합니다. 캡슐의 가시성은 다른 캡슐에 대한 깊이에 따라 결정됩니다.

디퍼런셜 렌더링: 마지막으로 차등 렌더링 단계에서는 조명을 추정하여 재구성된 이미지를 생성합니다.

IGC-Net을 훈련하기 위해 여러 가지 손실 및 정규화 전략이 사용됩니다:

재구성: 재구성: 네트워크는 음의 로그 확률 손실과 사전 학습된 모델에 의해 추출된 특징의 차이를 측정하는 지각 손실을 사용하여 원본 이미지와 재구성된 이미지 사이의 거리를 최소화합니다(논문에서는 VGG가 사용됨).

의미적 일관성: 샘플 간에 의미론적 일관성을 유지하기 위해 각 캡슐의 모양 임베딩에 대비 손실이 적용됩니다.

희소성: 네트워크가 단일 캡슐을 사용하여 전체 객체를 설명하는 것을 방지하기 위해 부분 캡슐의 가시 영역에 공간 희소성 제약 조건이 적용됩니다.

배경 분리: 이 모델은 또한 배경과 전경을 분리합니다. 두드러진 맵이나 실사 전경 마스크를 사용하는 대신 특정 부분 캡슐을 사용하여 배경을 모델링합니다. 오브젝트의 외부 영역은 깊이에 임계값을 적용하여 추정합니다.

최종 손실 함수는 이러한 손실 함수와 특정 가중치 인자를 조합한 것입니다.

4. Experiments

이 텍스트는 비지도 얼굴 부분 발견 및 분할을 위한 네트워크인 IGC-Net(해석 가능한 그래픽 캡슐 네트워크)에 대한 연구 논문의 결과 및 토론 섹션의 개요로 보입니다. 다음은 핵심 사항을 요약한 내용입니다:

![3D 설명과 함께 발견된 얼굴 계층 구조의 일러스트레이션. 모양과 알베도 정보를 단서로 통합합니다, IGC-Net은 이미지를 배경, 눈, 입, 이마, 코, 뺨의 여섯 부분으로 분해합니다.](Graphics%20Capsule%20Learning%20Hierarchical%203D%20Face%20Rep%20e4058f3876c84d1e90bcd7daa94a959e/Untitled%201.png)

3D 설명과 함께 발견된 얼굴 계층 구조의 일러스트레이션. 모양과 알베도 정보를 단서로 통합합니다, IGC-Net은 이미지를 배경, 눈, 입, 이마, 코, 뺨의 여섯 부분으로 분해합니다.

구현 세부 사항: 컨볼루션 신경망으로 구성된 IGC-Net은 GeForce RTX 3090의 Adam 옵티마이저를 사용하여 60회에 걸쳐 훈련되었습니다. 네트워크는 세 가지 데이터 세트에서 평가되었습니다: BP4D, Multi-PIE, CelebA. IGC-Net은 얼굴 이미지를 배경, 눈, 입, 이마, 코, 뺨 등 의미적으로 일관된 6개의 부분으로 분해하는 데 성공했습니다.

발견한 얼굴 계층 구조: IGC-Net의 그래픽 캡슐은 다양한 조명과 포즈에서 캡처된 얼굴의 3D 표현을 제공했습니다. 이 접근 방식은 복잡한 얼굴 구조를 해석할 수 있는 기능을 제공하며, 이 방법은 고양이 얼굴로 성공적으로 확장되었습니다.

![CelebA에서 비지도 얼굴 분할의 정성적 비교.](Graphics%20Capsule%20Learning%20Hierarchical%203D%20Face%20Rep%20e4058f3876c84d1e90bcd7daa94a959e/Untitled%202.png)

CelebA에서 비지도 얼굴 분할의 정성적 비교.

계층적 3D 얼굴 표현 분석: IGC-Net이 제공하는 3D 표현은 크로스뷰 얼굴 인식 작업에서 2D 자동 인코더보다 뛰어난 성능을 보였습니다. 얼굴 인식에는 모양보다 알베도(색상/질감 정보)가 더 중요하며, 특히 눈의 알베도와 코의 모양이 중요하다는 사실이 밝혀졌습니다.

비지도 얼굴 세분화: 비지도 얼굴 분할을 위한 다른 방법들, 예를 들어 DFF, SCOPS, HPCapsule과 비교한 결과, IGC-Net은 정량적(정규화된 평균 오류, NME) 및 정성적 측면에서 모두 우수한 성능을 보였습니다.

![CelebA에 대한 정성적 절제 연구. GDM에서 원핫 연산(식 6 참조)이 없으면 의미적 일관성이 손상되는 것을 알 수 있으며, 의미성이 두드러지는 부분을 발견하기 위해서는 Lcontra(식 9 참조)가 중요하다는 것을 알 수 있습니다.](Graphics%20Capsule%20Learning%20Hierarchical%203D%20Face%20Rep%20e4058f3876c84d1e90bcd7daa94a959e/Untitled%203.png)

CelebA에 대한 정성적 절제 연구. GDM에서 원핫 연산(식 6 참조)이 없으면 의미적 일관성이 손상되는 것을 알 수 있으며, 의미성이 두드러지는 부분을 발견하기 위해서는 Lcontra(식 9 참조)가 중요하다는 것을 알 수 있습니다.

절제 연구: 이 연구는 의미 있는 얼굴 부분을 발견하기 위해 그래픽 설명 모듈(GDM)의 원핫 연산과 의미적 제약 조건인 Lcontra가 중요하다는 것을 보여주었습니다.

이 연구는 인식을 위해 얼굴의 계층적 3D 표현을 구축하는 인간 시각 시스템의 능력을 이해하고 복제하는 데 기여합니다. 또한 인식, 분할, 포즈 추정 등 다양한 얼굴 분석 작업에 응용할 수 있는 잠재력이 있습니다.

5. Conclusion and Discussion

결론에서는 레이블이 지정되지 않은 대규모 '자연 상태' 이미지에서 계층적 3D 얼굴 표현을 학습하도록 설계된 네트워크인 IGC-Net의 개발 및 구현에 관한 이 백서의 핵심 내용을 요약합니다.

IGC-Net은 명확한 의미를 가진 3D 표현이 포함된 그래픽 캡슐을 빌딩 블록으로 사용합니다. 깊이와 알베도 정보를 결합하여 이미지를 일련의 부품 수준 그래픽 캡슐로 분해합니다. 그런 다음 이러한 부품 수준 캡슐을 객체 수준 캡슐로 조립하여 객체의 계층 구조를 효과적으로 구성합니다.

이 과정을 통해 시각적 인식에 중점을 둔 신경망이 얼굴을 3D 모델의 계층 구조로 이해하는 방법을 알 수 있습니다. 또한 부분 수준 그래픽 설명은 비지도 얼굴 세분화 및 해석 가능한 얼굴 분석에도 유용합니다.

네트워크의 효과와 해석 가능성은 다양한 환경과 조건에서 캡처된 다양한 범위의 얼굴 이미지를 제공하는 CelebA, BP4D, Multi-PIE 데이터 세트에 대한 실험을 통해 검증되었습니다.

사람의 감독 없이도 얼굴 이미지를 일관되고 의미 있는 부분으로 분해하는 데 성공함으로써 IGC-Net은 비지도 학습 및 얼굴 인식 분야에서 상당한 진전을 이루었습니다.

- 요약
    
    소개: 이 백서는 사람 얼굴의 일부를 비지도 방식으로 발견하고 분할하는 것을 목표로 하는 컨볼루션 신경망의 혁신적인 응용 프로그램인 해석 가능한 그래픽 캡슐 네트워크(IGC-Net)의 개념을 소개하는 것으로 시작됩니다. 이 방법은 많은 얼굴 분석 애플리케이션에서 중요한 작업인 시맨틱 얼굴 분할의 문제를 해결하는 것을 목표로 합니다.
    
    구현 세부 사항: 저자들은 이미지 인코더, 캡슐 디코더, 조명 모듈을 포함한 모델 구현에 대한 정보를 제공합니다. 또한 사용된 주요 하이퍼파라미터를 언급하고 GeForce RTX 3090에서 60회에 걸쳐 Adam 옵티마이저를 사용하여 네트워크를 훈련한 방법을 설명합니다. 평가에 사용된 데이터 세트에는 다양한 환경에서 캡처한 사람 얼굴 이미지로 구성된 BP4D, Multi-PIE, CelebA가 포함됩니다.
    
    얼굴 계층 구조의 발견: 저자들은 그래픽 캡슐에 내장된 3D 표현을 사용하여 얼굴 부분의 계층 구조를 생성하는 IGC-Net의 기능에 대해 설명합니다. 이 네트워크는 얼굴 이미지를 의미적으로 일관된 6개의 부분, 즉 배경, 눈, 입, 이마, 코, 뺨으로 성공적으로 분해합니다. 이 작업은 사람의 감독 없이 각 부분에 대해 특정 그래픽 캡슐을 사용하여 수행됩니다.
    
    계층적 3D 얼굴 표현 분석: 이 섹션에서는 계층적 3D 묘사의 장점과 신경망의 얼굴 인식 메커니즘에 대해 살펴봅니다. 저자들은 3D 표현 방법을 2D 자동 인코더와 비교하여 3D 표현이 얼굴 인식 작업에서 더 나은 일관성과 정확성을 제공한다는 사실을 발견했습니다.
    
    비지도 얼굴 세분화: 이 섹션에서는 비지도 얼굴 분할에 대한 IGC-Net의 성능을 평가합니다. 이 네트워크는 이 작업을 위한 다른 최신 방법(예: DFF, SCOPS, HP-Capsule)과 비교됩니다. 저자는 세그먼트 맵에 의해 예측된 랜드마크의 정규화된 평균 오차(NME)를 활용하여 구문 분석의 품질을 평가합니다. 그 결과 IGC-Net이 다른 방법보다 성능이 뛰어나다는 것을 보여줍니다.
    
    절제 연구: 저자들은 의미 있는 얼굴 부분을 발견하기 위해 네트워크에서 원핫 연산과 의미적 제약이 미치는 영향을 분석합니다. 이 연구는 샘플 간에 의미론적 일관성을 유지하고 두드러진 의미를 가진 부분을 발견하는 데 있어 이러한 작업이 중요하다는 것을 확인합니다.
    
    결론: 이 논문은 연구 결과를 요약하고 컴퓨터 비전 및 얼굴 분석 작업 분야에서 IGC-Net의 잠재적 응용에 대해 논의하는 것으로 마무리합니다.