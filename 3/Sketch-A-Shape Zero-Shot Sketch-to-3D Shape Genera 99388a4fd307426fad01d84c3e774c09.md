# Sketch-A-Shape: Zero-Shot Sketch-to-3D Shape Generation

[https://arxiv.org/abs/2307.03869](https://arxiv.org/abs/2307.03869)

- Jul 2023

![Sketch-A-Shape은 제로샷 스케치-3D 생성 모델입니다. 이 방법이 어떻게 보편적으로 적용되어 여러 입력 범위(대충 그린 스케치에서부터 전문적인 스케치, 그리고 다양한 모호성 수준의 스케치까지)에서 일관된 3D 형상을 합성할 수 있는지 보여주고 있습니다.](Sketch-A-Shape%20Zero-Shot%20Sketch-to-3D%20Shape%20Genera%2099388a4fd307426fad01d84c3e774c09/Untitled.png)

Sketch-A-Shape은 제로샷 스케치-3D 생성 모델입니다. 이 방법이 어떻게 보편적으로 적용되어 여러 입력 범위(대충 그린 스케치에서부터 전문적인 스케치, 그리고 다양한 모호성 수준의 스케치까지)에서 일관된 3D 형상을 합성할 수 있는지 보여주고 있습니다.

### 1. Introduction

이 논문에서는 간단한 도면이나 세부 스케치에서 3D 모델을 생성하는 방법인 'Sketch-A-Shape'를 소개합니다. 이는 대규모로 쌍을 이룬 스케치 3D 데이터가 부족하고 다양한 수준의 스케치 추상화에 적응하기 어렵다는 등의 한계가 있었던 이전 방법을 개선한 것입니다.

'스케치-어-쉐이프'는 3D 렌더링에서 스케치로 전환할 때에도 강력하게 유지되는 로컬 시맨틱 신호를 식별할 수 있는 CLIP 및 DINOv2와 같은 사전 학습된 비전 모델을 활용합니다. 이 프로세스는 벡터 양자화 가변 자동 인코더(VQ-VAE)를 훈련하여 형상 임베딩을 얻는 것으로 시작됩니다. 그런 다음 사전 학습된 이미지 인코더에서 얻은 로컬 시맨틱 특징을 기반으로 마스킹된 트랜스포머를 학습합니다. 추론 단계에서 변환기는 스케치의 로컬 시맨틱 특징에 따라 조절되어 3D 모양을 생성합니다.

이 논문의 주요 공헌은 다음과 같습니다:

- 쌍을 이루는 스케치-3D 데이터 세트 없이 스케치에서 3D 모델을 생성하는 최초의 제로샷 방법인 'Sketch-A-Shape'의 개발.
- 낙서부터 전문적인 도면까지 다양한 스케치의 복잡성을 일반화할 수 있는 모델의 능력 입증.
- 스케치에서 성공적인 제로 샷 형상 생성을 가능하게 하는 'Sketch-A-Shape'의 부분을 이해하기 위한 철저한 실험.

### 2. Related Work

3D 제너레이티브 모델: 복셀, CAD, 암시적 표현, 메시, 포인트 클라우드와 같은 형식을 사용하여 제너레이티브 모델을 사용하여 3D 형상을 생성하는 데 상당한 진전이 있었습니다. 최근의 연구는 주로 벡터 양자화 가변 자동 인코더(VQ-VAE), 생성적 적대 신경망(GAN) 또는 확산 모델에 기반한 생성 모델을 개발하는 데 중점을 두고 있습니다. 이 백서에서는 주로 VQ-VAE를 사용하여 복셀, CAD 및 암시적 표현에 걸쳐 스케치와 3D 형상을 연결하는 데 관심이 있지만, 이 접근 방식을 GAN 또는 확산 기반 모델에도 적용할 수 있다고 언급합니다.

3D 제로샷 학습: 사전 학습된 언어 및 2D 비전 모델은 텍스트에서 모양 생성, 메시 변형, 아바타 애니메이션과 같은 3D 비전 작업에 적용되었습니다. 텍스트-이미지 모델은 텍스트-도형 생성, 단일 뷰 재구성, 3D 도형에 텍스처 추가에도 사용되었습니다. 이 작업은 사전 학습된 모델을 활용하여 스케치에서 제로 샷 3D 모양을 생성하는 최초의 사례라는 점에서 특별합니다.

스케치에서 3D 도형 생성: 스케치에서 3D 도형을 생성하기 위해 다양한 지도 학습 방법이 활용되어 왔습니다. 일부는 신경망을 사용하여 시점의 깊이를 추정하고 이를 3D 포인트 클라우드에 통합했습니다. 또 다른 방법은 컨볼루션 신경망(CNN)을 사용하여 초기 모양을 예측한 후 새로운 시점을 사용하여 구체화했습니다. 추가 방법으로는 도메인 적응 네트워크와 별도의 뷰 및 모양 스케치 특징 추출을 통해 스케치 모호성을 해결하는 방법이 있습니다. 최근의 한 접근 방식은 스케치에 따라 3D 포인트 클라우드 생성을 위한 확산 모델을 훈련했습니다. 이와는 대조적으로 이 백서에서는 쌍을 이루는 모양-스케치 데이터에 의존하지 않고 CLIP과 같이 사전 학습된 이미지 인코더의 강력한 로컬 시맨틱 특징을 사용하는 새로운 접근 방식을 제안합니다.

### 3. Method

이 방법론은 이산형 자동 인코더를 훈련하고 마스킹 트랜스포머를 사용하는 두 단계로 구성됩니다.

3.1. 1단계: 이산형 자동 인코더 트레이닝
이 단계에서는 자동 인코더 프레임워크를 사용하여 모양 분포를 이산 인덱스로 표현합니다. 압축된 잠상 공간에서 3D 형상을 효율적으로 캡처하여 후방 붕괴를 방지하고 고품질 3D 형상을 생성하는 벡터 양자화 가변 자동 인코더(VQ-VAE)가 활용됩니다. 3D 형상은 인코더를 통해 형상 사전을 가리키는 개별 인덱스로 변환됩니다. 이러한 인덱스의 분포는 다음 단계에서 트랜스포머 기반 생성 모델을 사용하여 모델링됩니다. 그런 다음 디코더를 사용하여 재구성 손실이 있는 인덱스로부터 모양을 생성합니다.

복셀 표현의 경우 인코더와 디코더 네트워크는 ResNet 아키텍처에 기반한 3D 컨볼루션을 사용합니다. 암시적 표현의 경우, 디코더를 위한 업샘플링 프로세스와 함께 ResNet 기반 인코더가 사용되어 더 높은 해상도의 볼륨을 생성합니다. CAD 표현을 위해 SkexGen VQ-VAE 아키텍처가 사용됩니다.

3.2. 2단계: 마스크 트랜스포머
두 번째 단계에서는 추론 시점에 스케치에 조건부 형상 인덱스를 생성하도록 사전 모델을 훈련합니다. 이는 조건부 생성 모델을 사용하여 1단계에서 생성된 이산 인덱스(모양 임베딩)의 시퀀스를 모델링함으로써 이루어집니다. 양방향 트랜스포머 기반 네트워크가 사용되며, 이 네트워크는 교차 주의 메커니즘을 통해 합성 3D 렌더링 피처에 조건이 부여됩니다. 훈련 중에는 제공된 조건부 정보를 사용하여 이러한 인덱스의 마스킹을 해제하는 훈련 목표를 생성하기 위해 모양 인덱스의 일부가 무작위로 마스킹됩니다.

이 연구에서는 다양한 데이터로 훈련된 더 큰 모델을 사용하면 시맨틱 로컬 피처가 더 강력해져 합성 렌더링에서 스케치로 영역을 전환할 수 있다는 사실을 발견했습니다. 사전 학습된 모델에서 더 깊은 레이어의 피처 그리드 출력을 사용하면 더 많은 시맨틱 피처를 생성하고 피처의 로컬 구조를 보존할 수 있으므로 더 나은 결과를 얻을 수 있었습니다. 이 그리드를 시퀀스로 변환하기 위해 여러 MLP 레이어로 구성된 매핑 네트워크가 사용됩니다. 널 임베딩 시퀀스는 추론 중에 분류기 없이 안내할 수 있도록 5%의 시간 동안 로컬 특징 시퀀스를 대체합니다.

3.3. 추론
생성 단계에서 스케치는 먼저 훈련 중에 사용된 것과 동일한 고정된 사전 훈련된 모델을 사용하여 로컬 특징 시퀀스로 변환됩니다. 이러한 로컬 특징은 트랜스포머의 컨디셔닝 쿼리 역할을 합니다. 완전히 마스킹된 인덱스 세트부터 시작하여 스케치에서 로컬 특징 시퀀스가 제공하는 조건부 정보를 사용하여 점차 마스킹을 해제하는 반복적 디코딩 방식이 사용됩니다.

변환기는 각 시간 단계에서 마스킹이 해제된 완전한 모양 시퀀스를 예측하여 가장 신뢰도가 높은 마스킹된 토큰의 일부를 받아들입니다. 그런 다음 이러한 토큰은 나머지 단계에서 마스킹 해제된 것으로 지정되고, 이전에 마스킹 해제된 토큰을 제외한 나머지 토큰은 마스킹된 것으로 재설정됩니다.

![Sketch-A-Shape 방법에 대한 개요입니다. 윗 줄은 두 가지 훈련 단계를 보여주며, 아래 줄은 추론 시기에 스케치를 통해 3D 형상이 어떻게 생성되는지 보여줍니다.](Sketch-A-Shape%20Zero-Shot%20Sketch-to-3D%20Shape%20Genera%2099388a4fd307426fad01d84c3e774c09/Untitled%201.png)

Sketch-A-Shape 방법에 대한 개요입니다. 윗 줄은 두 가지 훈련 단계를 보여주며, 아래 줄은 추론 시기에 스케치를 통해 3D 형상이 어떻게 생성되는지 보여줍니다.

마지막으로 완전히 마스킹이 해제된 토큰은 1단계에서 학습된 셰이프 디코더를 사용하여 3D 오브젝트로 변환됩니다. 이 프로세스를 여러 번 다시 시작하여 동일한 스케치 쿼리에 대해 다른 3D 모양을 생성할 수 있습니다.

### 4. Experiments

이 섹션에서는 모델 출력의 정확성과 충실도를 평가하기 위한 실험 결과를 제시합니다. 각 지표별로 세 번씩 실험을 실행하고 평균 결과를 보고했습니다. 실험 설정에 대한 자세한 정보는 보충 자료에 나와 있습니다.

훈련 데이터 세트. 실험에는 ShapeNet(v2) 데이터 세트[5]의 두 가지 하위 집합인 ShapeNet13과 ShapeNet55를 사용했습니다. 딥캐드[71] 데이터 세트는 CAD 모델 훈련에 사용되었습니다.

평가 스케치 데이터 세트. 저희 모델은 페어링된(도형, 스케치) 데이터 세트에 대해 훈련되지 않았기 때문에 전문가용 스케치부터 비전문가용 스케치까지 다양한 스케치 데이터 세트에서 성능을 평가했습니다.

평가 지표. 분류 정확도와 사람의 평가라는 두 가지 지표를 사용했습니다.

분류 정확도: 스케치에 대해 생성된 모양을 정확하게 예측하는 모델의 정확도를 측정합니다. 각 스케치 쿼리에 대해 샘플링된 5개의 도형에 대한 평균을 보고합니다.

인간의 지각 평가: 생성된 3D 모델이 스케치의 주요 기하학적 및 문체적 디테일을 얼마나 잘 보존하는지 측정하기 위해 아마존 세이지메이커 그라운드 트루스 및 메카니컬 터크 인력[45]을 활용했습니다.

![다른 도메인의 스케치에서 생성된 3D 형상들. 행 1-5, 그리고 6은 각각 voxel, 그리고 암시적 표현을 가리킵니다. 마지막 세 행은 스케치별로 생성된 다른 3D 샘플들을 voxel, 암시적, 그리고 CAD 형식으로 보여줍니다.](Sketch-A-Shape%20Zero-Shot%20Sketch-to-3D%20Shape%20Genera%2099388a4fd307426fad01d84c3e774c09/Untitled%202.png)

다른 도메인의 스케치에서 생성된 3D 형상들. 행 1-5, 그리고 6은 각각 voxel, 그리고 암시적 표현을 가리킵니다. 마지막 세 행은 스케치별로 생성된 다른 3D 샘플들을 voxel, 암시적, 그리고 CAD 형식으로 보여줍니다.

4.1. 정성적 결과
우리의 모델은 다양한 유형의 스케치에서 상당히 우수한 성능을 보였으며, 그 다재다능함은 그림 3에서 확인할 수 있습니다.

4.2. 사람의 지각 평가
생성된 3D 모델의 인식을 평가하기 위해 두 가지 대안 강제 선택 연구[14]를 실시했습니다. 평균적으로 생성된 3D 모델의 71.1%가 크라우드 워커에 의해 정확하게 식별되었습니다.

4.3. 지도 모델과의 비교
Sketch2Model [79]이라는 지도 방식과 비교했을 때, 우리의 모델은 다양한 데이터 세트에서 우수한 생성 능력을 보여주었습니다.

4.4. 사전 훈련된 모델 조사
우리는 다양한 사전 훈련된 모델에 대한 광범위한 연구를 수행했습니다. 연구 결과, 로컬 그리드 특징을 활용하면 더 나은 성능을 얻을 수 있고, 사전 학습된 모델이 클수록 제로 샷 성능이 더 우수하며, 광범위한 데이터 세트에서 학습된 경우에도 모델의 성능이 비슷하게 유지되는 것으로 나타났습니다.

4.5. 다양한 레이어에서의 정확도
비전 트랜스포머의 더 깊은 레이어에서 추출된 특징이 더 높은 정확도로 이어지는 중요한 의미 정보를 포함하고 있음을 발견했습니다.

4.6. 컨디셔닝을 위한 설계 선택
연구 결과에 따르면 매핑 레이어를 통합하면 모델의 성능이 향상되며, MLP 레이어의 최적 개수는 2개인 것으로 나타났습니다. 학습 가능한 위치 임베딩을 통한 교차 주의가 가장 효과적인 컨디셔닝 메커니즘으로 입증되었습니다.

![Mechanical Turk 크라우드 작업자에게 보여진 이미지의 예입니다. 질문은 "오른쪽의 3D 모델 중 왼쪽의 스케치와 가장 잘 일치하는 것은 무엇인가요?"이며, 선택사항은 "위쪽"과 "아래쪽"입니다.](Sketch-A-Shape%20Zero-Shot%20Sketch-to-3D%20Shape%20Genera%2099388a4fd307426fad01d84c3e774c09/Untitled%203.png)

Mechanical Turk 크라우드 작업자에게 보여진 이미지의 예입니다. 질문은 "오른쪽의 3D 모델 중 왼쪽의 스케치와 가장 잘 일치하는 것은 무엇인가요?"이며, 선택사항은 "위쪽"과 "아래쪽"입니다.

4.7. 증강의 효과
연구 결과, 우리의 방법은 데이터 증강 없이도 잘 작동하지만, 다양한 유형의 증강이 특정 데이터 세트에 상당한 영향을 미칠 수 있음을 보여주었습니다. 궁극적으로 모든 증강으로 훈련된 네트워크가 데이터 세트 전반에서 가장 우수한 성능을 보였습니다.

### 5. Conclusion

또한 사전 학습된 모델에 대한 의존성을 고려할 때, 향후 사전 학습 기법의 발전과 함께 이 접근 방식이 어떻게 작동하는지 살펴보는 것도 흥미로울 것입니다. 특히 새로운 아키텍처와 훈련 방법론의 영향을 조사하는 것은 이 기법이 달성할 수 있는 한계를 넓히는 데 큰 도움이 될 수 있습니다.

또한, 이번 연구 결과는 전문적인 스케치 해석에 대한 이 방법의 가능성을 보여 주지만, 비전문가 스케치에 대한 모델의 성능은 개선할 수 있는 부분입니다. 향후 연구에서는 입력된 스케치 품질에서 이러한 가변성을 처리하기 위해 보다 강력한 기술을 통합하는 데 초점을 맞출 수 있습니다.

마지막으로, 이 연구는 주로 스케치에서 도형으로의 번역에 초점을 맞추었습니다. 그러나 이 방법론은 부분적으로 그려진 오브젝트를 전체 3D 모델로 완성하는 오브젝트 완성 등의 다른 작업으로 확장할 수 있습니다. 이렇게 하면 3D 모델링 도구와 완전히 새로운 차원의 상호 작용을 제공하여 훨씬 더 직관적이고 접근하기 쉬운 인간과 3D 모델링 간의 인터페이스를 만들 수 있습니다.

요약하자면, 이번 연구는 3D 형상 생성 및 스케치 기반 인터페이스 분야의 향후 연구에 폭넓은 기회를 열어줄 것으로 기대됩니다.

### Supplementary Material

A. 인간 지각 평가
본 연구에서는 인간 지각 평가의 결과를 대상 스케치가 출처한 데이터셋에 따라 분석했습니다. 특히, "램프"는 89.1%의 확률로 올바르게 식별되는 반면, 전화기는 무작위 선택보다 조금 더 나은 52.5%의 확률로 식별되었습니다. 의자, 테이블, 소파와 같이 특이한 형태를 가진 카테고리들이 잘 수행되었고, 비행기나 총과 같은 카테고리들은 좋은 모델을 만들었지만, 이들은 사람 평가자들이 같은 카테고리 내에서 올바른 3D 모델과 무작위 모델을 구분할 수 있을 만큼 독특하지 않았습니다.

![인간 평가자가 가장 많이 인식할 수 있는 결과와 가장 적게 인식할 수 있는 결과를 생성했습니다.](Sketch-A-Shape%20Zero-Shot%20Sketch-to-3D%20Shape%20Genera%2099388a4fd307426fad01d84c3e774c09/Untitled%204.png)

인간 평가자가 가장 많이 인식할 수 있는 결과와 가장 적게 인식할 수 있는 결과를 생성했습니다.

B. 감독 방법과의 비교
수량적 비교를 통해 우리의 방법이 학습 데이터 없이도 스케치를 통해 3D 형상을 생성할 수 있는 것을 확인했습니다. 또한, Sketch2Model과 SketchSampler와의 질적 비교를 제공하며, 이 방법들은 매끄럽고 기하학적 세부 사항이 부족하다는 문제가 있었습니다.

C. 아키텍처와 실험 세부 정보
우리는 Adam Optimizer를 사용하고, 훈련 동안 학습률 스케줄러를 사용하지 않았습니다. 우리의 모델은 다양한 데이터셋에 적응할 수 있음을 보여주기 위해, 다양한 데이터셋에 대해 훈련되었습니다.

![다른 방법으로 생성된 도형. 우리의 방법과 비교했을 때 Sketch2Model 메시는 기하학적 디테일이 부족하고 매끄럽게 보이는 반면 SketchSampler 포인트 클라우드는 아티팩트와 이상값이 있음을 알 수 있습니다.](Sketch-A-Shape%20Zero-Shot%20Sketch-to-3D%20Shape%20Genera%2099388a4fd307426fad01d84c3e774c09/Untitled%205.png)

다른 방법으로 생성된 도형. 우리의 방법과 비교했을 때 Sketch2Model 메시는 기하학적 디테일이 부족하고 매끄럽게 보이는 반면 SketchSampler 포인트 클라우드는 아티팩트와 이상값이 있음을 알 수 있습니다.

D. Point·E와의 비교
우리의 방법이 더 뛰어난 성능을 보였고, 디자인 선택의 장점을 보여줍니다. 또한, 우리의 방법이 자연 이미지에도 적용될 수 있음을 발견하였습니다.

F. 실패 사례
이 섹션에서는 우리의 방법의 한계를 보여줍니다. 첫 번째 행에서는 우리의 방법이 ShapeNet13에 없는 형태로 일반화하는 데 어려움을 겪는 것을 보여줍니다. 또한, 우리의 방법은 여러 형태를 표현하는 스케치를 다루는 데 어려움을 겪습니다. 마지막으로, 우리의 방법은 형태의 로컬 세부 사항을 정확하게 재현하는 데 어려움을 겪습니다.

![저희 방법의 실패 사례](Sketch-A-Shape%20Zero-Shot%20Sketch-to-3D%20Shape%20Genera%2099388a4fd307426fad01d84c3e774c09/Untitled%206.png)

저희 방법의 실패 사례

G. 사회적 영향
스케치에서 3D로의 기술의 사회적 영향은 건축, 제품 디자인, 게임, 엔터테인먼트 등 다양한 분야에서 중요할 수 있습니다. 그러나, 이러한 기술의 보급이 특정 산업에서의 직업 소실을 초래할 수 있다는 점을 주의해야 합니다.

H. 미래의 연구
미래의 연구에서는 이 방법을 더 큰 3D 데이터셋에 적용하는 것에 집중할 계획입니다. 또한, 스케치와 텍스트 조건을 결합하는 것이 흥미로운 방향성일 수 있습니다.

I. 추가 질적 결과
추가 결과는 그림 9와 그림 10에서 제공됩니다