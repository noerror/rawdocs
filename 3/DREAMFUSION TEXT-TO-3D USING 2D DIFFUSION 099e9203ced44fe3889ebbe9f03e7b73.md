# DREAMFUSION: TEXT-TO-3D USING 2D DIFFUSION

[https://arxiv.org/pdf/2209.14988.pdf](https://arxiv.org/pdf/2209.14988.pdf)

1 INTRODUCTION

이 연구는 3D 데이터 없이도 사전 학습된 2D 텍스트-이미지 확산 모델을 사용하여 텍스트로부터 3D 오브젝트와 장면을 생성하는 방법을 제시합니다. 이 방법은 확률 밀도 증류에 기반한 손실 함수를 도입하여 신경 방사 필드(NeRF)와 같은 3D 모델을 최적화하여 다양한 각도에서 사실적인 2D 렌더링을 생성하는 데 도움을 줍니다. 드림퓨전 기술은 이 손실 함수로 NeRF를 미세 조정하여 사용자가 제공한 텍스트 프롬프트에서 상세하고 일관된 3D 오브젝트와 장면을 생성할 수 있습니다. 이 접근 방식은 3D 훈련 데이터나 이미지 확산 모델에 대한 수정이 필요하지 않으므로 3D 합성을 위한 사전 작업으로 사전 훈련된 이미지 확산 모델의 효과를 입증합니다.

2 DIFFUSION MODELS AND SCORE DISTILLATION SAMPLING

확산 모델은 샘플을 단순한 노이즈 분포에서 보다 복잡한 데이터 분포로 변환하는 일종의 생성 모델입니다. 데이터에 노이즈를 추가하는 포워드 프로세스와 노이즈에서 시작하여 구조를 추가하는 리버스 프로세스가 있습니다. 포워드 프로세스는 일반적으로 가우시안 프로세스이며, 리버스 프로세스는 이미지 간 U-Net을 사용하여 구조를 추가하도록 훈련됩니다.

생성 모델은 데이터의 노이즈가 많은 버전에 해당하는 일련의 점수 함수를 학습하도록 훈련됩니다. 텍스트 임베딩을 조건으로 하는 텍스트-이미지 확산 모델은 분류기 없는 안내(CFG)를 사용하여 다양성을 희생하는 대신 샘플 충실도를 개선합니다.

이 작업은 픽셀 공간이 아닌 파라미터 공간에서 샘플링하여 임의의 각도에서 렌더링했을 때 좋은 이미지처럼 보이는 3D 모델을 만드는 것을 목표로 합니다. 이를 위해 저자는 차등 이미지 파라미터화(DIP)를 사용하여 파라미터를 이미지로 변환합니다. 그리고 샘플을 생성하도록 최적화할 수 있는 확산 모델용 손실 함수를 개발합니다.

![Untitled](DREAMFUSION%20TEXT-TO-3D%20USING%202D%20DIFFUSION%20099e9203ced44fe3889ebbe9f03e7b73/Untitled.png)

저자는 점수 증류 샘플링(SDS)이라고 하는 제안된 손실을 최소화하면 합리적인 품질의 제약된 이미지를 생성할 수 있다는 사실을 발견했습니다. SDS는 매개변수 공간에서 작동하므로 새로운 전이 학습 애플리케이션에 사용할 수 있습니다.

![DreamFusion은 무작위로 초기화된 NeRF로 시작하여 처음부터 학습합니다. 임의의 카메라 각도에서 장면을 렌더링하고 밀도에서 계산된 노멀(표면에 수직인 방향)을 사용하여 음영을 추가합니다. 학습 중에 드림퓨전은 렌더링된 이미지에 약간의 노이즈를 추가한 다음 조건부 이미지넷 모델이라는 사전 학습된 모델을 사용하여 이미지를 재구성하려고 시도합니다](DREAMFUSION%20TEXT-TO-3D%20USING%202D%20DIFFUSION%20099e9203ced44fe3889ebbe9f03e7b73/Untitled%201.png)

DreamFusion은 무작위로 초기화된 NeRF로 시작하여 처음부터 학습합니다. 임의의 카메라 각도에서 장면을 렌더링하고 밀도에서 계산된 노멀(표면에 수직인 방향)을 사용하여 음영을 추가합니다. 학습 중에 드림퓨전은 렌더링된 이미지에 약간의 노이즈를 추가한 다음 조건부 이미지넷 모델이라는 사전 학습된 모델을 사용하여 이미지를 재구성하려고 시도합니다

3 THE DREAMFUSION ALGORITHM

드림퓨전 알고리즘은 일반적인 연속 최적화 문제 내에서 손실 함수로 확산 모델을 사용하여 텍스트에서 3D 모델을 합성합니다. 이 알고리즘은 텍스트에서 이미지를 생성하도록 사전 학습된 Imagen 모델을 확산 모델로 사용합니다. 이 알고리즘은 임의의 가중치로 NeRF와 유사한 모델을 초기화하고, 임의의 카메라 위치와 각도에서 뷰를 렌더링하고, 렌더링을 점수 증류 손실 함수에 대한 입력으로 사용하여 텍스트와 유사한 3D 모델을 생성합니다.

NeRF는 볼류메트릭 레이트레이서와 다층 퍼셉트론(MLP)을 결합한 신경 역 렌더링 기법입니다. 카메라의 투사 중심에서 이미지 평면의 각 픽셀 위치를 통해 세계로 광선을 투사하여 이미지를 렌더링합니다. 이 알고리즘은 MLP를 통과한 3D 포인트(µ)에 대한 체적 밀도(τ)와 RGB 색상(c)을 계산하고 이를 합성하여 각 픽셀에 대해 최종 렌더링된 RGB 값을 생성합니다.

모델은 에일리어싱을 줄이고 텍스트에서 3D로 생성하는 작업에 도움이 되는 mip-NeRF 360을 기반으로 합니다. 기존 NeRF 모델은 광선 방향에 따라 광도를 조절하는 반면, MLP는 표면 색상을 파라미터화하고 오브젝트 지오메트리의 국부적 방향을 나타내는 노멀 벡터를 계산합니다. 각 포인트에 RGB 알베도(ρ)를 사용하고 확산 반사율을 사용하여 3D 포인트의 최종 음영 출력 색상을 계산합니다. 또한 알베도 색상을 무작위로 흰색으로 대체하여 "텍스처가 없는" 음영 출력을 생성하여 솔루션이 저하되는 것을 방지합니다.

복잡한 장면을 생성하기 위해 고정된 경계 영역 내에서만 NeRF 장면 표현을 쿼리하고 두 번째 MLP에서 생성된 환경 맵을 사용합니다. 누적된 알파 값을 사용하여 이 배경색 위에 렌더링된 광선 색을 합성합니다. 이렇게 하면 NeRF 모델이 카메라 근처의 공간을 밀도로 채우는 것을 방지하는 동시에 생성된 장면 뒤에 적절한 색상이나 배경을 칠할 수 있습니다.

지오메트리 정규화는 빈 공간이 불필요하게 채워지는 것을 방지하고 노멀 벡터가 카메라 뒤쪽을 향하는 밀도 필드의 병리 현상을 해결하기 위해 포함되어 있습니다. 이러한 정규화와 NeRF의 추가 하이퍼파라미터는 부록 A.2에 자세히 설명되어 있습니다.

![그림 4: 드림퓨전을 사용하여 3D 씬을 생성하고 다듬을 수 있습니다. 여기서는 예제 텍스트 프롬프트를 예제 텍스트 프롬프트를 반복적으로 다듬는 동시에 생성된 각 장면을 네 가지 관점에서 렌더링합니다.](DREAMFUSION%20TEXT-TO-3D%20USING%202D%20DIFFUSION%20099e9203ced44fe3889ebbe9f03e7b73/Untitled%202.png)

그림 4: 드림퓨전을 사용하여 3D 씬을 생성하고 다듬을 수 있습니다. 여기서는 예제 텍스트 프롬프트를 예제 텍스트 프롬프트를 반복적으로 다듬는 동시에 생성된 각 장면을 네 가지 관점에서 렌더링합니다.

텍스트 대 3D 합성은 사전 학습된 텍스트 대 이미지 확산 모델, NeRF 형태의 차별적인 이미지 매개변수화, 최소한의 좋은 샘플을 가진 손실 함수를 사용하여 3D 데이터 없이도 텍스트로부터 3D 모델을 생성합니다. 각 텍스트 프롬프트에 대해 무작위로 초기화된 NeRF가 처음부터 훈련됩니다. 드림퓨전 최적화 프로세스는 4단계로 구성됩니다:

1. 무작위 카메라 및 조명 샘플링: 각 반복마다 카메라 위치와 조명 조건이 무작위로 샘플링됩니다. 일관된 3D 장면을 합성하려면 다양한 카메라 위치가 필수적이며, 다양한 카메라 거리는 학습된 장면의 해상도를 개선하는 데 도움이 됩니다.
2. 렌더링: 카메라 포즈와 조명 위치에 따라 음영 처리된 NeRF 모델이 64x64 해상도로 렌더링됩니다. 조명 컬러 렌더링, 텍스처리스 렌더링, 음영이 없는 알베도 렌더링 중에서 무작위로 선택됩니다.
3. 뷰에 따른 컨디셔닝을 사용한 확산 손실: 텍스트 프롬프트는 종종 다른 보기를 샘플링할 때 좋은 설명이 아닐 수 있는 개체의 표준 보기를 설명합니다. 따라서 무작위로 샘플링된 카메라의 위치에 따라 입력 텍스트에 뷰 종속 텍스트가 추가됩니다. 사하리아 외(2022)의 사전 학습된 64x64 기본 텍스트-이미지 모델이 사용되며, T5-XXL 텍스트 임베딩에 맞춰 조정됩니다.
4. 최적화: 3D 장면은 4개의 칩이 있는 TPUv4 머신에서 최적화되며, 각각 별도의 뷰를 렌더링하고 장치당 배치 크기가 1인 확산 U-Net을 평가합니다. 최적화는 약 1.5시간이 소요되는 15,000번의 반복으로 수행됩니다. 계산 시간은 NeRF 렌더링과 확산 모델 평가에 균등하게 분배됩니다. 파라미터는 분산 샴푸 옵티마이저를 사용하여 최적화됩니다.

최적화 설정에 대한 자세한 내용은 부록 A.2에서 확인할 수 있습니다.

4 EXPERIMENTS

다양한 텍스트 프롬프트에서 일관된 3D 장면을 생성할 수 있는 능력을 평가합니다. 기존의 제로샷 텍스트-3D 생성 모델과 비교하고, 정확한 3D 지오메트리를 구현하는 핵심 구성 요소를 파악하며, 드림퓨전의 질적 기능을 살펴봅니다. 3D 에셋, 확장된 비디오, 메시로 구성된 대규모 갤러리는 dreamfusion3d.github.io에서 확인할 수 있습니다.

모따기 거리 및 PSNR과 같은 기존의 3D 재구성 메트릭은 제로 샷 텍스트-3D 생성에 적용하기 어렵습니다. 대신 입력 캡션과 관련하여 렌더링된 이미지의 일관성을 위한 자동화된 지표로 CLIP R-Precision이 사용됩니다. 이 지표는 장면 렌더링이 주어졌을 때 CLIP이 일련의 방해 요소 중에서 올바른 캡션을 검색하는 정확도를 측정합니다.

표 1은 드림 필드, CLIP 메시, 오라클을 포함한 여러 기준선과 드림퓨전에 대한 CLIP R-정확도를 보여줍니다. 드림퓨전은 컬러 이미지에서 두 기준선보다 성능이 뛰어나며 실사 이미지의 성능에 근접합니다. 텍스처리스 렌더링으로 지오메트리를 평가할 때 58.5%의 시간 동안 캡션과 일치했습니다.

다양한 최적화 선택이 R-Precision에 미치는 영향을 평가하기 위해 절제 작업을 수행했습니다. 각 옵션을 선택할 때마다 지오메트리가 크게 개선되었으며 전체 렌더링은 +12.5% 향상되었습니다. 또한 이 제거는 정확한 지오메트리를 복구하기 위한 뷰 종속 프롬프트, 조명 및 텍스처리스 렌더링의 중요성을 강조합니다.

5 DISCUSSION

드림퓨전은 다양한 텍스트 프롬프트에 대한 텍스트 대 3D 합성을 위한 효과적인 기술입니다. 이 기술은 확장 가능한 고품질 2D 이미지 확산 모델을 스코어 증류 샘플링과 NeRF와 유사한 렌더링 엔진을 통해 3D 영역으로 전송합니다. 드림퓨전은 3D 또는 멀티뷰 훈련 데이터가 필요하지 않으며 3D 합성을 위해 사전 훈련된 2D 확산 모델만 사용합니다.

하지만 한계가 있습니다. SDS는 이미지 샘플링을 위한 완벽한 손실 함수가 아니기 때문에 종종 과포화 및 과도하게 평활화된 결과를 생성합니다. 역 KL 발산의 모드 탐색 특성으로 인해 3D 결과는 무작위 시드 간에 거의 차이가 없습니다. 드림퓨전에 사용된 64x64 이미젠 모델은 합성된 모델에 미세한 디테일이 부족합니다. 디퓨전 및 뉴럴 렌더링 효율이 개선되면 향후에는 추적 가능한 고해상도 3D 합성이 가능해질 수 있습니다.

2D 관찰로부터 3D를 재구성하는 문제는 매우 불완전하고 본질적으로 모호합니다. 이 연구의 기법은 효과적이지만 보다 강력한 3D 선행 자료가 있으면 도움이 될 수 있습니다.

- Score Jacobian Chaining
    
    "점수 자코비안 체인"은 확산 모델에서 노이즈로부터 이미지를 생성하는 데 사용되는 기법입니다. 노이즈 변환 프로세스를 안내하여 원하는 출력과 일치하는 의미 있고 시각적으로 매력적인 이미지를 생성하는 데 도움이 됩니다. 간단히 말해, 일련의 중간 단계를 통해 노이즈와 최종 이미지를 연결하여 생성된 이미지가 목표와 잘 일치하도록 하는 수학적 방법입니다.
    
    점수 자코비안 연쇄는 확산 모델, 특히 이미지 생성 작업에 사용되는 고급 기법입니다. 이를 더 잘 이해하기 위해 구성 요소로 나누어 살펴보겠습니다:
    
    1. 점수: 확산 모델의 맥락에서 점수는 픽셀 값에 대한 이미지의 로그 확률의 기울기를 나타냅니다. 이는 이미지가 원하는 이미지를 나타내는 목표 분포에 얼마나 부합하는지를 측정하는 척도입니다.
    2. 자코비안: 자코비안은 함수의 일차 편미분을 나타내는 행렬입니다. 이 경우 이미지의 픽셀 값에 대한 점수의 변화율을 나타냅니다. 입력(노이즈)의 작은 변화가 출력(이미지)에 어떤 영향을 미치는지 이해하는 데 도움이 됩니다.
    3. 체이닝: 체이닝은 점수 자코비안을 반복적으로 적용하여 노이즈 변환을 유도하는 프로세스를 말합니다. 여러 단계를 거쳐 생성된 이미지가 목표 분포에 수렴하도록 합니다.
    
    스코어 자코비안 체인에서는 노이즈를 원하는 출력과 일치하는 의미 있고 시각적으로 매력적인 이미지로 변환하도록 유도하는 것이 목표입니다. 이는 로그 확률의 기울기를 고려하여 점수 자코비안을 반복적으로 적용하여 노이즈를 업데이트하는 방식으로 수행됩니다. 이 작업을 연쇄적으로 수행하면 노이즈가 점차 목표 분포와 잘 일치하는 이미지로 변환됩니다.
    
    전반적으로 점수 자코비안 연쇄는 점수의 기울기와 자코비안 행렬을 사용하여 노이즈 변환을 반복적으로 개선함으로써 확산 모델이 노이즈로부터 고품질 이미지를 생성하는 데 도움이 되는 고급 기법입니다.