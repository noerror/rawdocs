# SMAA: Enhanced Subpixel Morphological Antialiasing

[http://www.iryoku.com/smaa/downloads/SMAA-Enhanced-Subpixel-Morphological-Antialiasing.pdf](http://www.iryoku.com/smaa/downloads/SMAA-Enhanced-Subpixel-Morphological-Antialiasing.pdf)

[http://iryoku.com/smaa/](http://iryoku.com/smaa/)

- EUROGRAPHICS 2012

### 1. Introduction

앨리어싱은 컴퓨터 그래픽의 오랜 문제점으로, 이미지의 시각적 문제와 애니메이션의 깜박임을 유발합니다. 샘플링 속도를 높이면 이 문제를 줄일 수 있지만 비용이 많이 들기 때문에 실시간 사용에는 적합하지 않습니다. 최근 렌더링의 발전으로 많은 문제가 해결되었지만 에일리어싱은 여전히 중요한 장애물입니다.

![Crysis 2 게임에 통합된 SMAA 4x 예제입니다. 확대 부분은 MLAA [JME∗11], 우리의 새로운 SMAA T2x 및 4x 알고리즘과 참조로서의 MSAA 8x 간의 차이를 보여줍니다. 1080p 프레임의 경우, SMAA T2x의 평균 비용은 1.3 ms이며 SMAA 4x의 경우 2.6 ms로, NVIDIA GeForce GTX 470에서 측정되었습니다.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled.png)

Crysis 2 게임에 통합된 SMAA 4x 예제입니다. 확대 부분은 MLAA [JME∗11], 우리의 새로운 SMAA T2x 및 4x 알고리즘과 참조로서의 MSAA 8x 간의 차이를 보여줍니다. 1080p 프레임의 경우, SMAA T2x의 평균 비용은 1.3 ms이며 SMAA 4x의 경우 2.6 ms로, NVIDIA GeForce GTX 470에서 측정되었습니다.

전통적으로 이를 해결하는 가장 좋은 솔루션은 슈퍼샘플 안티앨리어싱(SSAA)과 멀티샘플 안티앨리어싱(MSAA)이었습니다. 하지만 MSAA는 샘플 수가 많아질수록 잘 확장되지 않고, 특정 렌더링 패러다임과 통합하기 어려우며, 특히 고화질 렌더링이 필요한 경우 많은 메모리를 소모하는 등의 한계가 있습니다.

최근에는 후처리 단계로 수행하는 앤티앨리어싱으로 초점이 옮겨가고 있습니다. 원래의 방법인 형태학적 앤티앨리어싱(MLAA)은 많은 새로운 기법으로 이어졌습니다. 그러나 이러한 기술은 주변 컨텍스트를 고려하지 않고 픽셀 간의 변화만 감지하고, 오브젝트 모양을 항상 보존하지 못하며, 특정 패턴이나 하위 픽셀 디테일을 제대로 처리하지 못하고, 스페큘러 및 음영 문제를 완전히 해결하지 못하는 등의 단점을 여전히 가지고 있습니다.

이러한 문제를 해결하기 위해 SMAA(향상된 서브픽셀 형태학적 앤티앨리어싱)라는 새로운 기술이 제안되었습니다. 이 기술은 문제를 세분화하여 모듈식 솔루션으로 각 문제를 개별적으로 해결합니다. 이 기술은 다양한 요구 사항과 하드웨어 구성을 충족할 수 있도록 다용도로 설계되었습니다.

### 2. Related Work

그래픽의 시각적 들쭉날쭉함을 줄여주는 실시간 안티앨리어싱에는 다양한 기술이 있습니다.

- 슈퍼샘플링 앤티앨리어싱(SSAA): 장면을 더 높은 해상도로 렌더링한 다음 원하는 해상도로 다운샘플링하는 방식입니다.
- 멀티샘플링 앤티앨리어싱(MSAA): 각 픽셀의 색상을 한 번만 계산하고 필터를 사용하여 샘플을 결합하는 SSAA의 변형된 방식입니다. 비용 절감을 목표로 하는 CSAA 및 EQAA와 같은 발전에도 불구하고 여전히 MSAA의 한계를 공유합니다.
- 디퍼드 셰이딩 및 라이팅 프리패스: 새로운 앤티앨리어싱 연구를 촉진하는 최신 렌더링 기법입니다. 최근의 많은 방법은 최종 이미지에 필터를 적용하여 에일리어싱을 후처리로 처리합니다. 목표는 들쭉날쭉한 가장자리를 감지하고 흐리게 처리하는 것입니다. 새로운 방법은 아니지만 고급 버전은 최근에야 게임에서 사용되기 시작했습니다. 그러나 이러한 방법은 MSAA보다 더 흐릿한 결과물을 만들 수 있습니다.
- 형태학적 앤티앨리어싱(MLAA): 최종 이미지의 색상 차이를 기반으로 픽셀 커버리지를 추정합니다. 원래 방식은 우수한 결과를 제공하지만 실시간에는 느립니다. 이 때문에 GPU와 플레이스테이션 3 SPU 등 다양한 하드웨어를 위한 더 빠른 버전이 개발되었습니다.
- 토폴로지 재구성 앤티앨리어싱(TMLAA): 토폴로지 데이터를 사용하여 이미지에서 서브픽셀 세부 정보를 복구합니다. 하지만 한계가 있습니다.
- 빠른 근사 앤티앨리어싱(FXAA): 피처를 감쇠시켜 서브픽셀 문제를 해결하지만 출력 품질이 항상 MSAA 품질에 미치지 못합니다.
- 가장자리 간 거리 앤티앨리어싱(DEAA) 및 GPAA 및 GBAA: 기하학적 데이터를 사용하여 더 나은 그라데이션을 생성하지만 서브픽셀 피처를 처리할 수 없으며 더 많은 계산 리소스가 필요합니다.
- 서브픽셀 재구성 앤티앨리어싱(SRAA): 일반 셰이딩과 슈퍼샘플링된 지오메트리 맵을 혼합하여 초고해상도 이미지를 생성한 다음 다운샘플링합니다. 하지만 추정치를 기반으로 하므로 품질이 낮은 그라데이션을 제공할 수 있습니다.
- 방향 적응형 에지 앤티앨리어싱: 더 나은 그라데이션 추정을 위해 MSAA 하위 샘플 값을 사용하지만 계산 비용이 많이 듭니다.
- 템포럴 앤티앨리어싱: 여러 프레임에 걸쳐 슈퍼샘플링 비용을 분산합니다. 이 연구에서도 이 방법을 고려합니다.

이 연구는 많은 방법이 특정 에일리어싱 문제에 초점을 맞추고 있지만 포괄적인 솔루션이 필요하다는 것을 시사합니다. 이 연구는 이러한 문제를 해결하기 위해 보다 총체적이고 모듈화된 접근 방식을 제공하는 것을 목표로 합니다.

### 3. Morphological Antialiasing

형태학적 앤티앨리어싱(MLAA):

- 개념: 형태학적 앤티앨리어싱(MLAA)은 원본 지오메트리의 픽셀 커버리지를 추정하는 것을 목표로 합니다. 앤티앨리어싱 트라이앵글을 래스터화할 때는 트라이앵글 내부의 각 픽셀에 대한 커버리지 영역을 결정하는 것이 중요합니다. 이렇게 하면 앞뒤 렌더링 순서가 주어졌을 때 픽셀이 배경과 매끄럽게 블렌딩됩니다.
- 기능: MLAA는 앤티앨리어싱이 적용되지 않은 이미지에서 작동합니다. 래스터화 프로세스를 역전시키는 방식을 사용합니다. 이미지의 실루엣을 재벡터화함으로써 MLAA는 커버리지 영역을 추론합니다. 래스터화 후에는 배경 정보가 손실되기 때문에 MLAA는 인접 픽셀이 원래 배경과 비슷하다고 가정하고 픽셀과 인접 픽셀을 블렌딩하여 즉석에서 처리합니다.
프로세스 시각화: 이 방법론은 그림 2에 설명되어 있지만, 더 깊이 이해하려면 Reshetov [Res09]의 원본 논문을 다시 살펴볼 필요가 있습니다.
    
    ![MLAA는 먼저 색상 이연성을 찾아서 변곡점을 찾습니다(녹색 선), 그리고 이를 일련의 사전 정의된 패턴 모양에 따라 분류하며, 이러한 패턴은 가상으로 재벡터화됩니다(파란색 선). 이를 통해 관련 픽셀의 커버리지 영역 a를 계산할 수 있습니다. 이러한 영역은 이웃과 혼합하는 데 사용됩니다. 예를 들어, 픽셀 Copp는 픽셀 Cold의 영역 a를 채웁니다: cnew = (1−a)· cold +a · copp.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%201.png)
    
    MLAA는 먼저 색상 이연성을 찾아서 변곡점을 찾습니다(녹색 선), 그리고 이를 일련의 사전 정의된 패턴 모양에 따라 분류하며, 이러한 패턴은 가상으로 재벡터화됩니다(파란색 선). 이를 통해 관련 픽셀의 커버리지 영역 a를 계산할 수 있습니다. 이러한 영역은 이웃과 혼합하는 데 사용됩니다. 예를 들어, 픽셀 Copp는 픽셀 Cold의 영역 a를 채웁니다: cnew = (1−a)· cold +a · copp.
    

원본 논문 포스트 개발:

- 변형: 레셰토프의 중요한 연구 이후, MLAA의 여러 구현이 등장했으며, 그중에서도 빠른 속도와 문서화 측면에서 두드러진 것은 히메네즈의 MLAA[JME∗11]였습니다.
- 히메네즈 MLAA의 고유한 특징: 히메네즈의 접근 방식은 상당한 성능 이점을 제공하는 특수 텍스처 구조를 사용하는 데 중점을 둡니다. 이러한 텍스처는 에지, 커버리지 영역, 미리 계산된 블렌딩 영역의 위치를 정확히 찾아내는 데 도움이 됩니다.
- 알고리즘 단계:
    - 가장자리 감지: 알고리즘은 깊이 또는 휘도(루마) 정보를 사용하여 먼저 가장자리를 감지합니다.
    - 패턴 감지 및 커버리지 계산: 여기서 알고리즘은 가장자리의 패턴을 식별합니다. 이는 가장자리의 양쪽 끝을 결정하고 하드웨어 이선 필터링을 통해 필요한 반복을 절반으로 줄임으로써 이루어집니다. 양쪽 끝이 확인되면 알고리즘은 교차 에지(검색 방향에 수직인 에지)를 식별합니다. 이 데이터는 패턴을 쉽게 분류하는 데 도움이 됩니다.
    - 최종 블렌딩: 알고리즘은 교차하는 에지의 길이와 정보를 사용하여 미리 계산된 텍스처에서 한 단계 만에 커버리지 영역을 검색할 수 있습니다. 그런 다음 최종 블렌딩 프로세스에 사용됩니다.
- 시각적 표현: 그림 3은 이 프로세스의 여러 단계와 요소를 그래픽으로 보여줍니다.
- 시작점: 설명한 알고리즘의 기초는 Jimenez의 MLAA이지만, 더 자세한 내용은 원본 문서 [JME∗11]를 참조하는 것이 가장 좋습니다.

### 4. SMAA: Features and Algorithm

엣지 감지

- 중요성: 적절한 엣지 감지는 앤티앨리어싱에 매우 중요합니다. 가장자리를 놓치면 들쭉날쭉한 이미지가 발생하고 가장자리를 과도하게 흐리게 처리하면 최종 이미지 품질이 저하됩니다.
    
    ![(a) 입력 이미지로, 빨간색 선으로 표시된 원하는 근사와 녹색으로 표시된 커버리지 영역. (b) 원래 알고리즘 [Res09]에서의 사전 정의된 패턴. (c) Jimenez의 GPU 구현 [JME∗11]에서의 사전 계산된 영역 텍스처. (d) 검출된 모서리. (e) 계산된 커버리지 영역. (f) 최종 혼합. 우리의 SMAA 알고리즘은 (b)와 (c)를 확장하여 날카로운 기하학적 특징과 대각선 처리를 위해 전체 파이프라인을 수정합니다. 로컬 대비 적응은 (d)에서 잘못된 모서리를 제거합니다. 확장된 패턴 감지와 정확한 검색은 (e)에서 정확도를 향상시킵니다. SMAA는 (f)에서 정확한 서브픽셀 기능과 시간 초과 샘플링을 위해 추가 샘플을 처리할 수 있습니다.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%202.png)
    
    (a) 입력 이미지로, 빨간색 선으로 표시된 원하는 근사와 녹색으로 표시된 커버리지 영역. (b) 원래 알고리즘 [Res09]에서의 사전 정의된 패턴. (c) Jimenez의 GPU 구현 [JME∗11]에서의 사전 계산된 영역 텍스처. (d) 검출된 모서리. (e) 계산된 커버리지 영역. (f) 최종 혼합. 우리의 SMAA 알고리즘은 (b)와 (c)를 확장하여 날카로운 기하학적 특징과 대각선 처리를 위해 전체 파이프라인을 수정합니다. 로컬 대비 적응은 (d)에서 잘못된 모서리를 제거합니다. 확장된 패턴 감지와 정확한 검색은 (e)에서 정확도를 향상시킵니다. SMAA는 (f)에서 정확한 서브픽셀 기능과 시간 초과 샘플링을 위해 추가 샘플을 처리할 수 있습니다.
    
    ![포스트 프로세싱 앤티엘리어싱 필터의 주요 약점 개요(열)와 SMAA의 핵심 요소가 이를 어떻게 처리하는지(행).](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%203.png)
    
    포스트 프로세싱 앤티엘리어싱 필터의 주요 약점 개요(열)와 SMAA의 핵심 요소가 이를 어떻게 처리하는지(행).
    
- 감지를 위한 루마: 루마 선택은 네 가지 고려 사항을 기반으로 합니다:
    - MLAA는 컬러 기반 불연속성을 기대합니다.
    - 색상 정보가 항상 존재합니다.
    - 음영 앨리어싱을 처리합니다.
    - 효율적입니다.
- 로컬 콘트라스트 적응: 사람의 눈은 높은 대비로 둘러싸여 있을 때 낮은 대비의 가장자리를 가릴 수 있습니다. 따라서 잘못된 가장자리를 방지하기 위해 SMAA는 지각적으로 보이는 가장자리와 그렇지 않은 가장자리를 구분하는 적응형 이중 임계값을 사용합니다.
    
    ![상단: 녹색 모서리의 지배적인 대비는 허위적인 빨간색 교차 모서리를 가리야 합니다(왼쪽). 이 로컬 대비를 고려하지 않으면 아티팩트가 발생합니다(가운데). 우리의 SMAA 알고리즘은 이를 수정합니다(오른쪽). 하단 왼쪽: 주어진 픽셀(점으로 표시)의 왼쪽 경계(오렌지)와 이를 지배할 수 있는 주변 후보 모서리(파랑). 인간 시청자에게 보이지 않게 만듭니다. 하단 가운데: 상단 경계 시나리오. 하단 오른쪽: 실제로 계산된 후보 주변 모서리.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%204.png)
    
    상단: 녹색 모서리의 지배적인 대비는 허위적인 빨간색 교차 모서리를 가리야 합니다(왼쪽). 이 로컬 대비를 고려하지 않으면 아티팩트가 발생합니다(가운데). 우리의 SMAA 알고리즘은 이를 수정합니다(오른쪽). 하단 왼쪽: 주어진 픽셀(점으로 표시)의 왼쪽 경계(오렌지)와 이를 지배할 수 있는 주변 후보 모서리(파랑). 인간 시청자에게 보이지 않게 만듭니다. 하단 가운데: 상단 경계 시나리오. 하단 오른쪽: 실제로 계산된 후보 주변 모서리.
    

패턴 처리

- 선명한 기하학적 특징: MLAA에서는 실루엣을 리벡터라이즈할 때 날카로운 모서리를 둥글게 처리하는 경향이 있습니다. SMAA는 실제 모서리를 감지하고 덜 공격적인 처리를 적용하여 개체의 실제 모양을 보존함으로써 이 문제를 개선합니다.
    
    ![왼쪽: 안티엘리어싱이 없는 것(상단), 일반 MLAA 접근(가운데), 그리고 SMAA 결과(하단) 간의 비교. SMAA가 객체의 원래 형태를 훨씬 더 잘 유지하는 반면, MLAA는 그 형태를 둥그렇게 만들려는 경향이 있습니다. 오른쪽: 모서리에는 길이가 최소 두 개인 교차 모서리가 있습니다(두 번째 픽셀 열 참조), 반면 에일리어싱된 윤곽선은 길이가 픽셀 하나인 교차 모서리만 있습니다(오른쪽으로의 계단). 일반적인 모서리(빨강)뿐만 아니라 확장된 교차 모서리(오렌지)를 가져오면, 두 경우를 구별할 수 있게 되어, 모서리를 둥그렇게 만들기보다 더 정확한 재벡터화(분홍)를 제공합니다.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%205.png)
    
    왼쪽: 안티엘리어싱이 없는 것(상단), 일반 MLAA 접근(가운데), 그리고 SMAA 결과(하단) 간의 비교. SMAA가 객체의 원래 형태를 훨씬 더 잘 유지하는 반면, MLAA는 그 형태를 둥그렇게 만들려는 경향이 있습니다. 오른쪽: 모서리에는 길이가 최소 두 개인 교차 모서리가 있습니다(두 번째 픽셀 열 참조), 반면 에일리어싱된 윤곽선은 길이가 픽셀 하나인 교차 모서리만 있습니다(오른쪽으로의 계단). 일반적인 모서리(빨강)뿐만 아니라 확장된 교차 모서리(오렌지)를 가져오면, 두 경우를 구별할 수 있게 되어, 모서리를 둥그렇게 만들기보다 더 정확한 재벡터화(분홍)를 제공합니다.
    
    - 이 방법을 사용하면 모서리가 단순히 울퉁불퉁한 모서리인지 아니면 물체의 실제 모서리인지 구분할 수 있습니다.
    - 긴 가장자리를 검사함으로써 시스템은 날카로운 모서리를 더 잘 인식하고 물체의 실제 모양을 유지할 수 있습니다.
    - 이러한 모서리를 얼마나 둥글게 처리할지 결정하는 데 계수 r이 사용됩니다.
- 대각선 패턴: 기존 기술에서는 대각선을 간과하는 경우가 많아 앤티앨리어싱 결과가 좋지 않습니다. SMAA는 대각선 패턴 감지 기능을 도입하여 대각선의 에일리어싱을 개선합니다.
    
    ![45도 근접 대각선의 MLAA(왼쪽)와 SMAA(가운데) 재벡터화(파란색 선). 대각선 패턴(녹색 선) 처리 덕분에 SMAA는 모서리를 정확하게 재구성합니다. 오른쪽: 우리의 방법은 직교하는 경우와 같은 정보만 필요로 합니다: 거리 dl과 dr; 그리고 교차하는 모서리 e1과 e2(오른쪽).](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%206.png)
    
    45도 근접 대각선의 MLAA(왼쪽)와 SMAA(가운데) 재벡터화(파란색 선). 대각선 패턴(녹색 선) 처리 덕분에 SMAA는 모서리를 정확하게 재구성합니다. 오른쪽: 우리의 방법은 직교하는 경우와 같은 정보만 필요로 합니다: 거리 dl과 dr; 그리고 교차하는 모서리 e1과 e2(오른쪽).
    
    - 이 방법은 직선을 찾는 표준 접근 방식(직교 재벡터화)만 사용하는 것이 아니라 대각선 패턴이 감지되면 대각선 재벡터화를 사용합니다. 즉, 대각선이 부드럽고 선명하게 보이도록 특별한 처리를 거칩니다.
    - 이러한 대각선을 처리하는 방법은 기존 기술에서 영감을 얻었지만 대각선 패턴에 맞게 조정되었습니다. 특히 사전 계산된 텍스처가 사용됩니다. 이 텍스처는 대각선의 특성(대각선 끝까지의 거리, 교차하는 대각선 가장자리에 대한 정보 등)을 입력으로 받은 다음 해당 대각선에 대한 올바른 적용 영역을 제공합니다.
        
        ![대각선 패턴 맵(왼쪽)과 그들의 사전 계산된 영역 텍스처(오른쪽).](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%207.png)
        
        대각선 패턴 맵(왼쪽)과 그들의 사전 계산된 영역 텍스처(오른쪽).
        
    - 이 프로세스를 위해 정의된 단계가 있습니다:
        - 이 방법은 먼저 대각선 끝까지의 거리를 결정하는 것으로 시작합니다.
        - 그런 다음 교차하는 가장자리를 가져옵니다.
        - 이렇게 수집된 정보를 사용하여 미리 계산된 텍스처에 액세스하여 특정 대각선 패턴에 대한 정확한 커버리지 영역을 제공합니다.
    - 이 대각선 감지는 표준 직교 패턴 감지 전에 수행됩니다. 대각선 패턴이 발견되지 않으면 이 메서드는 기본적으로 표준 직교 감지를 사용합니다. 그렇지 않으면 대각선 패턴 감지의 정보가 사용됩니다.
- 정확한 거리 검색: 에지 거리를 정확하게 찾는 것은 패턴 감지에 매우 중요합니다. 히메네즈의 MLAA는 하드웨어 보간을 사용하여 이 프로세스를 가속화했지만, 교차하는 에지를 간과할 수 있었습니다. SMAA는 이 접근 방식을 2D 액세스에 일반화하여 단일 메모리 액세스에서 4개의 서로 다른 값을 가져올 수 있도록 합니다.
    
    ![상단 왼쪽: 수평 모서리의 왼쪽 끝을 찾기 위한 검색 예(시작 위치는 점으로 표시). 상단 오른쪽: Jimenez의 MLAA(오렌지색 점)에서 수행된 하드웨어 필터링 액세스는 오렌지색 모서리만 확인합니다. SMAA 양선형 액세스(녹색 점)는 모든 교차하는 모서리(녹색)도 추가로 확인할 수 있습니다. 이 예에서는 첫 번째 교차하는 모서리를 찾을 때 검색이 중지되며, 수평 모서리의 왼쪽 끝에서 종료되지 않습니다. 하단 왼쪽: 검색의 다양한 반복(다른 색으로 표시)과 Jimenez의 MLAA에 의해 가져온 값들입니다. 모든 교차하는 모서리(파란색)를 놓친다는 것을 주목하세요. 하단 오른쪽: SMAA에 의해 가져온 동일한 반복과 값들입니다. 단일 메모리 액세스로 네 개의 다른 픽셀(그림자 픽셀)을 확인할 수 있는 것을 볼 수 있습니다.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%208.png)
    
    상단 왼쪽: 수평 모서리의 왼쪽 끝을 찾기 위한 검색 예(시작 위치는 점으로 표시). 상단 오른쪽: Jimenez의 MLAA(오렌지색 점)에서 수행된 하드웨어 필터링 액세스는 오렌지색 모서리만 확인합니다. SMAA 양선형 액세스(녹색 점)는 모든 교차하는 모서리(녹색)도 추가로 확인할 수 있습니다. 이 예에서는 첫 번째 교차하는 모서리를 찾을 때 검색이 중지되며, 수평 모서리의 왼쪽 끝에서 종료되지 않습니다. 하단 왼쪽: 검색의 다양한 반복(다른 색으로 표시)과 Jimenez의 MLAA에 의해 가져온 값들입니다. 모든 교차하는 모서리(파란색)를 놓친다는 것을 주목하세요. 하단 오른쪽: SMAA에 의해 가져온 동일한 반복과 값들입니다. 단일 메모리 액세스로 네 개의 다른 픽셀(그림자 픽셀)을 확인할 수 있는 것을 볼 수 있습니다.
    
    - 에지 거리의 중요성: 가장자리 사이의 거리(또는 선의 양쪽 끝까지의 길이)는 패턴 유형을 분류하는 데 필수적입니다. 이 분류는 패턴을 처리하는 방법을 안내합니다.
    - 이전에 개발된 방법 중 하나인 Jimenez의 MLAA(형태학적 앤티앨리어싱)는 하드웨어 가속을 사용하여 이러한 에지 거리를 빠르게 추정합니다. 이 접근 방식은 하드웨어를 사용하여 값 사이를 보간하는 기술인 이중 선형 필터링을 사용하여 이 프로세스의 속도를 높입니다. 이를 통해 한 번의 메모리 액세스로 여러 값을 가져와 처리할 수 있으므로 절차가 더 빠르고 효율적입니다.
    - 효율적이라는 장점에도 불구하고 히메네즈의 방법에는 검색 중에 교차하는 에지를 항상 확인하지는 않는다는 단점이 있습니다. 교차 에지는 연구 중인 주요 에지와 교차하는 에지입니다. 이를 무시하면 패턴을 식별하는 데 실수가 발생할 수 있습니다.
    - 히메네즈 방법의 한계를 고수하는 대신, 한 번의 메모리 액세스로 더 많은 데이터를 가져오는 개선된 접근 방식이 제안되었습니다. 히메네즈의 방법처럼 한 번에 두 개의 값만 가져오는 대신, 이 개선된 접근 방식은 한 번에 네 개의 서로 다른 값을 가져올 수 있습니다. 이는 여러 교차 에지가 있는 복잡한 패턴을 이해하려고 할 때 특히 유용합니다.
    - 작동 방식: 새로운 방법은 네 개의 이진 값에 대한 이선 보간을 사용합니다. 간단히 말해, 이미지의 네 지점에서 얻은 정보를 영리하게 결합하여 단일 값을 얻습니다. 그런 다음 이 방법은 이 단일 값을 디코딩하여 원래의 네 가지 값을 이해할 수 있습니다. 이 프로세스를 통해 시스템은 더 많은 데이터에 동시에 액세스할 수 있으므로 계산 부담을 크게 늘리지 않고도 에지 거리를 더 정확하게 검색할 수 있습니다.

서브픽셀 렌더링:

- MLAA는 픽셀당 하나의 샘플로만 작동합니다. 이로 인해 실제 서브픽셀 특징을 복구하는 데 문제가 발생합니다.
- 멀티샘플 앤티앨리어싱(MSAA)과 함께 MLAA를 사용하면 이미지가 흐릿해질 수 있습니다. 이는 MLAA와 MSAA가 샘플의 커버리지에 대해 서로 다른 가정을 하기 때문입니다.
    
    ![AA 없음, MLAA [JME∗11] 및 SMAA 1x에게 어려운 사례: 중거리(상단)에서 검은 배경 위에 흰색 그리드로, 정확한 커버리지의 재구성을 방해합니다. 더 긴 거리에서(하단, 확대됨) 그리드의 연속성이 끊어져서 그리드의 복구가 불가능하게 됩니다. 날카로운 기하학적 특징을 다루고 올바른 오프셋을 사용하여 MSAA 4x 참조로 수렴하는 SMAA S2x와 4x에 대한 더 정확한 영역 추정을 허용합니다. MLAA가 MSAA 4x 샘플에서 얼룩덜룩한 적용은 그리드의 연결성을 향상시키지만 흐릿한 아티팩트가 나타납니다. 이것은 MLAA와 유사한 해결책 중에서 가장 많이 사용되는 FXAA 3.11(사전 설정 39, 최대. 품질)을 사용하여 동일한 테스트를 수행했습니다. 부록의 그림 3, 4, 5는 추가적인 MSAA 모드 및 AA 필터를 사전 및 사후 해결로 확장합니다.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%209.png)
    
    AA 없음, MLAA [JME∗11] 및 SMAA 1x에게 어려운 사례: 중거리(상단)에서 검은 배경 위에 흰색 그리드로, 정확한 커버리지의 재구성을 방해합니다. 더 긴 거리에서(하단, 확대됨) 그리드의 연속성이 끊어져서 그리드의 복구가 불가능하게 됩니다. 날카로운 기하학적 특징을 다루고 올바른 오프셋을 사용하여 MSAA 4x 참조로 수렴하는 SMAA S2x와 4x에 대한 더 정확한 영역 추정을 허용합니다. MLAA가 MSAA 4x 샘플에서 얼룩덜룩한 적용은 그리드의 연결성을 향상시키지만 흐릿한 아티팩트가 나타납니다. 이것은 MLAA와 유사한 해결책 중에서 가장 많이 사용되는 FXAA 3.11(사전 설정 39, 최대. 품질)을 사용하여 동일한 테스트를 수행했습니다. 부록의 그림 3, 4, 5는 추가적인 MSAA 모드 및 AA 필터를 사전 및 사후 해결로 확장합니다.
    
- MLAA는 주로 물체의 실루엣을 위해 설계되었기 때문에 가는 선과 멀리 있는 물체의 디테일을 처리하는 데 어려움을 겪습니다.
- 결과를 개선하려면 서브픽셀 특징에 MLAA를 적용할 때 선명한 기하학적 특징 감지가 필요합니다.
- MLAA는 모든 샘플이 픽셀의 중앙에 있다고 가정합니다. 이는 문제가 있으며 흐릿한 결과를 초래합니다.
- 해결책은 픽셀 내 각 서브샘플의 실제 위치를 고려하는 것입니다. 이렇게 하면 하위 샘플 그룹을 블렌딩할 때 픽셀 중앙의 평균 색상을 얻을 수 있습니다.

SMAA 변형:

![왼쪽, 상단: 일반적인 MSAA 2x 패턴, 오프셋은 (−0.25,0.25) 및 (0.25,−0.25) 입니다. 왼쪽, 하단: 멀티/수퍼샘플링을 MLAA(SMAA S2x 및 T2x)와 결합하기 위해, 상단 및 하단의 서브샘플 (핑크와 오렌지) 사이의 평균이 픽셀의 중심에 있는 색상 (파랑)에 해당하도록 영역 계산을 오프셋해야 합니다. 중간: MLAA 영역 계산은 픽셀의 중심 (파랑)에서 재벡터화를 추정하기 위해 고안되었습니다. SMAA S2x 및 T2x의 경우, 이러한 영역은 −0.25 (핑크) 및 +0.25 (오렌지)로 오프셋되어야 합니다. 오른쪽: 공간 멀티샘플링 및 시간 수퍼샘플링에서 오는 네 개의 서브샘플 (SMAA 4x)을 결합하는 예, SMAA S2x의 두 개의 지터 결과 (보라색 및 녹색)를 사용하여.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%2010.png)

왼쪽, 상단: 일반적인 MSAA 2x 패턴, 오프셋은 (−0.25,0.25) 및 (0.25,−0.25) 입니다. 왼쪽, 하단: 멀티/수퍼샘플링을 MLAA(SMAA S2x 및 T2x)와 결합하기 위해, 상단 및 하단의 서브샘플 (핑크와 오렌지) 사이의 평균이 픽셀의 중심에 있는 색상 (파랑)에 해당하도록 영역 계산을 오프셋해야 합니다. 중간: MLAA 영역 계산은 픽셀의 중심 (파랑)에서 재벡터화를 추정하기 위해 고안되었습니다. SMAA S2x 및 T2x의 경우, 이러한 영역은 −0.25 (핑크) 및 +0.25 (오렌지)로 오프셋되어야 합니다. 오른쪽: 공간 멀티샘플링 및 시간 수퍼샘플링에서 오는 네 개의 서브샘플 (SMAA 4x)을 결합하는 예, SMAA S2x의 두 개의 지터 결과 (보라색 및 녹색)를 사용하여.

- SMAA 1x: 거리 검색, 로컬 콘트라스트 적응, 선명한 기하학적 특징 감지, 대각선 패턴 감지 등의 기능을 포함합니다.
- SMAA S2x: SMAA 1x 기능에 공간 멀티 샘플링을 추가합니다.
- SMAA T2x: SMAA 1x 특징에 시간적 슈퍼샘플링을 추가합니다.
- SMAA 4x: 공간 및 시간 멀티/슈퍼샘플링을 모두 SMAA 1x 피처와 결합합니다.

템포럴 리프로젝션:

- 단순히 템포럴 슈퍼샘플링만 사용하면 고스트 아티팩트가 발생할 수 있습니다.
- 이 기술은 순진한 프레임 블렌딩 대신 이전 프레임의 서브샘플을 현재 프레임에 재투영합니다.
이전 프레임에서는 가려졌지만 현재 프레임에서는 보이는 영역에는 여전히 문제가 있습니다. 이러한 영역에는 잔여 아티팩트가 표시될 수 있습니다.
- 해결책은 현재 프레임과 이전 프레임의 속도 차이에 따라 이전 프레임의 하위 샘플에 가중치를 부여하는 것입니다.
- 그 결과 앤티앨리어싱이 적용되지 않더라도 이전에 가려진 영역을 더 잘 처리할 수 있습니다. 그러나 MLAA 또는 공간 멀티샘플링은 일반적으로 이러한 영역을 처리하여 문제를 효과적으로 완화할 수 있습니다.
- 한 가지 남은 문제는 형태학적 앤티앨리어싱 기법으로 인해 오브젝트 실루엣의 양쪽 픽셀이 서브픽셀 수준에서 블렌딩되는 문제입니다. 속도 맵은 에일리어싱된 상태로 유지되므로 앤티앨리어싱된 픽셀로 전파되지 않아 움직이는 오브젝트 뒤에 흔적이 남을 수 있습니다.
- 이 문제를 해결하기 위해 속도 버퍼에도 SMAA를 적용하여 속도가 블렌딩된 픽셀에 전파될 수 있도록 하는 것입니다.
    
    ![왼쪽: 단순한 해석을 사용하면 눈에 띄는 유령 현상이 발생합니다. 가운데: 재투영은 이러한 아티팩트를 완화시키지만 완전히 제거하지는 않습니다. 오른쪽: 속도 가중치의 추가로 유령 현상을 완전히 제거할 수 있습니다.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%2011.png)
    
    왼쪽: 단순한 해석을 사용하면 눈에 띄는 유령 현상이 발생합니다. 가운데: 재투영은 이러한 아티팩트를 완화시키지만 완전히 제거하지는 않습니다. 오른쪽: 속도 가중치의 추가로 유령 현상을 완전히 제거할 수 있습니다.
    

### 5. Results

비교 메트릭:

- 로컬 콘트라스트: 기존 방법(예: MLAA)은 그라데이션이 있는 경우 패턴을 놓칠 수 있습니다. 제안된 SMAA 방식은 이러한 영역을 올바르게 앤티앨리어싱하여 이 문제를 개선합니다.
- 대각선 패턴 감지: 기존의 포스트 프로세싱은 특히 대각선 패턴에서 에일리어싱 아티팩트를 생성할 수 있습니다. SMAA는 더 깨끗한 대각선을 생성합니다.
- 선명한 기하학적 특징: SMAA는 날카로운 모서리를 유지하고 모양이 둥글어지는 것을 방지하므로 물체 모양을 정확하게 재구성하는 데 필수적입니다.
- 정확한 검색: 가장자리를 맹목적으로 따라가면 패턴 감지 실패가 발생할 수 있는데, SMAA는 메모리 액세스를 늘리지 않고도 정확한 검색을 보장하여 이를 방지합니다.
- 서브픽셀 기능: 1배 해상도 컬러 입력을 사용하는 포스트 프로세싱 기술은 종종 서브픽셀 디테일을 놓쳐 다양한 아티팩트를 유발합니다. SMAA의 T2x 모드는 선의 연결성을 더 잘 보존하여 SSAA 16x로 얻은 결과와 매우 유사합니다.
- 더 나은 폴백: SMAA 모드는 한 구성 요소가 에지를 처리하지 못할 경우 다른 구성 요소가 이를 백업할 수 있도록 추가적인 견고성을 제공합니다.
    
    ![SMAA는 SSAA 16x와 가까운 결과를 제공할 수 있으며, SMAA T2x는 가장 빠른 MLAA 구현과 동등한 성능을 갖습니다 [JME∗11]. 개선된 가장자리/패턴 감지는 어려운 경우에도 안티앨리어싱을 할 수 있게 해줍니다 (첫 번째 열). 대각선 패턴 감지는 이러한 형태의 정확한 재구성을 가능하게 합니다 (두 번째 열). 날카로운 기하학적 특징의 감지는 모서리와 교차점을 더 잘 재구성할 수 있게 해줍니다 (첫 번째 열의 두 번째 창 및 세 번째 열의 안테나 기초 참조). 정확한 검색은 어려운 시나리오에서 패턴을 감지할 수 있게 해줍니다 (네 번째 열). 서브픽셀 특징 처리는 연결성을 유지하고 먼 객체를 정확하게 표현할 수 있게 해줍니다 (다섯 번째 및 여섯 번째 열). 저대비 가장자리가 있는 영역에서는 MSAA 2x로 되돌아갑니다 (일곱 번째 열), 이는 좋은 결과를 제공하며 성능을 향상시킵니다.](SMAA%20Enhanced%20Subpixel%20Morphological%20Antialiasing%2016f5d1c52ca54fd596c0b3a56b1f813d/Untitled%2012.png)
    
    SMAA는 SSAA 16x와 가까운 결과를 제공할 수 있으며, SMAA T2x는 가장 빠른 MLAA 구현과 동등한 성능을 갖습니다 [JME∗11]. 개선된 가장자리/패턴 감지는 어려운 경우에도 안티앨리어싱을 할 수 있게 해줍니다 (첫 번째 열). 대각선 패턴 감지는 이러한 형태의 정확한 재구성을 가능하게 합니다 (두 번째 열). 날카로운 기하학적 특징의 감지는 모서리와 교차점을 더 잘 재구성할 수 있게 해줍니다 (첫 번째 열의 두 번째 창 및 세 번째 열의 안테나 기초 참조). 정확한 검색은 어려운 시나리오에서 패턴을 감지할 수 있게 해줍니다 (네 번째 열). 서브픽셀 특징 처리는 연결성을 유지하고 먼 객체를 정확하게 표현할 수 있게 해줍니다 (다섯 번째 및 여섯 번째 열). 저대비 가장자리가 있는 영역에서는 MSAA 2x로 되돌아갑니다 (일곱 번째 열), 이는 좋은 결과를 제공하며 성능을 향상시킵니다.
    

성능 및 메모리:

- SMAA의 T2x 및 4x 모드는 포워드 렌더링 시나리오에서 MSAA 8배 이상의 성능을 발휘합니다. SMAA의 메모리 소비량도 MSAA 8배보다 훨씬 낮습니다.
- 전반적인 품질 측면에서 SMAA의 성능은 SSAA 16배에 더 근접한 것으로 알려져 있습니다.
- 특히 추가 멀티샘플링을 고려할 때 SMAA 모드의 실행 시간은 다른 기술과 경쟁력이 있습니다. 각 SMAA 솔루션의 오버헤드는 무시할 수 있거나 매우 저렴한 것으로 설명됩니다.

요약하면, SMAA 방식은 기존의 안티앨리어싱 기법에 비해 효율적이고 품질이 우수한 솔루션입니다. 테스트 결과에 따르면 시각적으로 더 만족스러운 결과를 제공할 뿐만 아니라 성능 및 메모리 사용량 지표도 더 나은 것으로 나타났습니다.

### 6. Conclusions

저자들은 필터 기반 앤티앨리어싱 솔루션의 결함을 해결하기 위한 고급 기술을 발표했습니다. 이는 필터 기반 안티앨리어싱과 표준 멀티/슈퍼샘플링 방법론 및 템포럴 리젝션을 병합하여 달성했습니다. 주요 내용은 다음과 같습니다:

- 참신성: 필터 기반 안티앨리어싱 방식과 공간 및 시간 멀티/슈퍼샘플링이 결합된 것은 이번이 처음입니다. 이 독특한 조합을 통해 각 방법론의 장점을 통합하여 한 구성 요소가 실패하거나 부적절할 경우 다른 구성 요소가 이를 보완할 수 있는 강력한 안티앨리어싱 솔루션이 탄생했습니다.
- 디퍼드 엔진의 중요성: 저자들은 SMAA를 사용하면 일반적으로 안티앨리어싱 품질이 포워드 렌더링 엔진보다 뒤처지는 디퍼드 렌더링 엔진도 비슷한 수준의 우수성을 달성할 수 있다고 주장합니다.

저자들은 고유한 기술과 여러 모드가 결합된 SMAA가 다양한 렌더링 엔진을 괴롭혀 온 앤티앨리어싱 문제를 해결할 수 있는 다양하고 효율적이며 고품질의 솔루션을 제공한다고 결론지었습니다.