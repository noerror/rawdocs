# FFHQ-UV: Normalized Facial UV-Texture Dataset for 3D Face Reconstruction

[https://arxiv.org/abs/2211.13874](https://arxiv.org/abs/2211.13874)

[https://github.com/csbhr/FFHQ-UV](https://github.com/csbhr/FFHQ-UV)

[https://github.com/csbhr/FFHQ-UV/blob/main/README_dataset.md](https://github.com/csbhr/FFHQ-UV/blob/main/README_dataset.md) 데이터셋

1

이 논문에서는 컴퓨터 비전 및 그래픽 커뮤니티에서 중요한 작업인 단일 또는 여러 이미지에서 얼굴의 3D 모양과 텍스처를 재구성하는 데 따르는 어려움과 해결책을 논의합니다. 주요 초점은 다양한 조명 조건에서 머리카락이나 액세서리와 같은 불필요한 요소 없이 얼굴의 정체성을 보존하는 고품질 텍스처 맵을 복구하는 것입니다.

간핏(GANFIT)이나 아바타미(AvatarMe)와 같은 이전 방법도 이를 개선하기 위해 노력했지만, 조명이 고르지 않거나 훈련용 데이터가 제한되는 등의 한계가 있었습니다. 이러한 한계로 인해 텍스처 맵이 다양한 조명 조건에 적합하지 않거나 충실도가 부족한 경우가 많았습니다.

이러한 문제를 극복하기 위해 이 논문에서는 새로운 접근 방식을 제안합니다. 저자들은 StyleGAN 기반 이미지 편집을 사용하여 하나의 자연 이미지에서 다중 뷰 정규화된 얼굴을 생성하는 자동적이고 강력한 파이프라인을 개발합니다. 그런 다음 불완전한 3D 형상 추정으로 인한 아티팩트를 수정하기 위해 UV 텍스처 추출, 보정 및 완성 프로세스를 구축합니다.

이 파이프라인을 사용하여 저자들은 공개적으로 사용 가능한 고품질의 대규모 얼굴 UV 텍스처 데이터 세트인 FFHQ-UV 데이터 세트를 만들었습니다. 이 데이터 세트는 FFHQ 데이터 세트를 기반으로 하며, 50,000개 이상의 균일한 조명의 얼굴 텍스처 UV 맵으로 구성되어 있습니다. 이러한 텍스처 맵은 사실적인 디지털 휴먼 렌더링을 위한 페이셜 에셋으로 바로 사용할 수 있습니다.

마지막으로 저자들은 FFHQ-UV 데이터세트로 훈련된 GAN 기반 텍스처 디코더를 기반으로 3D 얼굴 재구성 알고리즘을 개발했습니다. 저자들은 이 알고리즘이 충실도와 품질 측면에서 기존 접근 방식보다 성능이 뛰어나다고 주장합니다.

2. Related Work

이 섹션에서는 3D 얼굴 재구성 및 텍스처 복구의 기술적 측면에 대해 자세히 살펴봅니다.

Blanz와 Vetter가 소개한 3D 모퍼블 모델(3DMM)은 3D 얼굴 모델을 모양과 텍스처 기반의 선형 조합으로 표현합니다. 이 모델은 위상적으로 정렬된 3D 얼굴 모델에서 주성분 분석(PCA)을 사용하여 도출되었습니다. 이미지에서 3D 얼굴 모델을 재구성하는 과정에는 일반적으로 최적화 기반 피팅 또는 학습 기반 회귀 접근법을 사용하여 3DMM 파라미터를 추정하는 작업이 포함됩니다. PCA 기반의 선형 기저는 한계가 있기 때문에 3DMM의 표현 능력을 향상시키기 위해 다양한 비선형 기저가 개발되었습니다. 신경망 기반의 비선형 3DMM 기저를 사용하면 3D 얼굴 재구성은 메시 디코더 또는 텍스처 디코더에 가장 적합한 잠재 코드를 찾는 작업으로 전환됩니다.

텍스처 복구도 상당한 발전을 이루었습니다. 원래 3DMM의 텍스처 기준은 메시의 정점 색상으로 표현되었지만, 최근의 방법은 고해상도 렌더링을 위해 UV 맵 텍스처 표현을 사용합니다. 이러한 방법은 일반적으로 저품질 텍스처 맵을 고품질 텍스처 맵으로 변환하는 이미지 변환 기반 접근 방식과 텍스처 디코더를 비선형 3DMM 텍스처 베이스로 훈련하는 텍스처 디코더 기반 접근 방식의 두 가지 범주로 나뉩니다. 두 접근 방식 모두 학습을 위해 고품질 UV 텍스처 데이터 세트가 필요합니다. 안타깝게도 실제 적용에 충분한 다양성을 제공할 만큼 충분히 큰 규모의 고품질 얼굴 UV 텍스처 데이터 세트는 공개적으로 사용 가능한 것이 없습니다.

얼굴 이미지 노멀라이제이션은 얼굴 이미지를 편집하여 조명이 고르게 비춰지고 중립적인 표정과 포즈를 취하도록 하는 과정입니다. 저자들은 얼굴 이미지에서 고품질의 '정규화된' 텍스처 맵을 추출하는 것을 목표로 합니다. 하나의 이미지에서 정면, 왼쪽, 오른쪽의 세 가지 얼굴 이미지를 얻고자 합니다. 이를 위해 최근 발전한 StyleGAN 기반 이미지 편집 접근법을 활용합니다. 이 방법에서는 먼저 GAN 반전 방법을 통해 이미지를 FFHQ에서 사전 학습한 StyleGAN 모델의 잠재 코드에 투영합니다. 그런 다음 이미지 속성 또는 레이블의 안내를 통해 편집 방향을 찾을 수 있는 잠재 공간에서 편집을 수행할 수 있습니다.

3. FFHQ-UV: Normalized UV-Texture Dataset

이 텍스트는 실제 얼굴 이미지에서 정규화된 UV 텍스처 데이터 세트를 생성하는 프로세스를 설명합니다.

![단일 자연 상태의 얼굴 이미지에서 정규화된 텍스처 UV 맵을 생성하기 위해 제안된 파이프라인은 주로 다음을 포함합니다. 세 가지 모듈로 구성됩니다: StyleGAN 기반 얼굴 이미지 편집, 얼굴 UV 텍스처 추출, UV 텍스처 보정 및 완성.](FFHQ-UV%20Normalized%20Facial%20UV-Texture%20Dataset%20for%203%20179a4ee0e2b74da2ac861d29635220bb/Untitled.png)

단일 자연 상태의 얼굴 이미지에서 정규화된 텍스처 UV 맵을 생성하기 위해 제안된 파이프라인은 주로 다음을 포함합니다. 세 가지 모듈로 구성됩니다: StyleGAN 기반 얼굴 이미지 편집, 얼굴 UV 텍스처 추출, UV 텍스처 보정 및 완성.

이 프로세스는 세 단계로 구성됩니다:

StyleGAN 기반 얼굴 이미지 편집: 여기에서는 먼저 자연 상태의 얼굴 이미지의 이미지 속성을 정규화합니다. 정규화된 얼굴 이미지와 두 개의 측면 얼굴 이미지가 StyleFlow와 InterFaceGAN을 사용하여 생성됩니다. 이 단계에서는 조명을 균일하게 하고, 중립적인 표정을 표현하며, 오클루전을 제거하는 데 도움이 됩니다.

![파이프라인의 다양한 변형을 통해 추출한 UV 맵을 파이프라인. 보충 자료에서 더 많은 결과를 확인할 수 있습니다.](FFHQ-UV%20Normalized%20Facial%20UV-Texture%20Dataset%20for%203%20179a4ee0e2b74da2ac861d29635220bb/Untitled%201.png)

파이프라인의 다양한 변형을 통해 추출한 UV 맵을 파이프라인. 보충 자료에서 더 많은 결과를 확인할 수 있습니다.

![UV 맵에서 계산된 BS 오차 예시 및 그 중간 결과 Bα(T Y ). 첫 번째 행은 텍스처 텍스처를 "편집하지 않고" 기준 메서드로 생성한 UV 맵입니다. 두 번째 행은 제안된 방법으로 생성된 텍스처 UV 맵입니다.](FFHQ-UV%20Normalized%20Facial%20UV-Texture%20Dataset%20for%203%20179a4ee0e2b74da2ac861d29635220bb/Untitled%202.png)

UV 맵에서 계산된 BS 오차 예시 및 그 중간 결과 Bα(T Y ). 첫 번째 행은 텍스처 텍스처를 "편집하지 않고" 기준 메서드로 생성한 UV 맵입니다. 두 번째 행은 제안된 방법으로 생성된 텍스처 UV 맵입니다.

얼굴 UV 텍스처 추출: 단일 이미지 3D 얼굴 모양 추정기인 Deep3D 모델을 학습시켜 3D 모양과 머리 포즈 파라미터를 회귀시킵니다. 그런 다음 입력 이미지를 3D 얼굴 모델에 투사하여 얼굴 UV 텍스처를 언래핑합니다. 얼굴이 아닌 영역은 언래핑된 텍스처 UV 맵에서 제외됩니다. 정면, 왼쪽, 오른쪽 뷰의 세 가지 텍스처 맵을 함께 블렌딩하여 완전한 텍스처 맵을 얻습니다.

UV 텍스처 보정 및 완성: 텍스처 맵의 아티팩트(일반적으로 눈, 입, 코 근처 영역)는 오류가 발생하기 쉬운 영역을 확장 및 제외하고 누락된 영역을 템플릿 텍스처 UV 맵으로 채워서 제거합니다.

이 파이프라인을 사용하여 FFHQ-UV 데이터세트를 생성하고 FFHQ 데이터세트의 모든 이미지에 적용하여 1024 × 1024 해상도의 54,165개의 고품질 UV 맵을 생성했습니다.

이 파이프라인의 효과는 제거 연구와 정성적 평가를 통해 입증되었습니다. 생성된 UV 맵은 기준선보다 조명이 균일하고 아티팩트가 적었습니다. 결과 데이터 세트는 데이터 다양성이 높았으며, 원본 FFHQ 데이터 세트의 신원 변화의 90% 이상을 보존했습니다.

또한 밝기 대칭 오류(BS 오류) 메트릭을 통해 균일한 조명의 품질을 평가한 결과, StyleGAN 기반 편집 단계가 보다 균일한 조명 측면에서 품질을 효과적으로 개선했음을 입증했습니다.

4. 3D Face Reconstruction with FFHQ-UV

이 섹션에서는 단일 이미지에서 3D 얼굴을 재구성하기 위해 제안된 FFHQ-UV 데이터 세트의 적용에 대해 간략하게 설명합니다. FFHQ-UV가 재구성 정확도를 향상시키고 현재의 최신 방법보다 더 높은 품질의 UV 맵을 생성한다는 것을 보여주는 것이 목표입니다.

![알고리즘의 각 단계별 중간 재구성 결과 알고리즘의 각 단계별 중간 재구성 결과입니다. 렌더링된 얼굴을 입력된 얼굴과 비교하면 최종 결과가 입력된 얼굴과 더 잘 닮은 것을 알 수 있습니다. 눈, 뺨, 입 주변의 모양과 질감이 특히 그렇습니다.](FFHQ-UV%20Normalized%20Facial%20UV-Texture%20Dataset%20for%203%20179a4ee0e2b74da2ac861d29635220bb/Untitled%203.png)

알고리즘의 각 단계별 중간 재구성 결과 알고리즘의 각 단계별 중간 재구성 결과입니다. 렌더링된 얼굴을 입력된 얼굴과 비교하면 최종 결과가 입력된 얼굴과 더 잘 닮은 것을 알 수 있습니다. 눈, 뺨, 입 주변의 모양과 질감이 특히 그렇습니다.

저자들은 먼저 GANFIT과 유사한 FFHQ-UV에서 GAN 기반 텍스처 디코더를 훈련합니다. 텍스처 UV 맵은 StyleGAN2의 네트워크 아키텍처를 사용하여 생성됩니다. 3D 얼굴 재구성 중 UV 텍스처 복구의 주요 목표는 텍스처 디코더를 통해 입력 이미지에 가장 적합한 텍스처 UV 맵을 생성하는 잠재 코드를 발견하는 것입니다.

3D 얼굴 재구성 알고리즘은 세 단계로 구성됩니다:

선형 3DMM 초기화 - 모양 기준 HiFi3D++로 훈련된 Deep3D를 사용하여 아이덴티티, 표현 모양 기준, 선형 텍스처 기준, 머리 포즈 및 SH 조명 계수에 대한 파라미터를 초기화합니다.

텍스처 잠재 코드 z 최적화 - 첫 번째 단계에서 초기화된 파라미터를 사용하고 수정하여 손실 함수를 최소화하는 텍스처 디코더의 잠재 코드 z를 찾습니다.

공동 파라미터 최적화 - 이 단계에서는 잠상 코드 z에 대한 초구면 제약이 완화되고 모든 파라미터가 특정 손실 함수를 최소화하여 공동으로 최적화됩니다.

구현을 평가한 결과 GAN 기반 텍스처 디코더는 StyleGAN2의 "구성 F"와 동일한 하이퍼파라미터를 사용하여 훈련된 것으로 나타났습니다. NVIDIA Tesla V100 GPU에서 테스트한 결과 이미지당 총 피팅 시간은 약 60초로 나타났습니다.

100개의 얼굴 스캔으로 구성된 REALY 벤치마크에서 형상 재구성 정확도를 평가한 결과, 이 방법이 다른 단일 이미지 재구성 접근 방식보다 뛰어난 성능을 보였습니다. 시각적 비교를 위해 재구성된 메시의 예가 나와 있습니다.

![재구성된 셰이프, 텍스처 UV 맵 및 렌더링의 예. 생성된 텍스처가 디테일하고 균일하게 조명되어 다양한 조명 조건에서 렌더링할 수 있습니다.](FFHQ-UV%20Normalized%20Facial%20UV-Texture%20Dataset%20for%203%20179a4ee0e2b74da2ac861d29635220bb/Untitled%204.png)

재구성된 셰이프, 텍스처 UV 맵 및 렌더링의 예. 생성된 텍스처가 디테일하고 균일하게 조명되어 다양한 조명 조건에서 렌더링할 수 있습니다.

또한 저자는 재구성된 모양, 텍스처 UV 맵, 다양한 실제 조명 조건에서의 렌더링 예시를 보여줍니다. 또한 다양한 실험을 통해 대규모 데이터 세트에서 훈련된 텍스처 디코더의 표현력의 이점을 검증합니다. 피팅 결과에 따르면 더 큰 데이터셋으로 훈련된 텍스처 디코더가 더 큰 표현력을 가진 것으로 나타났습니다.

5. Conclusion and Future Work

저자들은 50,000개 이상의 고품질 얼굴 텍스처 UV 맵이 포함된 FFHQ-UV라는 새로운 얼굴 UV 텍스처 데이터 세트를 소개했습니다. 저자들은 이 데이터 세트가 놀라울 정도로 다양하고 품질이 높다고 주장합니다. 또한 이 데이터세트로 훈련된 텍스처 디코더가 3D 얼굴 재구성의 충실도와 품질을 크게 향상시킨다는 사실도 보여줍니다. 데이터 세트, 코드, 훈련된 텍스처 디코더는 공개될 예정이며, 이를 통해 이 분야의 연구를 발전시키고 3D 얼굴 재구성 기술을 실제 시나리오에 더 많이 적용할 수 있을 것으로 보입니다.

그러나 앞으로의 연구에는 몇 가지 한계와 보완해야 할 부분이 있습니다. FFHQ 데이터세트에서 파생된 FFHQ-UV 데이터세트는 FFHQ 데이터세트에 존재하는 편향성을 그대로 물려받을 수 있습니다. CelebA-HQ와 같은 다른 얼굴 이미지 데이터 세트로 데이터 세트를 보강하는 것을 고려할 수 있지만, 데이터 세트 생성 파이프라인이 StyleGAN 기반 얼굴 정규화에 의존하기 때문에 효과적이지 않을 수 있습니다. 또한 텍스처 복구 결과의 평가에는 텍스처 맵의 품질을 반영할 수 있는 효과적인 지표가 부족하며 여전히 육안 검사가 필요합니다. 저자들은 향후 연구에서 이러한 문제를 더 조사할 의사를 밝혔습니다.

- 요약
    
    문제 식별: 저자는 3D 얼굴 재구성의 충실도와 품질을 개선하기 위해 고품질의 다양한 얼굴 UV 텍스처 데이터 세트가 필요하다는 사실을 파악했습니다.
    
    데이터 세트 생성: 저자들은 FFHQ 데이터세트에서 파생된 새로운 얼굴 UV 텍스처 데이터세트인 FFHQ-UV를 선보입니다. 이 데이터세트에는 50,000개 이상의 고퀄리티 페이셜 텍스처 UV 맵이 포함되어 있습니다. 이 데이터세트를 생성하는 과정에는 StyleGAN 기반 얼굴 노멀라이제이션에 기반한 파이프라인이 포함됩니다.
    
    텍스처 디코더 훈련: 그런 다음 저자들은 GANFIT과 유사한 StyleGAN2의 네트워크 아키텍처를 사용하여 FFHQ-UV 데이터세트에서 텍스처 디코더를 훈련합니다. 목표는 입력 이미지에 가장 잘 맞는 잠재 코드에서 UV 텍스처 맵을 생성하는 것입니다.
    
    3D 얼굴 재구성 알고리즘: 저자들은 3단계 3D 얼굴 재구성 알고리즘을 제안합니다.
    
    1단계에서는 형상 기반 HiFi3D++로 훈련된 Deep3D를 사용하여 재구성을 초기화합니다.
    2단계에서는 1단계의 파라미터를 수정하고 특정 손실을 최소화하는 잠재 코드를 찾습니다.
    3단계에서는 정의된 손실 함수를 최소화하여 모든 파라미터를 공동으로 최적화합니다.
    구현 및 평가: 저자는 GAN 기반 텍스처 디코더의 훈련, 여러 단계의 손실 가중치, 사용된 최적화 도구에 대한 세부 사항을 포함하여 제안한 방법의 구현에 대해 자세히 설명합니다. 벤치마크에서 형상 재구성 정확도를 평가하고 다른 최신 단일 이미지 재구성 접근 방식과 비교합니다. 연구팀은 텍스처 디코더가 재구성 정확도를 크게 향상시킨다는 사실을 입증했습니다.
    
    텍스처 품질: 또한 저자는 텍스처의 품질을 평가하고 GANFIT 및 AvatarMe와 같은 다른 기존 방법과 비교합니다. 저자들은 UV 맵의 조명이 더 균일하고 충실도와 에셋 품질이 더 높다고 강조합니다.
    
    한계와 향후 작업: 저자들은 원본 FFHQ 데이터세트에서 물려받은 잠재적 편향과 텍스처 복구 결과를 평가하기 위한 효과적인 지표가 부족하다는 점 등 접근 방식의 한계를 인정합니다. 향후 연구에서 이러한 문제를 추가로 조사할 것을 제안합니다.
    
    결론: 저자들은 자신들의 연구를 요약하고 데이터세트, 코드, 훈련된 텍스처 디코더의 오픈 소스 공개가 3D 얼굴 재구성 분야의 발전에 기여할 수 있기를 희망합니다.