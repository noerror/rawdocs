# Segment Anything

*이 논문에서는 '기초 모델'이라는 개념을 적용하여 이미지 분할 작업을 향상시키는 것을 목표로 하는 'Segment Anything' 프로젝트를 소개합니다. 기초 모델은 다양한 작업에 사용되는 적응 가능한 대규모의 사전 학습된 AI 모델입니다. 이 프로젝트에서는 '즉시 분할 가능'이라는 새로운 작업과 SAM(Segment Anything Model)이라는 모델, 방대한 수의 주석이 달린 이미지가 포함된 새로운 데이터 세트(SA-1B)를 도입합니다. 미세한 디테일이 누락되거나 경계가 덜 선명하게 표현되는 등 몇 가지 한계에도 불구하고 SAM은 다양한 애플리케이션에서 유망한 성능과 다용도성을 보여줍니다. 기초 모델로서 SAM의 성공 여부는 향후 AI 커뮤니티에서의 사용과 적응을 통해 확인할 수 있을 것입니다.*

[https://ai.facebook.com/research/publications/segment-anything/](https://ai.facebook.com/research/publications/segment-anything/)

이미지 세그먼테이션을 위한 새로운 작업, 모델, 데이터 세트를 포함하는 SA(Segment Anything) 프로젝트를 소개합니다. 효율적인 모델을 통해 1,100만 장의 이미지에 10억 개 이상의 마스크가 포함된 역대 최대 규모의 세분화 데이터 세트를 생성할 수 있습니다. 이 모델은 추가 훈련 없이도 새로운 작업에 적응할 수 있어 이전의 감독 방식에 비해 인상적인 결과를 보여줍니다. Facebook은 기초 컴퓨터 비전 모델에 대한 연구를 장려하기 위해 세그먼트 애니씽 모델(SAM)과 SA-1B 데이터 세트를 공개하고 있습니다. 자세한 내용은 [https://segment-anything.com](https://segment-anything.com/) 에서 확인하세요.

![Untitled](Segment%20Anything%203e323fbf08a74c11bb529ba0311a35ac/Untitled.png)

1. Introduction

학습 데이터를 넘어 작업과 데이터 분포로 일반화할 수 있는 기초 모델은 NLP와 컴퓨터 비전을 혁신하고 있습니다. 이 작업에서는 이미지 분할을 위한 기초 모델인 세그먼트 애니씽 모델(SAM)을 만드는 것을 목표로 합니다. 이를 위해서는 신속한 세분화 작업을 정의하고, 적합한 모델 아키텍처를 개발하며, 학습을 위한 다양한 데이터 세트를 생성해야 합니다.

SAM은 신속하게 마스크를 계산하고 실시간으로 마스크를 계산하며 모호성을 처리하도록 설계되었습니다. 이미지 인코더, 프롬프트 인코더, 마스크 디코더로 구성됩니다. SAM을 훈련하기 위해 유니티는 보조 수동, 반자동, 완전 자동의 세 단계로 모델 인 더 루프 데이터 세트 주석을 포함하는 '데이터 엔진'을 구축합니다.

최종 데이터 세트인 SA-1B는 1,100만 개의 이미지에서 10억 개 이상의 마스크로 구성되어 있으며, 현재까지 가장 큰 규모의 세분화 데이터 세트입니다. 다양한 다운스트림 작업에서 SAM을 평가한 결과, 신속한 엔지니어링이 가능한 제로샷 전송 프로토콜을 사용하여 우수한 성능을 발휘한다는 사실을 확인했습니다. 연구 목적으로 SA-1B 데이터 세트와 SAM을 [https://segment-anything.com](https://segment-anything.com/) 에서 공개하고 있습니다.

2. Segment Anything Task

자연어 처리에서 영감을 받아 이미지 분할을 위한 기초 모델을 구축하기 위한 프롬프트 가능한 분할 작업을 소개합니다. 이 작업은 모호한 경우에도 프롬프트가 주어지면 유효한 세그먼테이션 마스크를 반환해야 합니다. 이를 통해 자연스러운 사전 학습 알고리즘이 생성되고 프롬프트 엔지니어링을 사용하여 다양한 다운스트림 작업으로 제로 샷 전송이 가능합니다.

사전 학습 작업은 추론 중에 어떤 프롬프트에도 적절하게 응답할 수 있도록 모델을 준비시켜 다양한 세분화 작업에 적용할 수 있도록 합니다. 이는 모델이 고정된 작업 집합을 위해 설계된 다중 작업 세분화 시스템과는 다릅니다.

프롬프트와 구성을 통해 단일 모델을 다양한 애플리케이션에 유연하게 사용할 수 있습니다. 프롬프트 세분화를 위해 학습된 모델은 더 큰 시스템의 구성 요소로 사용할 수 있으므로 다양한 실제 세분화 작업을 수행할 수 있습니다. 이 접근 방식은 고정된 작업 집합을 위해 특별히 훈련된 시스템보다 더 많은 애플리케이션을 가능하게 할 것으로 기대됩니다.

![Untitled](Segment%20Anything%203e323fbf08a74c11bb529ba0311a35ac/Untitled%201.png)

3. Segment Anything Model

SAM(Segment Anything Model)은 신속한 세그먼테이션을 위해 설계되었으며 이미지 인코더, 프롬프트 인코더, 마스크 디코더의 세 가지 구성 요소로 이루어져 있습니다. 이미지 인코더는 사전 학습된 비전 트랜스포머(ViT)를 사용하여 고해상도 입력을 처리합니다. 프롬프트 인코더는 학습된 임베딩 및 위치 인코딩을 사용하여 포인트, 상자 및 텍스트를 인코딩하는 희소 및 고밀도 프롬프트를 처리합니다. 마스크와 같은 고밀도 프롬프트는 컨볼루션을 사용하여 임베드됩니다. 마스크 디코더는 동적 마스크 예측 헤드에 이어 수정된 트랜스포머 디코더 블록을 사용하여 이미지와 프롬프트 임베딩을 마스크에 효율적으로 매핑합니다.

모호성을 해결하기 위해 모델은 단일 프롬프트에 대해 여러 출력 마스크를 예측합니다. 훈련 중에는 마스크에 대한 최소 손실만 역전파됩니다. 또한 모델은 각 마스크에 대한 신뢰도 점수를 예측합니다.

효율성은 모델 설계의 주요 동기입니다. 사전 계산된 이미지 임베딩을 사용하면 프롬프트 인코더와 마스크 디코더가 CPU에서 실시간으로 실행됩니다. 모델은 대화형 설정에서 기하학적 프롬프트를 혼합하여 프롬프트 가능한 세그먼트 작업을 위해 훈련되므로 데이터 엔진에 원활하게 통합할 수 있습니다.

4. Segment Anything Data Engine

1.11억 개의 마스크 데이터 세트를 수집하는 데 사용되는 데이터 엔진인 SA-1B는 세 단계로 구성되어 있습니다:

1. 보조 수동 단계: 전문 어노테이터가 SAM으로 구동되는 브라우저 기반 대화형 세분화 도구를 사용하여 마스크에 라벨을 지정합니다. 모델이 개선됨에 따라 마스크당 평균 주석 시간이 감소하고 이미지당 평균 마스크 수가 증가했습니다. 이 단계에서는 120만 개의 이미지에서 430만 개의 마스크를 수집했습니다.
2. 반자동 단계: 마스크의 다양성을 높이기 위해 자동으로 감지된 신뢰도 높은 마스크로 미리 채워진 이미지를 주석가에게 제시하고 주석이 추가되지 않은 객체에 주석을 달도록 요청했습니다. 180만 개의 이미지에서 590만 개의 마스크가 추가로 수집되어 총 1,020만 개의 마스크가 생성되었습니다. 이미지당 평균 마스크 수는 72개로 증가했습니다.
3. 완전 자동 스테이지: 충분한 마스크가 수집되고 모호성 인식 모델이 개발됨에 따라 마스크 주석이 완전 자동화가 되었습니다. 모델에는 32x32 그리드의 점과 유효한 객체에 대한 예측 마스크가 입력되었습니다. 확실하고 안정적인 마스크가 선택되고 중복된 마스크가 필터링되었습니다. 완전 자동 마스크 생성은 1100만 개의 모든 이미지에 적용되어 총 11억 개의 고품질 마스크를 생성했습니다.

이러한 단계를 통해 세그먼트 애니씽 모델(SAM)을 훈련하고 개선하는 데 사용되는 대규모 SA-1B 데이터 세트를 생성할 수 있었습니다.

5. Segment Anything Dataset

SA-1B는 데이터 엔진으로 수집한 1,100만 개의 고해상도 이미지와 11억 개의 고품질 세그먼트 마스크로 구성된 데이터 세트입니다. 이 데이터 세트는 향후 컴퓨터 비전을 위한 기초 모델 개발을 지원하는 것을 목표로 합니다. 이미지에는 라이센스가 부여되어 있으며 얼굴과 번호판이 흐릿하게 처리되어 개인정보가 보호됩니다. 마스크는 대부분 자동으로 생성되며, 99.1%가 이러한 방식으로 생성됩니다. 자동 마스크의 품질은 높은 편으로, 94%는 전문적으로 보정된 마스크에 비해 IoU가 90% 이상입니다.

SA-1B는 다른 유명 세분화 데이터 세트보다 더 많은 이미지와 마스크를 보유하고 있어 더 넓은 커버리지와 이미지당 더 많은 마스크를 제공합니다. 모든 데이터 세트에 일반적인 사진가 편향이 존재하지만, SA-1B는 상대적으로 작은 크기의 마스크가 더 많기 때문에 더 나은 세분화 결과를 얻을 수 있습니다. 마스크의 모양 복잡도는 다른 데이터 세트와 대체로 유사합니다. 전반적으로 SA-1B 데이터 세트는 컴퓨터 비전 모델을 훈련하고 개선하는 데 유용한 리소스입니다.

6. Segment Anything RAI Analysis

SA-1B와 SAM에 대한 책임감 있는 AI(RAI) 분석은 지리적 및 소득 분포, 보호 대상 속성의 공정성 측면에서 잠재적인 공정성 문제와 편견에 초점을 맞추고 있습니다.

SA-1B는 다른 데이터 세트에 비해 유럽, 아시아 및 오세아니아, 중간 소득 국가의 이미지 비율이 더 높습니다. 그러나 SA-1B를 포함한 모든 데이터 세트는 아프리카와 저소득 국가를 과소 대표합니다. 이미지당 평균 마스크 수는 지역과 소득에 관계없이 일관되게 유지됩니다.

인식된 성별, 연령, 피부색에 따라 사람들을 세분화하는 SAM의 공정성을 평가한 결과, 그룹 간에 비슷한 성능을 보였습니다. 성별 표현의 경우, 탐지 및 세분화 데이터 세트에서 여성이 과소 대표됨에도 불구하고 SAM은 남성과 여성 모두에서 비슷한 성능을 보였습니다. 연령의 경우, SAM은 나이가 많다고 인식되는 사람들에 대해 가장 우수한 성능을 보였습니다. 피부 톤의 경우, 피츠패트릭 피부 유형 범주에서 유의미한 차이가 발견되지 않았습니다.

이러한 결과는 데이터 세트에 일부 편향이 여전히 존재할 수 있지만, SAM의 성능은 일반적으로 여러 그룹에 걸쳐 일관성이 있음을 시사합니다. 하지만 대규모 시스템에서 SAM을 구성 요소로 사용할 때는 잠재적인 편향에 유의해야 합니다.

7. Zero-Shot Transfer Experiments

이 연구에서는 이미지 분할에서 제로 샷 전송 작업을 위해 설계된 세그먼트 애니씽 모델(SAM)을 소개합니다. 이 모델은 다섯 가지 과제에 대해 테스트되었으며, 그 중 네 가지 과제는 훈련된 프롬프트 가능한 분할 과제와 크게 다릅니다. 이 실험에서는 수중 또는 자아 중심 이미지와 같은 새로운 이미지 분포를 포함하여 훈련 중에 보지 못한 데이터 세트와 작업에 대해 SAM을 평가합니다.

프롬프트 분할의 핵심 목표는 모든 프롬프트에서 유효한 마스크를 생성하는 것입니다. SAM은 단일 전경점 프롬프트, 에지 감지, 객체 제안 생성, 인스턴스 분할, 자유 형식 텍스트에서 객체 분할에 대해 테스트됩니다. 이러한 작업은 프롬프트 엔지니어링을 통해 구현됩니다.

그 결과 SAM은 단일 포인트로부터 유효한 마스크를 분할하는 방법을 학습했으며, 대부분의 경우 강력한 기준선을 능가하는 성능을 보였습니다. SAM은 에지 감지, 객체 제안, 인스턴스 세분화와 같은 작업에서도 유망한 결과를 보여주었습니다. 개념 증명 실험에서 SAM은 텍스트 프롬프트를 처리하고 자유 형식 텍스트를 기반으로 객체를 세분화하는 기능을 보여줍니다.

실험 결과, 데이터 엔진의 각 단계가 mIoU를 증가시키며, 자동 생성된 마스크만 사용하면 약간의 성능 저하만으로 훈련 설정이 간소화되는 것으로 나타났습니다. 전체 데이터 세트의 약 10%에 해당하는 1백만 개의 이미지로 모델은 전체 데이터 세트와 비슷한 결과를 얻을 수 있어 많은 사용 사례에서 실용적인 설정이 될 수 있습니다.

8. Discussion

이 백서에서는 이미지 세분화를 기초 모델 시대로 가져오는 것을 목표로 하는 Segment Anything 프로젝트를 소개합니다. 주요 기여 사항으로는 프롬프트 가능한 세분화라는 새로운 작업, SAM이라는 모델, SA-1B라는 데이터 세트가 있습니다. 기초 모델은 다양한 다운스트림 작업에 적용할 수 있는 사전 학습된 모델입니다. 기존의 자가 지도 기반 모델과 달리 SAM은 대부분 대규모 지도 학습에 의존합니다.

목표는 SAM을 대규모 시스템의 구성 요소로 쉽게 사용할 수 있도록 하는 것입니다. 예를 들어, 웨어러블 디바이스의 시선 포인트와 함께 사용하여 새로운 애플리케이션을 구현할 수 있습니다. SAM은 일반적으로 성능이 뛰어나지만 미세한 구조를 놓치거나 경계가 선명하지 않은 등 몇 가지 한계가 있습니다.

결론적으로, 세그먼트 애니씽 프로젝트는 신속한 분할 모델, 새로운 작업 및 데이터 세트를 도입하여 이미지 분할의 미래를 위한 길을 닦는 것을 목표로 합니다. SAM이 기반 모델이 될지 여부는 커뮤니티 내에서의 채택과 활용에 달려 있습니다.