# Deep Marching Tetrahedra: a Hybrid Representation for High-Resolution 3D Shape Synthesis

*이 논문은 고해상도 3D 형상을 생성하기 위해 간단한 사용자 지침, 예를 들면 대략적인 복셀을 사용하는 깊은 3D 조건부 생성 모델을 소개합니다. 이들의 DMTET는 암시적과 명시적 표현의 장점을 모두 활용하여 두 표현을 결합하는 새로운 3D 표현을 특징으로 합니다. 실험적으로, 이들의 방법이 기존 방법보다 훨씬 높은 품질의 형상을 생성한다는 것을 보여줍니다. 이 논문의 목표는 Minecraft와 같은 대략적인 복셀을 고해상도로 업스케일링하여 3D 콘텐츠 생성을 더욱 대중화하는 것입니다. 이 기술은 AR/VR, 로봇공학, 건축, 게임 및 영화와 같은 여러 분야에서 높은 품질의 3D 콘텐츠의 필요성을 충족할 수 있습니다.*

[https://nv-tlabs.github.io/DMTet/](https://nv-tlabs.github.io/DMTet/)

[https://arxiv.org/abs/2111.04276](https://arxiv.org/abs/2111.04276)

- Nov 2021 (NeurIPS)

![Untitled](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled.png)

### 1 Introduction

게임, 건축, 영화 등 많은 산업에서 디테일한 3D 콘텐츠에 의존하고 있습니다. 이러한 콘텐츠를 제작하는 데는 많은 시간이 소요됩니다. 하지만 Minecraft와 같은 간단한 3D 모양은 일반인도 만들 수 있습니다. 이 연구는 이러한 단순한 모양을 고품질 3D 디자인으로 변환하는 AI 도구를 개발하는 것을 목표로 합니다. 3D 도형을 표현하는 효과적인 방법은 신경 암시적 표현을 사용하는 것입니다. 그러나 현재의 많은 방법은 고품질의 디테일을 효율적으로 캡처하는 데 어려움을 겪고 있습니다.

이 연구에서 연구팀은 기본 3D 도형을 세부적인 디자인으로 변환하는 새로운 AI 모델인 DMTET을 소개합니다. DMTET는 두 가지 유형의 3D 표현을 고유하게 결합하고 행진 사면체라는 새로운 방법을 사용하여 모양을 처리합니다. 이 접근 방식은 효율적이면서도 품질을 보장합니다. DMTET는 간단한 입력으로 3D 도형을 생성하고 점으로 3D 도형을 재구성하는 두 가지 작업에 대해 테스트를 거쳤으며, 기존의 다른 방법보다 더 빠르고 우수한 성능을 발휘합니다.

![DMTET는 변형 가능한 사면체 그리드에서 정의된 SDF를 예측함으로써 대략적에서 세밀한 방식으로 형태를 암시적으로 재구성합니다. 그런 다음 SDF를 차별화된 Marching Tetrahedra 계층을 통해 표면 메시로 변환합니다. DMTET는 최종 표면에서 정의된 목적 함수를 최적화하여 훈련됩니다.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%201.png)

DMTET는 변형 가능한 사면체 그리드에서 정의된 SDF를 예측함으로써 대략적에서 세밀한 방식으로 형태를 암시적으로 재구성합니다. 그런 다음 SDF를 차별화된 Marching Tetrahedra 계층을 통해 표면 메시로 변환합니다. DMTET는 최종 표면에서 정의된 목적 함수를 최적화하여 훈련됩니다.

### 2 Related Work

복셀 기반 방법:

- 초기에는 복셀을 사용하여 3D 도형을 표현했습니다. 복셀은 그리드에서 점이 도형의 내부 또는 외부에 있는지 여부와 같은 기본적인 세부 정보를 캡처합니다.
- 이러한 방법은 3D 재구성 및 생성에서 우수한 성능을 발휘했습니다.
- 고해상도 셰이프에서 저해상도 셰이프로 디테일을 전송하는 방식으로 고해상도 셰이프를 생성하는 데 데코간을 사용했습니다.
- 복셀의 문제점은 특히 고해상도에서는 많은 메모리와 연산이 필요하다는 점입니다. 이 문제를 해결하기 위해 옥트리와 같은 계층 구조가 사용되어 왔습니다.
- 이 논문에서는 해상도를 효율적으로 사용하고 표면 표현을 개선할 수 있는 새로운 접근 방식인 계층적 변형 사면체 그리드를 소개합니다.

심층 암시 필드(DIF):

- 신경망에 의해 안내되는 연속 함수를 사용하여 3D 모양을 표현합니다.
- 복잡한 토폴로지와 무한한 해상도를 가진 도형을 처리할 수 있습니다.
- DIF는 단일 뷰에서 3D 재구성과 같은 다양한 애플리케이션에서 좋은 결과를 보여주었습니다.
- 그러나 때때로 미세한 디테일에서 아티팩트를 생성하기도 합니다. DIF에서 메시를 얻으려면 종종 행진 큐브 또는 행진 사면체를 사용해야 하는데, 이는 계산 비용이 많이 들고 오류가 발생하기 쉽습니다.
- 이 논문에서 제안한 DMTET는 고해상도로 더 잘 확장되며 생성된 표면을 직접 감독하여 복잡한 토폴로지를 나타낼 수 있습니다.

표면 기반 방법:

- 이 방법은 삼각형 메시를 직접 예측하며 단순한 모양에 적합합니다.
- 하지만 미리 정의된 셰이프 토폴로지가 있는 경우가 많으므로 다양한 토폴로지를 가진 복잡한 셰이프를 처리하지 못할 수 있습니다.
- DefTet은 변형 가능한 사면체 격자를 메시로 사용하는 최근의 방법입니다. 그러나 높은 계산 비용으로 어려움을 겪고 있으며 공동 훈련을 지원하지 않아 최적의 결과를 얻지 못합니다.
- 본 논문에서 제안한 방법은 기존 연구에서 볼 수 없었던 고해상도 3D 형상을 생성할 수 있습니다.

### 3 Deep Marching Tetrahedra

DefTet에서 영감을 얻은 변형 가능한 사면체 그리드 내에서 인코딩된 부호 거리 필드(SDF)를 사용합니다. 그리드는 단위 큐브를 사면체로 채웁니다.

이 그리드의 정점은 변형이 가능하므로 도형의 지오메트리를 보다 효율적으로 표현할 수 있습니다.

3.1.1 변형 가능한 사면체 메시

- 이 방법은 이전 작업에서 변형 가능한 사면체 그리드를 확장한 것입니다.
- SDF 값은 그리드의 정점을 기준으로 보간됩니다.

3.1.2 볼륨 세분화

- coarse-to-fine 하게 접근하여 모양을 효율적으로 표현합니다.
- 서로 다른 SDF 부호를 나타내는 정점을 가진 사면체를 확인하여 표면 사면체(Tsurf)를 결정합니다.
- Tsurf와 그 이웃을 세분화하여 각 가장자리에 중간점을 추가하고 새로운 정점 SDF 값을 계산합니다.
    
    ![볼륨 세분화:각 표면 사면체(파란색)는 중간점을 추가하여 8개의 사면체(빨간색)로 나누어집니다.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%202.png)
    
    볼륨 세분화:각 표면 사면체(파란색)는 중간점을 추가하여 8개의 사면체(빨간색)로 나누어집니다.
    

3.1.3 행진 사면체:

- 마칭 테트라헤드라 알고리즘을 사용하여 SDF를 삼각형 메시로 변환합니다.
- 버텍스 SDF 값을 기반으로 사면체 내의 표면 토폴로지를 결정합니다.
- 훈련 중에 특정 조건을 충족하도록 함으로써 기존 작업에서 직면했던 특이점 문제를 극복합니다.
    
    ![MT의 세 가지 고유한 표면 구성입니다. 정점 색상은 부호가 있는 거리 값의 부호를 나타냅니다. 모든 정점의 부호를 뒤집으면 동일한 표면 구성이 나타납니다. 정점의 위치는 부호 변경을 가진 가장자리를 따라 선형으로 보간됩니다.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%203.png)
    
    MT의 세 가지 고유한 표면 구성입니다. 정점 색상은 부호가 있는 거리 값의 부호를 나타냅니다. 모든 정점의 부호를 뒤집으면 동일한 표면 구성이 나타납니다. 정점의 위치는 부호 변경을 가진 가장자리를 따라 선형으로 보간됩니다.
    

3.1.4 표면 세분화:

- 차등 표면 세분화 모듈을 사용하여 도형의 시각적 품질을 향상시킵니다.
- 학습 가능한 매개변수와 함께 루프 세분화 방법을 사용하여 표현과 미학을 개선합니다.

3.2 DMTET: 3D 심층 조건부 생성 모델:

- DMTET는 포인트 클라우드 또는 거친 복셀화된 모양과 같은 입력에서 고해상도 3D 메시를 생성하기 위해 개발된 신경망 모델입니다.
- 생성기의 아키텍처는 제안된 3D 표현의 각 모듈에 초점을 맞추고 있으며 판별자에 대한 세부 정보도 제공됩니다.

![우리의 생성기와 판별기 아키텍처입니다. 생성기는 두 부분으로 구성되어 있습니다. 하나는 모든 그리드 정점에 대한 초기 예측을 생성하기 위해 MLP를 사용하고, 다른 하나는 표면을 세밀화하기 위해 GCN을 사용합니다.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%204.png)

우리의 생성기와 판별기 아키텍처입니다. 생성기는 두 부분으로 구성되어 있습니다. 하나는 모든 그리드 정점에 대한 초기 예측을 생성하기 위해 MLP를 사용하고, 다른 하나는 표면을 세밀화하기 위해 GCN을 사용합니다.

3.2.1 3D 생성기:

- 입력 인코더: PVCNN을 사용하여 입력을 3D 피처 볼륨으로 인코딩합니다.
- 초기 SDF 예측: 완전 연결 네트워크가 각 버텍스에 대한 초기 SDF를 예측합니다.
- 볼륨 세분화를 통한 표면 세분화: 반복적으로 표면을 개선하고, 표면 사면체를 식별하고, 그리드를 세분화하여 표면 표현을 개선합니다.
- 학습 가능한 표면 세분화: 그래프 컨볼루션 네트워크를 사용하여 루프 세분화 방법을 사용하여 표면 메시를 더욱 세분화합니다.

3.2.2 3D 판별자:

- 예측된 메시의 계산된 부호화된 거리 필드에 3D CNN 판별기가 사용되어 더 세밀한 디테일을 캡처하는 것을 목표로 합니다.

3.3 손실 함수:

- 표면 정렬 손실: 예측된 메시 표면과 지상 실측 메시 표면 간의 차이를 최소화합니다.
- 적대적 손실: 생성된 형상의 사실성을 향상시키기 위해 LSGAN 기반 적대적 손실을 사용합니다.
- 정규화: SDF 값과 예측된 정점 변형에 정규화 용어를 도입하여 훈련 이상 현상을 방지합니다.

### 4 Experiments

거친 복셀에서 3D 모양 합성:

- 데이터 수집: 터보스퀴드에서 1562개의 동물 모델을 확보했습니다. 이 중 1120개는 훈련에, 나머지 442개는 테스트에 사용되었습니다.
- 방법 비교: DMTET는 최첨단 방법인 ConvOnet 및 두 가지 버전의 DECOR-GAN과 비교되었습니다.
    
    ![대략적인 복셀로부터의 3D 형상 합성에 대한 질적 결과. 모든 기본선과 비교할 때, 우리의 방법은 훨씬 높은 품질로 형상을 재구성합니다. GAN을 추가하면 생성된 형태의 현실감이 더욱 향상됩니다. 또한 둘째 마지막 열에서 훈련 세트에서 검색된 형상도 보여줍니다.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%205.png)
    
    대략적인 복셀로부터의 3D 형상 합성에 대한 질적 결과. 모든 기본선과 비교할 때, 우리의 방법은 훨씬 높은 품질로 형상을 재구성합니다. GAN을 추가하면 생성된 형태의 현실감이 더욱 향상됩니다. 또한 둘째 마지막 열에서 훈련 세트에서 검색된 형상도 보여줍니다.
    
- 메트릭: L2 및 L1 모따기 거리, 정상 일관성 점수, 라이트 필드 거리, Cls 점수.
- 결과: DMTET는 모든 메트릭에서 모든 기준선을 뛰어넘었습니다. 특히 손톱이나 귀와 같은 세부적인 특징을 포착하는 능력이 뛰어났으며, 특히 적의 손실로 훈련했을 때 더욱 두드러졌습니다.
일반화 능력: 사람이 만든 복셀에 대해 테스트한 결과, DMTET는 익숙하지 않은 데이터에서도 뛰어난 성능을 보였습니다.

![온라인에서 수집한 대략적인 복셀로부터 고해상도 형상을 합성하는 질적 결과.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%206.png)

온라인에서 수집한 대략적인 복셀로부터 고해상도 형상을 합성하는 질적 결과.

- 사용자 연구: Amazon Mechanical Turk를 통해 수행된 사용자 연구 결과, 인간 평가자들은 DMTET가 생성한 형상을 일관되게 선호했습니다.

포인트 클라우드 3D 재구성:

- 데이터 및 설정: 수밀 메시를 위해 사전 처리하고 가우시안 노이즈를 추가한 ShapeNet의 데이터를 사용했습니다.
- 방법 비교: 복셀, 템플릿 메시 변형, 암시적 함수를 포함한 다양한 3D 재구성 방법과 DMTET을 비교했습니다.

![포인트 클라우드에서 3D 재구성에 대한 질적 결과: 우리의 모델은 기본선에 비해 더 많은 기하학적 세부 정보로 형상을 재구성합니다.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%207.png)

포인트 클라우드에서 3D 재구성에 대한 질적 결과: 우리의 모델은 기본선에 비해 더 많은 기하학적 세부 정보로 형상을 재구성합니다.

- 결과: DMTET는 우수한 재구성 품질, 효율적인 토폴로지-지오메트리 조인트 최적화, 빠른 추론 시간을 보여주었습니다.
- 오라클 성능 비교: 사면체 그리드(DMTET에서 사용)가 다른 대안보다 더 효율적인 것으로 입증되었습니다. 그리드 변형 없이도 DMTET는 MT의 성능을 뛰어넘었습니다.

![MC와 MT의 오라클 성능과 우리의 DMTET를 비교합니다.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%208.png)

MC와 MT의 오라클 성능과 우리의 DMTET를 비교합니다.

- 절제 연구: SDF 값과 변형을 모두 예측한 결과 훨씬 더 나은 성능을 보였습니다. 체적 및 표면 세분화는 모두 방법의 효율성을 향상시켰으며, 체적 세분화는 복잡한 구조에 특히 유용했습니다.

![MT와 MC의 오라클 성능과 훈련된 DMTET를 비교합니다. 괄호 안의 숫자는 조회된 SDF 점의 수를 나타냅니다.](Deep%20Marching%20Tetrahedra%20a%20Hybrid%20Representation%20f%20fab3befcac1d4cf2a193e5770284f844/Untitled%209.png)

MT와 MC의 오라클 성능과 훈련된 DMTET를 비교합니다. 괄호 안의 숫자는 조회된 SDF 점의 수를 나타냅니다.

인사이트:

- DMTET는 3D 형상 생성 및 재구성을 위한 고급 방법으로, 기존 기법에 비해 상당한 이점을 제공합니다.
- 미세한 디테일을 캡처하고 새로운 입력에 적응할 수 있는 이 방법은 향후 3D 모델링 및 그래픽 분야에서 연구 및 응용할 수 있는 유망한 방법입니다.

### 5 Conclusion

DMTET는 암시적 모델과 명시적 모델의 강점을 결합한 새로운 3D 표현을 제공합니다. 그 결과 간단한 사용자 입력으로 고품질 3D 형상을 생성할 수 있는 잠재력을 입증했습니다. 궁극적인 목표는 3D 콘텐츠 제작을 간소화하여 일반 사용자가 더 쉽게 접근할 수 있도록 하는 것입니다.

고품질 3D 콘텐츠는 AR/VR, 로봇 공학, 게임 등과 같은 분야에서 매우 중요합니다. 현재 이러한 콘텐츠를 제작하려면 전문 지식과 상당한 시간이 필요합니다. DMTET는 마인크래프트 구조물과 같은 저해상도 도형을 디테일한 3D 모델로 변환할 수 있는 잠재력을 가지고 있습니다. 이 기능은 3D 콘텐츠 제작 과정을 민주화할 수 있습니다.