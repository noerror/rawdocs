# Motion Mamba: Efficient and Long Sequence Motion Generation with Hierarchical and Bidirectional Selective SSM

[https://arxiv.org/abs/2403.07487](https://arxiv.org/abs/2403.07487)

[https://steve-zeyu-zhang.github.io/MotionMamba/](https://steve-zeyu-zhang.github.io/MotionMamba/)

- Mar 2024

1 Introduction

![Motion Mamba는 MLD [1], MotionDiffuse [4], MDM [3]과 같은 기타 잘 설계된 최신 방법들에 비해 장기 시퀀스 모델링 및 모션 생성 효율성에서 현저하게 우수한 성능을 달성했습니다.](Motion%20Mamba%20Efficient%20and%20Long%20Sequence%20Motion%20Ge%209364f0d269b74f11bd53425833eaa448/Untitled.png)

Motion Mamba는 MLD [1], MotionDiffuse [4], MDM [3]과 같은 기타 잘 설계된 최신 방법들에 비해 장기 시퀀스 모델링 및 모션 생성 효율성에서 현저하게 우수한 성능을 달성했습니다.

인간 모션 생성은 생성적 컴퓨터 비전 분야에서 중요한 도전 과제 중 하나로, 컴퓨터 애니메이션, 게임 개발, 로봇 조작 등 여러 분야에서 광범위하게 활용됩니다. 이를 위해 가상 캐릭터가 조건부 컨텍스트에 반응하여 자연스러운 움직임을 보여주고, 정확한 모션을 수행할 수 있어야 합니다. 최근에는 오토인코더, 변환기(transformers), GAN(생성적 적대 신경망), 자기회귀 모델, 확산 기반 모델 등 다양한 접근 방식을 통해 모션 생성 모델이 발전하고 있습니다. 각 방법은 고유의 장단점을 가지며, 정확한 모션 생성, 훈련의 어려움, 복잡한 아키텍처로 인한 비효율성 등 다양한 도전 과제에 직면해 있습니다. 특히 확산 기반 모델은 다양성과 강력한 성능으로 인해 주목을 받지만, 장기 모션 시퀀스 생성과 효율적인 추론 속도에서 한계를 가지고 있습니다. 이에 본 논문에서는 새로운 아키텍처인 'Motion Mamba'를 제안하여 이러한 문제를 해결하고자 합니다. Motion Mamba는 계층적 시간 Mamba(Hierarchical Temporal Mamba, HTM) 블록과 양방향 공간 Mamba(Bidirectional Spatial Mamba, BSM) 블록을 통해 효율적이고 정확한 모션 생성을 목표로 합니다. 이러한 혁신적인 접근 방식을 통해, 본 연구는 인간 모션 생성 분야에서의 기술적 발전을 도모하고, 다양한 응용 분야에서의 활용 가능성을 모색합니다.

2 Related Works

인간 모션 생성은 컴퓨터 비전의 핵심 분야로, 3D 모델링과 로봇 조작과 같은 다양한 응용 분야에 필수적입니다. 특히, 텍스트에서 모션으로의 변환 작업, 즉 Text-to-Motion 작업은 언어와 모션 사이의 공통된 잠재 공간을 학습함으로써 인간의 움직임을 생성하는 최신 방법으로 자리잡고 있습니다.

이 분야의 연구는 크게 GAN(생성적 적대 신경망), 오토인코더, 확산 모델을 중심으로 진행되어 왔습니다. GAN 기반 모델은 실제와 유사한 모션의 생성을 목표로, 식별자를 통한 진정성 개선에 초점을 맞추며, DVGAN과 ERD-QV, HP-GAN 같은 방법이 이에 해당합니다. 이들은 각각 시간 단위로 밀집 검증을 수행하거나, 잠재 표현을 향상시키기 위해 시간-도착 임베딩과 예정된 목표 노이즈 벡터를 적용합니다.

오토인코더 기반 모델은 고차원 데이터를 잠재 공간으로 압축하고, 이를 통해 인간의 모션을 재구성하는 능력에 주목합니다. JL2P, MotionCLIP, TEMOS 등이 이 분야의 대표적인 연구이며, 이들은 RNN이나 트랜스포머 기반의 오토인코더를 사용하여 언어와 포즈의 결합된 표현을 학습합니다.

최근에는 2D 이미지 생성에서 뛰어난 성능을 보여준 확산 모델이 모션 생성에도 적용되기 시작했습니다. 확산 모델은 확률적 매핑, 현실적인 합성, 다중 수준 조작 등의 특성을 바탕으로, MotionDiffuse, MDM, MLD와 같은 연구에서 탐구되었습니다. 이들은 확산 과정을 통해 조건부 입력과 원시 모션 시퀀스 간의 연결을 모델링합니다.

또한, 상태 공간 모델(SSM)에 대한 연구도 진행되어 왔습니다. SSM은 시퀀스 모델링에 있어 유망한 아키텍처로 부상하며, Mamba와 같은 선택적 SSM 아키텍처를 통해 효율적인 훈련과 추론 과정을 도모합니다. 컴퓨터 비전 분야에서 SSM의 적용은 2D 데이터 처리를 넘어, 고차원 데이터 처리에도 확장되었습니다. 이는 트랜스포머 기반 U-Net 대체, 이미지 생성 효율성 향상 등에 기여하며, 이러한 방법들은 글로벌 압축 없이도 높은 해상도를 유지하는 능력을 갖추고 있습니다.

이러한 다양한 접근 방식과 기술의 발전은 인간 모션 생성 분야의 기술적 진보를 이끌고 있으며, 본 연구에서 제안하는 Motion Mamba는 이러한 관련 연구들의 성과를 바탕으로, 더욱 효율적이고 정확한 모션 생성을 위한 새로운 방법론을 제시합니다.

3 The Proposed Method

본 연구에서 제안하는 'Motion Mamba' 프레임워크는 텍스트 기반의 설명에서 출발하여 효율적으로 장기 범위의 인간 모션을 생성하는 새로운 접근 방식을 도입합니다. 이 구조는 기본적인 상태 공간 모델과 확산 모델의 개념을 바탕으로 하며, 두 주요 구성 요소인 계층적 시간 Mamba(Hierarchical Temporal Mamba, HTM) 블록과 양방향 공간 Mamba(Bidirectional Spatial Mamba, BSM) 블록을 중심으로 설계되었습니다.

**3.1 예비 지식**

![이 그림은 제안된 Motion Mamba 모델의 구조를 보여줍니다. 인코더와 디코더 블록 각각은 계층적 시간 Mamba 블록(HTM)과 양방향 공간 Mamba(BSM) 블록으로 구성되어 있으며, 각각 SSM 레이어 내에서 계층적 스캔과 양방향 스캔을 가지고 있습니다. 이러한 스캔의 대칭적 분포는 인코더-디코더 구조 전반에 걸쳐 균형 있고 일관된 프레임워크를 보장합니다.](Motion%20Mamba%20Efficient%20and%20Long%20Sequence%20Motion%20Ge%209364f0d269b74f11bd53425833eaa448/Untitled%201.png)

이 그림은 제안된 Motion Mamba 모델의 구조를 보여줍니다. 인코더와 디코더 블록 각각은 계층적 시간 Mamba 블록(HTM)과 양방향 공간 Mamba(BSM) 블록으로 구성되어 있으며, 각각 SSM 레이어 내에서 계층적 스캔과 양방향 스캔을 가지고 있습니다. 이러한 스캔의 대칭적 분포는 인코더-디코더 구조 전반에 걸쳐 균형 있고 일관된 프레임워크를 보장합니다.

- **선택적 구조화된 상태 공간 시퀀스 모델(Selective Structured State Space Sequence Model, S4와 Mamba)**: 이 모델들은 장기 시퀀스를 효과적으로 처리하는 능력을 입증하며, 연속 시스템 동역학을 이산화하는 과정을 통해 전역 컨볼루션을 계산합니다. 이러한 방식은 장기 의존성을 포착하고 입력 시퀀스 전체에 걸친 구조화된 컨볼루션 커널을 통해 출력을 계산합니다.
- **잠재 모션 확산 모델(Latent Motion Diffusion Model)**: 확산 확률 모델은 잠재 공간에서의 확산 과정을 통해 높은 품질의 모션 생성을 가능하게 합니다. 텍스트 조건, 액션 라벨, 또는 빈 조건을 포함한 다양한 입력 조건에 기반하여 3D 관절 회전, 위치, 속도, 발 접촉 정보를 결합한 모션 표현을 사용합니다.

**3.2 Motion Mamba**

Motion Mamba의 아키텍처는 모션 프레임의 연속적인 시퀀스 모델링에 효과적인 denoising U-Net 구조를 사용합니다. 이 모델은 HTM 블록을 통해 시간적 정보를 처리하고, BSM 블록을 통해 공간적 동역학을 분석합니다.

- **계층적 시간 Mamba (HTM) 블록**: HTM 블록은 잠재 표현을 순차적으로 배열하고, 다양한 깊이에서 시간 의존성을 식별하여 모션 시퀀스의 내재된 동역학을 깊이 이해합니다. 이를 통해 모델은 시간에 따른 모션의 일관성을 증가시키는 데 기여합니다.
- **양방향 공간 Mamba (BSM) 블록**: BSM 블록은 차원 재배열과 양방향 스캔을 통해 잠재 표현 학습을 강화합니다. 이 과정은 모델이 전방 및 후방 데이터를 분석함으로써 정보 흐름의 연속성을 보장하고, 정확한 모션 생성을 위한 밀도 있는 정보 교환을 촉진합니다.

이러한 구성 요소들은 Motion Mamba가 텍스트로부터 모션을 생성할 때, 정확성과 효율성 사이의 뛰어난 균형을 달성하도록 합니다. 실험 결과, Motion Mamba는 HumanML3D 데이터셋에서 이전의 최고 성능 지표를 상당히 개선하며, 특히 Fréchet Inception Distance(FID)를 50% 감소시키고, 추론 속도를 4배 향상시키는 등 뛰어난 성능을 보여줍니다. 이를 통해, 본 연구는 효율적이고 정확한 장기 모션 생성을 위한 새로운 방법론을 제시하며, 인간 모션 생성 분야에서의 기술적 발전을 이끌어낼 것으로 기대됩니다.

- Fréchet Inception Distance(FID)
    
    Fréchet Inception Distance(FID)는 생성 모델이 생성한 이미지의 품질을 평가하는 데 널리 사용되는 지표입니다. 특히, 생성된 이미지와 실제 이미지 사이의 통계적 거리를 측정하여, 생성된 이미지의 현실성과 다양성을 모두 평가할 수 있습니다. FID 점수는 낮을수록 생성된 이미지가 실제 이미지와 유사하다는 것을 의미하며, 높은 품질의 이미지 생성을 나타냅니다.
    
    FID 계산 과정은 다음과 같습니다:
    
    1. **특성 추출**: 먼저, Inception v3 네트워크와 같은 사전 학습된 딥 러닝 모델을 사용하여, 실제 이미지 데이터셋과 생성된 이미지 데이터셋에서 각각의 특성을 추출합니다. 이 때, 네트워크의 중간 층에서 추출한 특성은 이미지의 중요한 시각적 정보를 포함합니다.
    2. **통계적 분석**: 추출된 특성에 대해 각 데이터셋의 평균과 공분산을 계산합니다. 이 통계적 정보는 각 데이터셋의 분포를 나타내며, 실제 이미지 데이터셋과 생성된 이미지 데이터셋 간의 차이를 측정하는 데 사용됩니다.
    3. **거리 계산**: 계산된 평균과 공분산을 바탕으로, 두 분포 간의 Fréchet 거리(또는 Wasserstein-2 거리라고도 함)를 계산합니다. 이 거리는 두 분포의 유사성을 정량적으로 평가하며, FID 점수로 사용됩니다.
    
    FID는 생성된 이미지가 실제 이미지와 얼마나 유사한지, 그리고 생성된 이미지들 사이에 얼마나 다양성이 있는지를 함께 평가할 수 있는 강력한 지표입니다. 따라서 GAN(생성적 적대 신경망)이나 다른 이미지 생성 모델의 성능을 비교하고 평가하는 데 자주 사용됩니다. FID 점수는 생성 모델의 개선 사항을 명확하게 파악하고, 모델 간의 성능 비교에 유용한 기준을 제공합니다.
    

4 Experiments

본 연구에서 수행된 실험은 제안된 'Motion Mamba' 프레임워크의 효과성과 효율성을 검증하기 위해 설계되었습니다. 이를 위해, 인간 모션 생성의 두 주요 벤치마크인 HumanML3D와 KIT-ML 데이터셋에서 모델의 성능을 평가하고, 다양한 평가 지표를 사용하여 기존 방법들과의 비교 분석을 수행했습니다.

**4.1 데이터셋**

- **HumanML3D**: 14,616개의 모션과 44,970개의 텍스트 설명이 포함된 데이터셋으로, 다양한 액션(운동, 춤, 아크로바틱 등)을 포괄합니다.
- **KIT-ML**: 3,911개의 모션과 6,278개의 텍스트 설명을 포함하며, 이는 더욱 컴팩트한 벤치마크를 제공합니다.

**4.2 평가 지표**

- **생성 품질**: 모델이 생성한 모션의 현실성과 다양성을 평가하기 위해 Fréchet Inception Distance(FID)와 다중 모달 거리(MM Dist)를 사용합니다.
- **다양성**: 생성된 모션의 다양성을 측정하기 위해 변동성 지표와 같은 다양성 평가 지표를 사용합니다.

**4.3 비교 연구**

HumanML3D와 KIT-ML 데이터셋에 대한 실험을 통해, Motion Mamba는 다양한 평가 지표에서 기존 방법들을 상당히 뛰어넘는 성능을 보여주었습니다. 특히, FID 점수에서 40.5%의 개선을 보이고, 추론 속도에서도 4배 빠른 성능을 달성하여, 높은 효율성과 우수한 모션 생성 품질을 입증했습니다.

**4.4 아블레이션 연구**

- **장기 시퀀스 모션 생성**: HumanML3D-LS라는 새로운 데이터셋 변형을 통해, 장기 시퀀스 모션 생성에 대한 모델의 능력을 평가했습니다. 결과적으로 Motion Mamba는 장기 의존성 모델링의 이점을 활용하여 뛰어난 성능을 보였습니다.
- **HTM 및 BSM 블록**: HTM의 계층적 설계와 BSM의 양방향 설계가 모델 성능에 미치는 영향을 조사했습니다. 이를 통해 모델의 최적화된 구조를 도출하고, 시간적 및 공간적 모션 데이터 처리 능력을 개선했습니다.

**4.5 추론 시간**

Motion Mamba는 기존의 강력한 기준 모델인 MLD와 비교하여 추론 시간을 크게 단축시켰습니다. 평균 추론 시간을 0.217초에서 0.058초로 줄임으로써, 실시간 추론 속도를 달성하는 데 성공했습니다.

![이 그림은 문장당 평균 추론 시간(AIT) 대비 FID를 보여줍니다. 우리가 제안한 Motion Mamba는 전반적으로 0.058초의 AIT와 0.281의 FID를 달성하여 이전 방법들을 모두 능가했습니다. 모든 방법은 단일 V100 GPU에서 평가되었습니다.](Motion%20Mamba%20Efficient%20and%20Long%20Sequence%20Motion%20Ge%209364f0d269b74f11bd53425833eaa448/Untitled%202.png)

이 그림은 문장당 평균 추론 시간(AIT) 대비 FID를 보여줍니다. 우리가 제안한 Motion Mamba는 전반적으로 0.058초의 AIT와 0.281의 FID를 달성하여 이전 방법들을 모두 능가했습니다. 모든 방법은 단일 V100 GPU에서 평가되었습니다.

이러한 실험 결과는 Motion Mamba가 인간 모션 생성 작업에서 우수한 정확도와 효율성을 제공함을 명확하게 보여줍니다. 모델은 텍스트에서 모션으로의 정확한 변환 능력을 향상시키는 동시에, 빠른 추론 속도를 통해 실용적인 응용 가능성을 크게 높였습니다.

### 5 Discussion and Conclusion

본 연구에서 소개한 'Motion Mamba'는 인간 모션 생성을 위한 새로운 프레임워크로, 효율적이고 장기 범위의 모션 생성에 초점을 맞추고 있습니다. 이 연구는 특히 계층적 시간 Mamba(Hierarchical Temporal Mamba, HTM) 블록과 양방향 공간 Mamba(Bidirectional Spatial Mamba, BSM) 블록을 통한 혁신을 제안하며, 이를 통해 모션 생성 과정에서의 시간적 정렬과 공간적 정보 흐름의 교환을 강화합니다.

Motion Mamba는 기존의 확산 기반 모션 생성 방법과 비교하여 상당한 성능 개선을 보였습니다. 특히 Fréchet Inception Distance(FID) 점수에서 최대 50%의 개선을 보였고, 추론 속도 역시 기존 방법에 비해 4배 향상되었습니다. 이러한 결과는 제안된 모델이 모션 생성 작업에서 높은 정확도와 효율성을 달성할 수 있음을 명확하게 입증합니다.

본 연구의 기여는 크게 세 가지로 요약할 수 있습니다. 첫째, 모션 생성 작업에 선택적 스캐닝 메커니즘을 통합하는 새로운 프레임워크, Motion Mamba를 도입했습니다. 둘째, HTM과 BSM 모듈을 포함하여 시간적 및 공간적 모델링을 강화한 새로운 접근 방식을 개발했습니다. 셋째, 텍스트-투-모션 생성 작업에 대한 실험을 통해 제안된 프레임워크의 우수성을 입증했습니다.

이러한 성과에도 불구하고, Motion Mamba가 해결해야 할 몇 가지 도전 과제가 남아 있습니다. 예를 들어, 모델의 일반화 능력을 더욱 향상시키고, 더 다양한 형태의 입력에 대응할 수 있는 방법을 모색하는 것이 필요합니다. 또한, 모델의 구조적 복잡성을 줄이면서 성능을 유지하거나 향상시킬 수 있는 방법에 대한 추가 연구가 요구됩니다.

결론적으로, Motion Mamba는 인간 모션 생성 분야에 중요한 기여를 하며, 더 정확하고 효율적인 모션 생성을 가능하게 하는 새로운 방향을 제시합니다. 앞으로 이 분야에서의 연구가 계속해서 진행됨에 따라, Motion Mamba와 같은 혁신적인 접근 방식이 더욱 발전하고 다양한 응용 분야에서 활용될 수 있을 것으로 기대됩니다.