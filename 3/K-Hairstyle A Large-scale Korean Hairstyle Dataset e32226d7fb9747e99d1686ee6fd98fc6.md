# K-Hairstyle: A Large-scale Korean Hairstyle Dataset for Virtual Hair Editing and Hairstyle Classification

[https://arxiv.org/abs/2102.06288](https://arxiv.org/abs/2102.06288)

- Feb 2021

### 1. INTRODUCTION

개성을 표현하는 수단으로서 헤어스타일의 중요성이 높아지면서 가상 염색이나 헤어스타일 전송과 같은 기술에 대한 수요가 증가하고 있습니다. 최근 피가로 1k, 헤어스타일 30k와 같은 헤어스타일 데이터셋이 도입되었지만, 이러한 데이터셋은 낮은 이미지 해상도와 제한된 이미지 수량 등의 한계로 인해 기대 이하의 결과를 도출하는 데 한계가 있었습니다.

이러한 문제를 해결하기 위해 50만 개의 고해상도 이미지가 포함된 대규모 한국 헤어스타일 데이터셋인 K-헤어스타일을 소개합니다. 이 데이터 세트에는 한국에서 인기 있는 다양한 헤어스타일, 더 나은 염색과 전송을 위한 모발 분할 마스크, 모발 길이, 색상, 나이, 성별과 같은 특정 속성 레이블이 포함되어 있습니다.

개인정보 보호를 위해 이미지 속 얼굴은 흐릿하게 처리되어 있습니다. K-헤어스타일의 효과는 염색, 참조 기반 헤어스타일 전송, 헤어스타일 분류의 세 가지 애플리케이션을 통해 입증되었습니다. 얼굴이 흐릿하게 처리되었음에도 불구하고 염색과 헤어스타일 전이 모델은 실제로 잘 작동하는 것으로 확인되었습니다.

### 2. RELATED WORK

이 섹션에서는 K-헤어스타일을 기존의 다른 헤어스타일 데이터 세트와 비교합니다. 피가로 1k는 7개의 헤어스타일 클래스와 헤어 세분화 마스크 등의 기능을 갖춘 1,050개의 이미지를 포함하고 있지만 다양성이 제한적입니다. 헤어스타일 30k에는 64가지 헤어스타일의 30,000개 이미지가 있지만 고품질 염색 및 헤어스타일 전송 작업에 필수적인 헤어 세분화 마스크가 없습니다.

다른 두 개의 데이터 세트인 LFW 파트와 CelebA Mask-HQ에는 헤어, 피부, 배경의 세분화 마스크와 다양한 얼굴 속성이 있는 얼굴 이미지가 포함되어 있습니다. 그러나 헤어스타일 클래스 레이블이 없기 때문에 헤어스타일 분류 및 전송과 같은 작업에는 사용이 제한됩니다. 또한 이 데이터 세트의 최대 이미지 수는 30,000개이며, 가장 높은 이미지 해상도는 1024x1024입니다. 또한 개인별로 다양한 각도에서 촬영한 이미지가 없습니다.

반면, K-헤어스타일은 4032x3024 해상도로 50만 개의 이미지를 제공하며, 개인별로 다양한 각도에서 촬영한 이미지가 있습니다. 이 이미지에는 31가지 헤어스타일, 63가지 추가 속성, 헤어 세분화 마스크가 주석으로 제공됩니다. 따라서 K-헤어스타일은 염색, 헤어스타일 전이, 헤어스타일 분류 등 다양한 헤어스타일 관련 작업에 효과적으로 활용될 수 있습니다.

### 3. K-HAIRSTYLE

K-헤어스타일 데이터 세트에는 고사양 카메라로 수집한 50만 장의 고해상도 이미지가 포함되어 있으며, 이는 동종 데이터 세트 중 최대 규모입니다. 이 이미지는 개인별로 다양한 각도에서 촬영되었으며, 헤어 세분화 마스크와 31가지 헤어스타일 유형, 한국 전문 헤어스타일리스트가 라벨링한 63가지 추가 속성이 포함되어 있습니다. 개인정보 보호를 위해 모든 얼굴 영역은 블러 처리되었습니다.

데이터 수집 과정에는 미용 및 예술 업계 전문가들과 함께 한국 헤어스타일의 표준 카테고리를 설정하는 작업이 포함되었습니다. 전체 이미지 중 40만 장은 300명의 전문 헤어스타일리스트가 촬영했고, 나머지 10만 장은 크라우드 소싱 플랫폼을 통해 수집했습니다. 헤어스타일리스트가 캡처한 이미지와 크라우드 소싱 플랫폼에서 수집한 이미지는 큰 차이를 보이지 않았습니다.

모발 세분화 마스크에는 자동 라벨링 모델과 사람 라벨러를 조합하여 주석을 달았습니다. 모델이 초기 주석을 제공한 다음, 라벨러가 수동으로 주석을 다듬었습니다. 헤어스타일 유형, 길이, 컬 강도 등의 헤어스타일 속성은 전문 헤어스타일리스트가 라벨을 붙였습니다. 31가지 헤어스타일 클래스의 분포는 그림 1에 나와 있습니다.

### 4. K-HAIRSTYLE APPLICATIONS

이 섹션에서는 13만 개의 이미지 세트를 학습, 검증, 테스트 이미지로 나누어 사용하여 K-헤어스타일 데이터 세트의 세 가지 응용 분야인 염색, 헤어스타일 전이, 헤어스타일 분류에 대해 설명합니다.

![헤어 염색 결과.](K-Hairstyle%20A%20Large-scale%20Korean%20Hairstyle%20Dataset%20e32226d7fb9747e99d1686ee6fd98fc6/Untitled.png)

헤어 염색 결과.

염색: 모발 영역에 해당하는 세분화 마스크를 예측하기 위해 다양한 세분화 모델을 학습하고 평가했습니다. 평가된 모델에는 U-Net, 특징 피라미드 네트워크(FPN), 피라미드 장면 구문 분석 네트워크(PSPNet), DeepLabv3+, 피라미드 주의 네트워크(PAN)가 포함되었습니다. PAN 모델이 가장 우수한 성능을 보였습니다. 헤어 세분화 마스크를 예측한 후, K-최근접 이웃 매팅을 사용하여 알파 매팅과 헤어 염색이라는 프로세스를 수행하여 사실적인 헤어 염색 이미지를 생성합니다.

![우리의 헤어 염색 접근법 개요.](K-Hairstyle%20A%20Large-scale%20Korean%20Hairstyle%20Dataset%20e32226d7fb9747e99d1686ee6fd98fc6/Untitled%201.png)

우리의 헤어 염색 접근법 개요.

헤어스타일 전송: K-헤어스타일은 StarGAN v2라는 모델을 사용하여 한 이미지의 헤어스타일을 다른 이미지로 전송하는 헤어스타일 전송도 지원합니다. 이 모델은 성별이나 시야각이 다른 경우에도 참조 이미지에서 스타일을 추출하여 대상 이미지에 적용할 수 있습니다. 전송된 이미지의 품질은 FID(프레셰 시작 거리) 점수를 사용하여 측정되었으며 평균 14.67점을 기록했습니다.

![헤어 전송 결과.](K-Hairstyle%20A%20Large-scale%20Korean%20Hairstyle%20Dataset%20e32226d7fb9747e99d1686ee6fd98fc6/Untitled%202.png)

헤어 전송 결과.

헤어스타일 분류: K-헤어스타일 데이터 세트는 헤어스타일 분류에도 사용되었습니다. 속성 수, 데이터 증강, 이미지 자르기가 분류 정확도에 미치는 영향을 분석하기 위해 제거 연구를 수행했습니다. 길이, 성별, 각도 등의 속성을 추가하여 학습하면 정확도가 향상되었습니다. ResNet18, ResNet50, ResNet101, Wide-ResNet50 등 다양한 모델 중에서 ResNet101이 가장 높은 분류 정확도를 달성했습니다.

### 5. CONCLUSION

결론적으로 이 논문에서는 새로운 대규모 한국 헤어스타일 데이터셋인 K-헤어스타일을 소개합니다. 이 데이터셋은 50만 개의 고해상도 이미지, 모발 분할 마스크, 다양한 속성 레이블을 포함하고 있어 기존 데이터셋보다 훨씬 더 광범위하고 다양합니다. K-헤어스타일의 효과는 염색, 헤어스타일 전이, 헤어스타일 분류 등 세 가지 애플리케이션을 통해 입증되었습니다. 저자들은 K-헤어스타일 데이터셋이 헤어스타일 편집 및 조작 분야에서 다양한 연구 기회를 제공할 것으로 기대하고 있습니다.