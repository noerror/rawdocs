# 3D-LFM: Lifting Foundation Model

[https://3dlfm.github.io/](https://3dlfm.github.io/)

[https://arxiv.org/abs/2312.11894](https://arxiv.org/abs/2312.11894)

- Dec 2023

![(a) 이 그림은 인체 부위부터 수많은 동물과 일상적인 사물에 이르기까지 30개가 넘는 다양한 카테고리에 걸쳐 2D 랜드마크를 3D 구조로 변환하는 3D-LFM의 능력을 보여줍니다. 아래쪽은 유니티 모델이 실제 3D로 재구성한 결과물이며, 빨간색 선은 실측 데이터를, 파란색 선은 3D-LFM의 예측 결과를 나타냅니다. (b) 이 그림은 모델의 훈련 데이터 분포를 로그 스케일로 표시한 것으로, 3D-LFM이 불균형한 데이터 세트로 훈련되었음에도 불구하고 개별 범주에 걸쳐 성능을 유지한다는 점을 강조합니다.](3D-LFM%20Lifting%20Foundation%20Model%20258b795c743847649f7f8fdc10e5ce57/Untitled.png)

(a) 이 그림은 인체 부위부터 수많은 동물과 일상적인 사물에 이르기까지 30개가 넘는 다양한 카테고리에 걸쳐 2D 랜드마크를 3D 구조로 변환하는 3D-LFM의 능력을 보여줍니다. 아래쪽은 유니티 모델이 실제 3D로 재구성한 결과물이며, 빨간색 선은 실측 데이터를, 파란색 선은 3D-LFM의 예측 결과를 나타냅니다. (b) 이 그림은 모델의 훈련 데이터 분포를 로그 스케일로 표시한 것으로, 3D-LFM이 불균형한 데이터 세트로 훈련되었음에도 불구하고 개별 범주에 걸쳐 성능을 유지한다는 점을 강조합니다.

### 1. Introduction

2D 랜드마크를 단일 뷰 RGB 이미지에서 3D 모델로 변환하는 작업, 즉 2D-3D 리프팅은 컴퓨터 비전 분야에서 복잡하고 역사적으로 어려운 작업입니다. 이 프로세스는 증강 현실과 로봇 공학 등 다양한 애플리케이션에 매우 중요합니다. 이전의 접근 방식은 물체별 모델에 대한 의존성, 낮은 확장성, 다양한 물체에 대한 제한된 적응성 등의 문제에 직면했습니다. 이러한 방식은 인체나 손 모델링과 같은 특정 영역에서는 발전했지만, 다양한 객체 유형과 구성에는 어려움을 겪었습니다.

최근에는 이러한 문제를 해결하기 위해 C3DPO와 같은 딥러닝 방법이 개발되었습니다. 하지만 이 방법들은 객체 범주에 대한 사전 지식이 필요하고 2D와 3D 데이터 간의 의미적 대응이 필요하다는 한계가 있습니다. 이러한 한계를 극복하기 위해 본 백서에서는 단일 프레임 2D-3D 리프팅에 대한 객체 불가지론적 접근 방식인 3D 리프팅 기초 모델(3D-LFM)을 소개합니다. 3D-LFM은 순열 등가성을 활용하여 다양한 2D 키포인트 세트 간의 대응을 자율적으로 설정함으로써 다양한 오브젝트 카테고리를 효율적으로 처리합니다.

3D-LFM의 주요 특징
3D-LFM은 단일 모델을 사용하여 30개 이상의 다양한 카테고리에 대해 2D-3D 리프팅을 수행할 수 있는 놀라운 다용도성을 보여줍니다. 여기에는 사람, 동물, 다양한 무생물이 포함됩니다. 개별 카테고리에 최적화된 메서드의 성능과 일치하며, 훈련 중에 볼 수 없는 분포 외(OOD) 객체 카테고리와 구성을 처리하여 일반화 가능성을 보여줍니다. 이러한 능력은 순열 등가성 속성과 특정 설계 선택을 사용하여 훈련 중에 일반적인 구조적 특징을 학습함으로써 달성됩니다.

또한 이 모델은 직교-N-포인트(OnP) 또는 원근-N-포인트(PnP)와 같은 프로크루스테인 방식을 통합하여 표준 프레임 내에서 변형 가능한 측면에 초점을 맞춥니다. 이를 통해 계산 부하가 줄어들고 모델이 오브젝트의 진정한 기하학적 본질을 포착할 수 있습니다. 확장성은 그래프 기반 트랜스포머 아키텍처와 결합된 토큰화된 위치 인코딩(TPE)으로 더욱 향상되어 다양한 카테고리와 다양한 수의 키포인트에 대한 적응성을 용이하게 합니다. 그래프 기반 트랜스포머 내에서 스켈레톤 정보를 사용하면 다양한 객체 범주에서 대응을 처리하는 데 도움이 됩니다.

기여 및 결과
이 백서에는 세 가지 주요 기여 사항이 요약되어 있습니다:

2D 랜드마크에서 순열 등가성을 유지하면서 객체의 변형 가능한 측면을 학습하는 데 중점을 둔 프로크루스테인 트랜스포머.
토큰화된 위치 인코딩의 통합으로 확장성을 개선하고 다양한 데이터 세트를 처리합니다.
3D-LFM이 사람, 손, 얼굴 등 다양한 범주에서 기존 방식보다 성능이 뛰어나다는 것을 입증했습니다. 또한 동물, 무생물, 새로운 배열과 같이 눈에 보이지 않는 물체와 구성을 처리할 때 강력한 일반화를 보여줍니다.
이 논문은 상세한 실험과 비교 분석을 통해 3D-LFM의 설계와 방법론을 더 자세히 살펴봅니다. 논문 전체에서 '키포인트', '랜드마크', '조인트'와 같은 용어는 물체의 구조와 형상을 이해하는 데 중요한 물체의 특정 지점을 의미합니다.

### 2. Related works

2D-3D 리프팅 기술의 진화
컴퓨터 비전의 2D-3D 리프팅 기술은 수년에 걸쳐 상당한 발전을 거듭해 왔습니다. 초기에는 퍼스펙티브 앤 포인트(PnP) 알고리즘과 같은 방법이 널리 사용되었습니다. 이러한 초기 기술은 물체의 3D 구조를 이미 알고 있는 2D 랜드마크와 3D 슈퍼비전의 조합에 의존했습니다. 이러한 접근 방식은 기본적이기는 하지만 유연성과 적용 범위 측면에서 한계가 있었습니다.

![3D 리프팅 파운데이션 모델(3D-LFM) 아키텍처 개요: 이 프로세스는 입력 2D 키포인트가 일련의 그래프 기반 트랜스포머 레이어에서 처리되기 전에 토큰 위치 인코딩(TPE)을 거치는 것으로 시작됩니다. 그런 다음 결과 피처는 MLP를 통해 표준 3D 모양으로 디코딩됩니다. 이 형상은 프로크루스테인 방법을 사용하여 기준 프레임의 실측 기준(G.T. 3D)에 정렬되며, 학습을 안내하기 위해 평균제곱오차(MSE) 손실이 계산됩니다. 이 아키텍처는 계산 복잡성을 최소화하면서 변형 가능한 구조에 초점을 맞춰 로컬 및 글로벌 컨텍스트 정보를 모두 캡처합니다.](3D-LFM%20Lifting%20Foundation%20Model%20258b795c743847649f7f8fdc10e5ce57/Untitled%201.png)

3D 리프팅 파운데이션 모델(3D-LFM) 아키텍처 개요: 이 프로세스는 입력 2D 키포인트가 일련의 그래프 기반 트랜스포머 레이어에서 처리되기 전에 토큰 위치 인코딩(TPE)을 거치는 것으로 시작됩니다. 그런 다음 결과 피처는 MLP를 통해 표준 3D 모양으로 디코딩됩니다. 이 형상은 프로크루스테인 방법을 사용하여 기준 프레임의 실측 기준(G.T. 3D)에 정렬되며, 학습을 안내하기 위해 평균제곱오차(MSE) 손실이 계산됩니다. 이 아키텍처는 계산 복잡성을 최소화하면서 변형 가능한 구조에 초점을 맞춰 로컬 및 글로벌 컨텍스트 정보를 모두 캡처합니다.

딥러닝 접근 방식으로의 전환
딥러닝 방법론이 도입되면서 큰 변화가 일어났습니다. C3DPO, PAUL, Deep NRSfM과 같은 혁신적 방법론과 NRSfMFormer와 같은 트랜스포머 기반 방법론이 새로운 시대를 열었습니다. 이러한 고급 기술은 특정 3D 개체에 대한 명시적인 지식이 필요하지 않습니다. 대신 2D 랜드마크와 모델링 중인 오브젝트 카테고리의 2D/3D 데이터 집합에 대한 해당 데이터만 있으면 작동합니다. 이는 이 분야에서 상당한 도약을 의미하며, 더욱 다양하고 강력한 모델링 기능을 가능하게 합니다.

현재 방법의 한계
이러한 발전에도 불구하고 딥러닝 방법에는 내재적인 한계가 있습니다. 여전히 2D 데이터와 3D 데이터 간의 의미론적 대응이 필요합니다. 즉, 각 랜드마크는 모든 인스턴스(예: 의자의 특정 부분)에서 일관되게 동일한 의미를 가져야 합니다. 이 요구 사항은 이러한 방법을 효과적으로 적용하기 위해 객체 범주와 구조적 리깅에 대한 세부적인 지식이 필요하기 때문에 실질적인 어려움을 야기합니다. 따라서 이러한 방법은 다양한 오브젝트와 리그에 걸쳐 있는 데이터 세트를 활용하는 데 한계가 있으며, 일반화 가능한 2D-3D 리프팅 파운데이션 모델을 만드는 데 방해가 됩니다.

포즈 추정의 발전
포즈 추정 분야, 특히 인체 및 동물 신체 모델링 분야에서도 이와 관련된 발전이 이루어졌습니다. 조인트포머와 심플베이스라인 같은 모델은 단일 프레임 2D-3D 리프팅 프로세스를 개선했습니다. 또한 MotionCLIP 및 휴먼 모션 확산 모델과 같은 제너레이티브 접근 방식은 3D 제너레이티브 모션 기반 파운데이션 모델을 위한 발판을 마련했습니다. 하지만 이러한 접근 방식은 각각의 오브젝트 클래스에 더욱 특화되어 있으며 광범위한 오브젝트 유형에 쉽게 적용하기는 어렵습니다.

요약하자면, 2D-3D 리프팅 분야는 특히 딥러닝의 등장으로 상당한 진전을 이루었지만, 현재의 방법론은 다양한 오브젝트 유형과 카테고리에 걸쳐 유연성과 일반화 가능성 측면에서 여전히 도전에 직면해 있습니다. 이러한 한계는 이 분야에서 현재 진행 중인 연구 개발의 주요 초점 분야입니다.

### 3. Approach

주요 처리 단계

이 접근 방식에는 이미지에서 물체의 관절 투영을 나타내는 2D 키포인트 세트를 처리하는 과정이 포함됩니다. 이러한 키포인트는 매트릭스로 구성됩니다.
W 행렬로 구성되며, 모든 객체 범주에서 고려되는 최대 관절 수는 미리 정해져 있습니다. 조인트 수가 적은 객체에는 이진 마스크 매트릭스를 활용하는 마스킹 메커니즘이 사용됩니다.
M을 사용하여 각 관절의 유무를 나타냅니다. 3D 리프팅 기능은 이러한 2D 키포인트를 해당 3D 구조에 매핑하여 직교 투영을 보정합니다.

![이 그림은 다양한 조인트 배열을 가진 Acinoset [10] PASCAL3D+ [26]에서 볼 수 없었던 새로운 범주를 효과적으로 처리하여 강력한 일반화 기능을 입증하는 3D-LFM의 OOD 2D-3D 리프팅 숙련도를 보여줍니다.](3D-LFM%20Lifting%20Foundation%20Model%20258b795c743847649f7f8fdc10e5ce57/Untitled%202.png)

이 그림은 다양한 조인트 배열을 가진 Acinoset [10] PASCAL3D+ [26]에서 볼 수 없었던 새로운 범주를 효과적으로 처리하여 강력한 일반화 기능을 입증하는 3D-LFM의 OOD 2D-3D 리프팅 숙련도를 보여줍니다.

순열 등분 및 누락된 데이터 처리

이 접근 방식의 중요한 측면은 순서에 관계없이 입력 키포인트를 처리할 수 있는 순열 등가성의 속성을 활용하는 것입니다. 이는 다양한 조인트 구성을 가진 객체를 처리하는 데 필수적입니다. 데이터 누락 문제를 해결하기 위해 마스킹 메커니즘이 사용됩니다. 이 접근 방식에는 보이는 키포인트의 평균을 빼서 데이터의 영점 중심을 잡고 키포인트의 기하학적 무결성을 유지하기 위해 스케일을 조정하는 것도 포함됩니다.

토큰 위치 인코딩

기존의 대응 위치 인코딩(CPE)은 명시적인 대응이나 의미 정보가 필요하지 않은 토큰 위치 인코딩(TPE)으로 대체되었습니다. TPE는 분석적 랜덤 푸리에 기능을 사용하여 키포인트의 상대적 위치를 인코딩하고 순열 등가성을 유지합니다.

그래프 기반 트랜스포머 아키텍처

이 모델은 로컬 및 글로벌 주의 메커니즘을 결합한 그래프 기반 트랜스포머 아키텍처를 사용합니다. 이 아키텍처는 로컬 및 글로벌 특징 집합을 통해 특징 행렬을 처리한 다음 정규화 및 가우스 오류 선형 단위(GeLU) 함수가 있는 다층 퍼셉트론을 처리합니다. 이 방법은 로컬 이웃 연결과 글로벌 데이터 컨텍스트를 모두 고려하여 복잡한 패턴을 학습하도록 설계되었으며, 이는 강력한 2D에서 3D 구조 리프팅에 매우 중요합니다.

프로크루스테인 정렬

마지막 단계는 잠재적 특징 표현을 예측된 표준 구조로 디코딩하고 프로크루스테인 정렬 방법을 통해 기준 진실 구조와 정렬하는 것입니다. 이 단계에서는 강체 역학에 대한 비강체 형상 변형을 학습하는 데 중점을 두어 물체의 실제 기하학적 본질을 포착하는 모델의 능력을 크게 향상시킵니다.

손실 함수

모델 최적화는 예측된 3D 포인트와 실측 데이터 간의 차이를 계산하는 평균 제곱 오차(MSE) 손실에 의존합니다. 이 손실을 최소화하면 모델이 입력된 2D 랜드마크로부터 정확한 3D 모양을 재구성할 수 있으며, 정확한 2D에서 3D로의 리프팅을 위해 물체의 필수적인 비강체 특성에 초점을 맞출 수 있습니다.

### 4. Results and Comparative Analysis

3D 리프팅 파운데이션 모델(3D-LFM)은 다양한 물체 범주에 걸쳐 단일 프레임 2D-3D 리프팅 기능에 대해 광범위하게 평가되었습니다. 그 결과 물체별 데이터 없이도 다양한 물체 유형을 처리할 수 있는 적응성, 효율성, 견고성을 입증했습니다. 평가의 주요 섹션에는 다중 오브젝트 3D 재구성, 오브젝트별 모델에 대한 벤치마크, 기초 모델 기능, 절제 연구가 포함됩니다.

4.1 멀티 오브젝트 3D 재구성

3D-LFM은 순열 등가성의 강점을 활용하여 다양한 2D 키포인트를 처리하고 여러 오브젝트 범주에 걸쳐 3D로 변환하는 데 탁월합니다. 즉, 키포인트 순서에 관계없이 일관된 성능을 발휘하므로 키포인트 번호가 다양한 여러 개체를 처리하는 데 매우 중요합니다. 3D-LFM은 특히 오브젝트별 데이터가 제공되지 않는 경우 C3DPO와 같이 오브젝트별 입력이 필요한 방식과 비교했을 때 우수한 성능을 보여줍니다.

4.2 오브젝트별 모델에 대한 벤치마크

인체, 얼굴, 손에 대한 특수한 방법에 대한 벤치마크에서 3D-LFM은 이러한 모델보다 성능이 뛰어나며 광범위한 유용성과 다용도성을 강조합니다. 이 모델의 성능은 전신 포즈 추정을 위한 포괄적인 벤치마크인 H3WB 데이터 세트를 사용하여 테스트되었습니다. 그 결과 다른 모델에 비해 더 작은 아키텍처에서도 3D-LFM의 뛰어난 정확도와 빠른 수렴이 입증되었습니다.

4.3 기초 모델을 향해

3D-LFM은 30개 이상의 객체 범주를 처리할 수 있는 다목적 기초 모델임이 입증되었습니다. 보이지 않는 오브젝트 카테고리에 대한 일반화 능력과 릭 구성을 전송할 때 적응력을 보여줍니다. 이 모델은 불균형한 데이터 세트를 효과적으로 관리하고 결합된 데이터 세트 학습에서 상당한 개선을 보여줍니다.

4.3.1 결합된 데이터 세트 훈련

다양한 물체 범주를 포괄하는 결합된 데이터 세트에 대한 훈련은 분리된 훈련에 비해 성능이 눈에 띄게 향상되었습니다. 이는 사전 훈련 프레임워크로서 3D-LFM의 잠재력과 다양한 데이터 수집에 대한 적응성을 입증합니다.

4.3.2 OOD 일반화 및 릭 전송

이 모델의 일반화 능력은 보이지 않는 물체 범주와 다양한 리그 구성을 정확하게 3D로 재구성하는 데서 잘 드러납니다. 이러한 측면은 3D 리프팅 영역에서 3D-LFM의 기초적인 잠재력을 강조합니다.

4.4 절제 연구

절제 연구는 설계 선택과 모델 성능에 대한 기여도를 분석하는 데 중점을 둡니다. 여기에는 다음이 포함됩니다:

프로크루스테스 변환: 사물의 변형 가능한 구성 요소에 대한 학습을 개선하고 더 낮은 오류율로 더 빠른 수렴을 달성하는 데 효과적인 것으로 입증되었습니다.

로컬-글로벌 대 하이브리드 주의: 로컬 및 글로벌 주의 메커니즘의 조합이 최고의 성능을 발휘하여 3D-LFM의 아키텍처적 결정을 검증했습니다.

토큰화된 위치 인코딩(TPE): 분석적 랜덤 푸리에 피처를 활용하는 TPE를 사용하면 데이터 불균형과 리그 전송 일반화를 처리하는 데 상당한 개선이 있었습니다.

![분석적 TPE를 사용한 리그 전송의 질적 개선과 학습 가능한 MLP 투영 비교. 이 시각화는 훈련 중에 볼 수 없는 다양한 리그와 같은 OOD 데이터를 처리하는 데 있어 TPE의 필요성을 강조합니다.](3D-LFM%20Lifting%20Foundation%20Model%20258b795c743847649f7f8fdc10e5ce57/Untitled%203.png)

분석적 TPE를 사용한 리그 전송의 질적 개선과 학습 가능한 MLP 투영 비교. 이 시각화는 훈련 중에 볼 수 없는 다양한 리그와 같은 OOD 데이터를 처리하는 데 있어 TPE의 필요성을 강조합니다.

요약하면, 결과와 분석을 통해 3D-LFM이 다양한 2D-3D 리프팅 작업을 위한 다재다능하고 강력한 기본 모델로서 전문화된 카테고리별 모델을 능가하고 광범위한 물체 카테고리와 구성을 처리할 수 있음을 확인할 수 있습니다.

### 5. Discussion and Conclusion

3D-LFM은 2D 데이터에서 3D를 재구성하는 새로운 표준을 제시하며, 다양한 애플리케이션에 유연하고 보편적으로 적용할 수 있는 모델을 제공합니다. 한계에도 불구하고 이 모델의 기본 속성은 이전에는 볼 수 없었던 다양한 범주에서 정확한 2D-3D 리프팅을 위한 강력한 도구입니다. 이 연구는 3D 포즈 추정 및 3D 재구성 모델의 향후 개발을 위한 확장 가능한 프레임워크를 구축하여 지속적인 연구와 개선을 위한 유망한 방향을 제시합니다.