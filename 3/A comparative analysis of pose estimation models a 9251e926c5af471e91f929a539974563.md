# A comparative analysis of pose estimation models as enablers for a smart-mirror physical rehabilitation system

[https://www.sciencedirect.com/science/article/pii/S1877050922012017?ref=cra_js_challenge&fr=RR-1](https://www.sciencedirect.com/science/article/pii/S1877050922012017?ref=cra_js_challenge&fr=RR-1)

### 1 Introduction

이 문서는 고령자의 독립적인 생활을 돕기 위한 디지털 지원 시스템을 개발하는 것을 목표로 하는 SHAPES라는 프로젝트에 관한 것입니다. 이 프로젝트의 일환 중 하나는 고령자의 운동이나 재활을 돕는 스마트 거울을 개발하는 것입니다.

스마트 거울은 컴퓨터와 디스플레이가 내장된 일반 거울입니다. 디스플레이를 켜면 거울이 '스마트'해져 캘린더 알림과 같은 정보를 제공하고, 사용자 활동을 모니터링하며, 홈 게이트웨이로 작동할 수 있습니다. 주요 용도 중 하나는 노년층의 신체 운동이나 재활 루틴을 돕는 것입니다.

스마트 미러는 각 운동에 대한 지침을 제공하고 신체 자세를 모니터링하여 올바른 운동 수행에 대한 피드백을 제공합니다. 이 과정은 사용자의 자세를 추출하여 미리 모델링된 운동 설정과 비교하는 RGB 카메라를 통해 이루어집니다.

또한 미러는 세션 수, 운동당 실행 횟수, 정확도 등 수행한 재활 루틴에 대한 보고서를 생성합니다.

연구진은 스마트 미러 장치와의 호환성을 위해 여러 비전 기반 신체 자세 추정 모델을 비교했습니다. 빛, 피사체와의 거리, 카메라 품질, 처리 요구 사항, 각 모델의 전반적인 성능과 같은 변수를 고려했습니다.

스마트 미러 장치에 채택된 플랫폼은 효율성, 크기, 비용, 컴퓨팅 성능 등을 고려하여 라즈베리 파이를 선택했습니다. 그러나 비디오 스트림을 분석하거나 표시하는 작업을 수행할 때 문제가 발견되었습니다.

이 논문은 신체 자세 추정을 위한 요구 사항, 분석에 고려되는 모델, 모델 비교를 위해 제안된 방법론, 비교를 통해 얻은 결과에 대해 설명하는 섹션으로 구성되어 있습니다. 논문은 연구에서 가장 관련성이 높은 결과를 요약하는 것으로 마무리됩니다.

### 2. Smart mirror requirements for the pose estimation model

이 연구에 사용된 스마트 미러 애플리케이션은 비디오 스트림에서 지속적인 자세 추정을 포함합니다. 이렇게 추정된 자세는 재활 루틴의 '올바른' 자세 역할을 하는 모델링된 운동과 비교됩니다. 사용자의 자세와 올바른 자세 사이의 편차가 감지되어 사용자가 자세를 교정할 수 있도록 안내하는 데 사용됩니다.

적절한 포즈 추정 모델을 선택할 때 다음과 같은 사항을 고려해야 했습니다:

전반적인 평균 정밀도도 중요하지만, 재활 루틴과 관련된 신체 부위의 경우 특히 높은 정밀도가 중요합니다.

빠른 추론과 모델의 리소스 수요 사이의 균형이 필요합니다. 시스템은 실시간으로 이미지를 처리해야 하고 컴퓨터가 스마트 미러 장치에 내장되어 있어 물리적 공간이 제한적입니다.

스마트 미러 디바이스의 배치가 달라질 때마다 모델을 학습시킬 수 없기 때문에 견고성과 유연성이 요구됩니다.

이 시스템은 특정 목적을 위해 훈련된 모델을 기반으로 하지 않습니다. 대신 모든 시스템 배포에서 모델 가중치를 조정할 필요 없이 인체 자세를 추정할 수 있는 '일괄' 모델에 의존합니다. 또한 이 모델은 실시간으로 작동하기 위해 가능한 한 빠르게 실행되어야 합니다.

### 3. Pose estimation models

이 연구에서는 무브넷, 블레이즈포즈, 포즈넷의 세 가지 포즈 추정 모델을 다양한 환경에서 정확도, 속도 및 전반적인 성능을 평가했습니다. 이 모델들은 모두 텐서플로우 자바스크립트 형식으로 제공됩니다.

MoveNet: MobileNetV2 아키텍처를 기반으로 하는 이 모델은 RGB 이미지에서 2D 인체 관절 위치를 예측합니다. 두 가지 변형이 있습니다:

- Lightning: 빠르고 우수한 성능으로 실시간 추론에 적합합니다.
- Thunder: 더 나은 정확도를 제공하지만 속도가 약간 느립니다.

블레이즈포즈: MediaPipe의 포즈 솔루션의 일부로, 파이프라인 내에서 두 개의 개별 모델을 사용합니다:

- 블레이즈포즈 검출기: 사람의 관심 영역(ROI)을 감지합니다.
- BlazePose GHUM 3D: 원본 이미지와 감지된 ROI를 사용하여 2D 및 3D 키포인트를 계산하며, 후자는 엉덩이를 중심으로 참조합니다.

블레이즈포즈에는 여러 가지 변형이 있습니다:

- Lite: 정확도를 크게 떨어뜨리지 않으면서 빠릅니다.
- 헤비: 라이트 버전보다 느리지만 정확도가 높습니다.
- 전체: 라이트와 헤비 사이의 균형.

포즈넷: 모바일넷V1 아키텍처를 기반으로 하는 포즈넷은 최대 5명까지 동시에 인체 관절의 2D 위치를 예측할 수 있습니다. 그러나 이 연구에서는 다른 모델과의 비교를 위해 한 사람에 대해서만 감지를 수행했습니다.

![모델 키포인트 다이어그램. TensorFlow tfjs-models GitHub 저장소에서 얻음.](A%20comparative%20analysis%20of%20pose%20estimation%20models%20a%209251e926c5af471e91f929a539974563/Untitled.png)

모델 키포인트 다이어그램. TensorFlow tfjs-models GitHub 저장소에서 얻음.

각 모델은 다양한 키포인트가 있는 '골격'을 출력하며, 이는 원본 텍스트의 특정 그림으로 표현됩니다.

### 4. Comparison description

앞서 언급한 포즈 추정 모델의 비교는 맥락에 따른 공통 객체라고도 알려진 COCO 데이터 세트를 사용하여 수행되었습니다. 이는 컴퓨터 비전 기술을 통해 데이터를 추출하는 데 사용할 수 있는 주석이 달린 대규모 이미지 모음입니다. 이 연구에서는 키포인트 2017 검증 데이터 세트가 사용되었습니다.

평가를 수행하기 위해 적어도 한 명 이상의 사람이 포함된 모든 COCO 이미지를 각 모델에서 처리하여 해당 포즈 데이터를 COCO 결과 형식으로 얻었습니다. tfjs 모델의 업로드 비디오 데모는 비디오 파일 대신 COCO 이미지를 입력으로 사용하도록 수정되었습니다. 모든 이미지가 처리된 후에는 탐지 결과를 JSON 파일로 내보낸 다음, COCO-analyze의 실행 분석 도구와 함께 사용하여 모델의 정확도를 나타내는 차트를 얻었습니다.

평가는 COCOanalyze 클래스가 출력하는 특정 메트릭, 특히 모델의 정확도와 관련된 평균 정밀도(AP)와 평균 정확도(AR)에 중점을 두었습니다. 이 연구에서는 특히 예측된 로컬라이제이션 오류에 관심이 있었습니다:

- 지터: 정확한 키포인트 위치 주변의 작은 오차.
- 미스: 감지된 키포인트가 신체 부위와 근접하지 않아서 발생하는 큰 위치 정확도 오류.
- 반전: 동일한 인스턴스에 속하는 의미적으로 유사한 부분 간의 혼동.
- 스왑: 서로 다른 인스턴스의 의미적으로 유사한 부분 간의 혼동.

기준점과의 유사성 점수가 0.85를 초과하는 키포인트 감지는 양호한 것으로 간주됩니다. 이 임계값은 인간 주석가들이 정확한 위치를 추정하는 데 상당한 불일치가 발생하기 시작하는 지점이기 때문에 선택되었습니다.

평가는 주로 스마트 미러가 지원하는 재활 루틴에서 중요한 관절에 초점을 맞추었기 때문에 눈이나 귀와 같이 관련 없는 신체 부위의 위치 오류는 고려되지 않았습니다.

### 5. Results

섹션 4에 설명된 평가 프로세스에 따라 이동망, 블레이즈포즈, 포즈망 모델에 대한 로컬라이제이션 오류를 구했습니다. 이 비교에서는 무거운 모델과 크게 다르지 않은 결과가 나왔기 때문에 가벼운 MoveNet과 BlazePose의 변형을 사용했습니다.

결과는 다음과 같이 요약할 수 있습니다:

포즈넷은 48.6%의 예측이 양호로 분류되어 가장 적은 로컬라이제이션 오류를 발생시켰습니다. 오류는 지터, 미스, 스왑 오류로 거의 균등하게 나뉘었으며, 각각 약 15%의 비율을 차지했습니다. 이러한 오류의 영향을 가장 많이 받는 관절은 손목과 팔꿈치였습니다.

무브넷은 또한 43.4%의 예측이 양호한 것으로 분류되어 우수한 성능을 보였습니다. 가장 일반적인 오류 유형은 미스가 가장 많았고 지터가 그 뒤를 이었습니다. 포즈넷과 마찬가지로 손목과 팔꿈치는 오류의 영향을 가장 많이 받는 관절이었습니다.

반면 블레이즈포즈는 5.3%의 예측만 양호로 분류되어 성능이 좋지 않았습니다. 오차가 가장 큰 문제였으며, 손목, 팔꿈치, 엉덩이, 어깨가 이러한 오차의 영향을 가장 많이 받는 관절이었습니다.

이러한 결과를 보면 포즈넷이 이 특정 사용 사례에 가장 적합한 속도와 정확도의 균형을 제공하는 것으로 보입니다. MoveNet도 괜찮은 성능을 보여주지만, BlazePose는 이 특정 평가 설정에 대한 예측 정확도가 현저히 떨어지는 것으로 보입니다.

### 6. In the wild detections

'야생'이라는 용어는 특별히 훈련되지 않은 통제되지 않은 환경에서 모델을 사용하는 것을 의미합니다. 거울은 집이나 시설 내 어디에나 배치할 수 있으므로 스마트 미러 애플리케이션에서 고려해야 할 필수적인 측면입니다.

이러한 시나리오에서 모델이 어떻게 작동하는지 평가하기 위해 실험실 환경에서 피트니스 운동 동영상을 녹화했습니다. 운동을 하는 사람은 스마트 미러 카메라에서 1미터에서 1.5미터 떨어진 곳에 위치했습니다. 이러한 시나리오 중 일부는 그림 9에 나와 있습니다.

감지 속도와 관련해서는 MoveNet Lightning과 BlazePose Lite 모델이 가장 빠른 것으로 나타났습니다. 이 모델들은 웹 브라우저를 사용하여 자바스크립트 데모를 실행했을 때 스마트 미러에서는 초당 2~5프레임(FPS)을, 일반적인 개인용 컴퓨터에서는 10~15 FPS를 처리할 수 있었습니다. 이 속도는 운동 루틴 중 실시간 자세 감지 및 피드백에 매우 중요합니다.

### 7. Conclusions and future work

이 연구에서는 세 가지 포즈 추정 모델의 효율성을 분석했습니다: 포즈넷, 무브넷, 블레이즈포즈. COCO 데이터 세트와 비교했을 때 포즈넷이 가장 높은 정확도를 보였지만, 속도와 정밀도가 결합된 무브넷을 제안한 스마트 미러 시스템에 가장 적합한 모델로 선택했습니다.

이렇게 평가된 모델들은 현재 2D 신체 자세 추정에 사용할 수 있는 가장 진보된 옵션 중 일부입니다. 그러나 비디오 기반 3D 신체 자세 추정 분야가 계속 발전함에 따라 시스템의 정확도와 계산 효율성을 모두 향상시킬 수 있는 새로운 사전 학습 모델이 등장할 것으로 예상됩니다. 깊이 정보를 통합하면 신체 재활 시스템의 유용성이 크게 향상되어 2차원뿐만 아니라 깊이까지 고려한 교정 피드백을 제공할 수 있게 될 것입니다.

블레이즈포즈는 3D 포즈 추정 기능을 제공하지만, 특히 COCO 데이터세트에 대해 테스트했을 때 정확도가 제한적입니다. 따라서 우리가 제안한 신체 재활 시스템에 효과적으로 통합되기 위해서는 추가적인 발전이 필요합니다.

향후 연구에서는 시스템의 정확도에 대한 최종 사용자의 인식을 평가하고자 합니다. 특히, 시스템의 신체 자세 추정치를 기반으로 사용자가 받는 교정 피드백의 정확성에 대해 설문조사를 실시할 계획입니다.

또한 수집된 피트니스 데이터로 맞춤형 3D 데이터 세트를 생성하면 보다 현실적인 '실제' 환경에서 모델 정확도를 평가할 수 있습니다. 이는 향후 작업에서 마커/센서 기반 또는 멀티뷰와 같은 모션 캡처 기술을 사용하여 각 이미지에 주석을 달고 이를 실측 자료로 처리함으로써 달성할 수 있습니다. 이러한 발전은 신체 재활을 위한 스마트 미러 시스템을 더욱 개선하여 그 유용성과 신뢰성을 향상시킬 것입니다.